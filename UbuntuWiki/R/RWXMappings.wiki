{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

These pages keep track of programs with '''write-execute mappings''' on various platforms.  On x86, only PaX systems should be considered; read implies execute on i386 (as the there's no enforcement of separation between '''PROT_READ''' and '''PROT_WRITE''').

Pages that are both writable and executable can be used in attacks which inject code.  Most notably, if the stack is executable, then the program is much more vulnerable to attacks. '''Programs and libraries with PT_GNU_STACK tend to wind up with an executable stack'''.  However, it is important to note that any write-execute area of memory can be used in certain attacks to inject shellcode into a program.

To counteract shellcode injection, the first line of defense is to remove any dependency on writable-executable mappings.  Beyond this, deploying AddressSpaceLayoutRandomization will help to prevent attackers from knowing exactly where known writeable-executable areas of memory are on any given program run.  These tasks are most suited for the UbuntuHardened team; however, the support of all Ubuntu maintainers is needed to properly deploy any security enhancements.

To find these, the following pipeline (copied verbatim from a hardened Gentoo dev about 5 minutes ago) can be run.  If the GrSecurity /proc/pid/maps obscurity option is active, then the exact addresses of the mappings cannot later be extracted; however, the state of the mappings should be available, hence this pipeline should work.

  ''root# egrep ?wx /proc/[0-9]*/maps| cut -c 7-|cut -d / -f 1|sort -u| xargs -n1 ps |grep -v "PID TTY"|awk '{print $5}'|sort -u''

The following script will check for PT_GNU_STACK in any executable and all libs if you have prelink installed.

<pre>

libs=""

check_estack() {
        binary=$1
##### Only check if we haven't checked this before
        for i in $libs; do
                if [ "$1" = "$i" ]; then
                        return
                fi
        done
        libs="$libs $1"
        execstack $1 | grep -v "^-"
        for i in `ldd $1 | awk '{print $3}'`; do check_estack $i; done
}

check_estack $1
</pre>

Also...

<pre>
strace /path/to/executable 2>&1 | grep mprotect | grep PROT_EXEC | grep PROT_WRITE
</pre>

See:

* RWXMappingsi386
* RWXMappingsAMD64
* UbuntuHardened
