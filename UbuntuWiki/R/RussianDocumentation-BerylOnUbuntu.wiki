{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

{| class="wikitable"
|-
| <tablestyle="float:right; font-size: 0.9em; width:40%; background:#F1F1ED; margin: 0 0 1em 1em;" style="padding:0.5em;">'''Содержание'''<<BR>>
|}

== Введение ==

Beryl - это интерфейс рабочего стола на основе OpenGL, который стремится предоставить опыт создания рабочего стола с использованием свободного ПО, и который бы удовлетворял потребности пользователей. Прежде всего, проект прислушивается к пожелаением пользователей и реализует идеи, основываясь на этих пожеланиях. Beryl явлется ответвлением проекта Compiz.

В этом руководстве показано как установить и запустить Beryl на Ubuntu. Дополнительная информация может быть найдена на веб-странице <nowiki>[[http://wiki.beryl-project.org/wiki/Main_Page|Beryl]]</nowiki>.

== Подготовка к установке ==

=== Драйверы видекарт и 3D-ускорение ===

Для работы Xgl необходима поддержка вашим X сервером 3D-ускорения. Пожалуйста, проверьте, поддерживается ли direc rendering запустив в терминале:
<pre>
glxinfo | grep direct
</pre>
Если в ответ вы получите:
<pre>
direct rendering: Yes
</pre>
значит direct rendering разрешен на вашей системе.

Если все в порядке, значит всё готово к установке Xgl и Beryl. Если это не так, то вам необходимо установить соответствующий драйвер для вашей видеокарты. Следуйте инструкциям <nowiki>[[https://help.ubuntu.com/ubuntu/desktopguide/C/hardware.html|official Ubuntu Desktop Guide]]</nowiki>’s для установки драйверов Nvidia или ATI, или используйте <nowiki>[[http://wiki.cchtml.com/index.php/Ubuntu_Edgy_Installation_Guide#C|ATI Linux Drivers Wiki]]</nowiki>, для установки драйвера ATI fglrx.

=== Добавление репозиториев проекта Beryl ===

Добавьте этот репозиторий используя <nowiki>[[https://help.ubuntu.com/community/Repositories/CommandLine|Add Repositories HOWTO]]</nowiki>
<pre>
deb http://ubuntu.beryl-project.org edgy main
</pre>

Чтобы добавить gpg ключ в ваш список ключей, введите следующую команду:
<pre>
wget http://ubuntu.beryl-project.org/root@lupine.me.uk.gpg -O- | sudo apt-key add -
</pre>

Не забудьте запустить обновление, чтобы получить последние репозитории:
<pre>
sudo aptitude update
</pre>

== Установка ==

=== Beryl c Xgl ===

1. Используйте Synaptic или Adept для установки пакета xserver-xgl, или используйте командную строку:
<pre>
sudo aptitude install xserver-xgl
</pre>

2. Далее установите пакеты beryl и emerald-themes:
<pre>
sudo aptitude install beryl emerald-themes
</pre>

(Если вы хотите использовать оконный декоратор KDE, то добавте ‘aquamarine’ в команду выше)

3. Активируйте Xgl:
<pre>
su
gnome-xgl-switch --enable-xgl
</pre>

(Вам НЕТ необходимости запускать GNOME: эта команда применима как для пользователей GNOME, так и для KDE)

4. Перезапустите Ваш X сервер:
<pre>
su
rcxdm restart
</pre>

5. Запустите beryl:
<pre>
beryl-manager
</pre>

=== Beryl с драйверами nVidia и без Xgl/AIGLX ===

==== Введение ====
Начиная с Xorg 7.x, совместные визуальные эффектым могут быть использованы без Xgl, а просто с использованием возможности видеокарты nVidia. В данном случае использвуется AIGLX от nVidia; не используется ни встроенные/опциональные возможности AIGLX в Xorg, ни Xgl.

==== Установка ====

1. Установите Beryl:
<pre>
aptitude -y install beryl emerald emerald-themes
</pre>

(Если вы хотите использовать оконный декоратор KDE, то добавте ‘aquamarine’ в команду выше)

2. Активируйте совместное использование в Xorg:
<pre>
su
nvidia-xconfig --composite
nvidia-xconfig --allow-glx-with-composite
nvidia-xconfig --render-accel
nvidia-xconfig --add-argb-glx-visuals
</pre>

3. Перезапустите Ваш X сервер:
<pre>
su
rcxdm restart
</pre>

4. Запустите beryl:
<pre>
beryl-manager
</pre>

=== Beryl с AIGLX от X.org ===

1. Если у Вас был запущен Xgl, убедитесь что он сейчас выключен:
<pre>
su
gnome-xgl-settings --disable-xgl
</pre>

(Эта команда необходима пользователям как GNOME, так и KDE)

2. Сделайте резервную копию Вашей конфигурации Xorg:
<pre>
su
cp /etc/X11/xorg.conf /etc/X11/xorg.conf.$(date +%y%m%d-%H%M%S)
</pre>

3. Откройте под рутом xorg.conf на редактирование в вашем любимом текстовом редакторе:
<pre>
nano /etc/X11/xorg.conf
</pre>

Убедитесь, что в разделе Section "Module" раскомментированы строки (т.е. перед ними не стоит знак #):
<pre>
Load "dri"
Load "dbe"
Load "glx"
</pre>

Затем, найдите раздел Section "Device" для вашей видеокарты, и добавьте следующую строку:
<pre>
Option  "XAANoOffscreenPixmaps"
</pre>

Добавьте следующие строки в конец файла, если их нет где-либо ещё в нем:
<pre>
Section "DRI"
        Mode 0666
EndSection

Section "Extensions"
        Option "Composite" "Enable"
EndSection
</pre>

Теперь убедитесь что Вы сохранили изменения в файл, и затем закройте редактор.

4. Теперь перезапустить X сервер:
<pre>
su
rcxdm restart
</pre>

5. Запустите Beryl:
<pre>
beryl-manager
</pre>

== Конфигурация ==

=== Автоматический запуск Beryl ===

*** Если Вы используете KDE:

Наберите в консоли (как обычный пользователь, не root):
<pre>
ln -s /usr/bin/beryl-manager ~/.kde/Autostart/beryl-manager
ln -s /usr/bin/beryl-xgl ~/.kde/Autostart/beryl-xgl
</pre>

*** Если Вы используете GNOME:

Откройте Цент Управления GNOME -> Sessions. Откройте последнюю вкладку, "Startup Programs". После этого добавьте в список две строки:
<pre>
beryl-manager
beryl-xgl
</pre>

=== Использование KDE decorations вместо emerald decorator ===

Наберите в консоли (как обычный пользователь, не root):
<pre>
aquamarine --replace &
</pre>

Чтобы потом снова использовать emerald theme decorator наберите в консоли:
<pre>
emerald --replace &
</pre>

== Устранение неисправностей ==

=== "Уже запущен другой composite manager" ===

Скорее всего KDE запустил свой собственный composite manager effects (используя kompmgr), и поэтому Beryl не может стартовать. Чтобы отключить оконные эффекты KDE, откройте Центр Управления и выключите эффекты прозрачности:
<pre>
K Menu -> Configure Desktop (Personal Settings). Затем откройте Desktop -> Window Behaviour.
</pre>

Откройте последнюю вкладку, "Translucency", и снимите галку "Use Translucency/shadows". Теперь вы можете снова попробовать запустить beryl-manager и всё должно быть отлично.
