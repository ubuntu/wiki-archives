{|
  | '''Warning'''
  * This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
  * '''Images''' and '''attachments''' have been removed to conserve space.
  * '''Links''' may not work and there may be formatting issues.
  * A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

== Developer Guide ==

The document walks you through installing the necessary packages and environment
preparations in order to build the Ubuntu OpenStack Installer.

  Development and testing is done on Ubuntu and using a release of '''Trusty''' or later.

=== Building the installer ===

Once '''sbuild''' is configured, checkout the source code of the installer:

<pre>
$ git clone https://github.com/Ubuntu-Solutions-Engineering/openstack-installer.git ~/openstack-installer
$ cd ~/openstack-installer
$ make git-sync-requirements
</pre>

Use the target 'install-dependencies' to install a custom binary package for the build dependencies:

<pre>
$ make install-dependencies
</pre>

From here you can build the entire package set by running:

<pre>
$ make sbuild
$ make deb
$ make deb-src

</pre>

Once finished your packages will be stored in the top level directory where your OpenStack project is kept.

<pre>
$ ls ../*.deb
</pre>

=== Running the OpenStack installer ===

Running the installer for testing currently requires installing the packages.
(Unit tests can be run without installing the packages, provided the
install-dependencies make target has been run.)

After building the packages using either 'make deb' or 'make sbuild', you can
install and run with the 'run' target:

<pre>
$ sudo make run type=single
$ sudo make run type=multi
</pre>

You can also set the '''MAAS//HTTP//PROXY''' env var for the openstack-install command like this:

<pre>
$ sudo make run type=single proxy=http://myproxy/
</pre>

If you are running the landscape installer, you will want to use the 'landscape' target:

<pre>
$ sudo make landscape proxy=http://myproxy/
</pre>

=== Running the OpenStack status screen ===

If you have run the installer and are working on changes to the status screen
(in cloudinstall/), you can re-run the status screen with the correct python
path using this target:

<pre>
$ make status
</pre>

If you are testing the status screen's code for deploying charms, you may need
to first start your juju environment over from scratch:

<pre>
$ juju destroy-environment local
$ juju bootstrap
$ make status
</pre>

=== Changing the log level ===

The openstack-status program logs to ~/.cloud-install/commands.log. The default
log level for that log is "DEBUG". Most of the program logs at the DEBUG level,
which is the most verbose that is currently defined. If you want a different log
level, you can set the UCI_LOGLEVEL environment variable. Your choices are
"DEBUG", "INFO", "WARNING", "ERROR", and "CRITICAL".

<pre>
$ UCI_LOGLEVEL=ERROR openstack-status
</pre>

=== Building documentation ===

Documentation will be built in '''docs/_build/html''', and requires '''Sphinx''' to build.

<pre>
$ cd docs && make html
</pre>

=== Running Tests ===

A unit test suite is in tests/ and is run using
<nowiki>[[https://nose.readthedocs.org/en/latest/|Nose]]</nowiki> and
<nowiki>[[https://testrun.org/tox/latest/|tox]]</nowiki>. Tox will cover both pep8 and flakes
automatically and unit tests do not require a live Juju or MAAS connection.

Run it as follows:

<pre>
$ make test
</pre>
