{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

== Touch/GPU profiling/Apitrace ==

<nowiki>[[http://apitrace.github.io/|Apitrace]]</nowiki> intercepts all traffic between an application and the OpenGL driver, recording it to a file for later playback and analysis. It is easily installed and used on Ubuntu.

=== Recording an Apitrace ===

Recording a trace is as simple as setting an environment variable, to pre-load a library. On the device to trace, install
<pre>
sudo apt install apitrace-tracers
</pre>
(package was named "apitrace-gl-tracers" in older Ubuntu releases)

==== On your PC ====
You need to be aware if you are running your graphical application under X or not. Under X, on amd64, you need to set
<pre>
LD_PRELOAD=/usr/lib/x86_64-linux-gnu/apitrace/wrappers/glxtrace.so 
</pre>
Otherwise, set
<pre>
LD_PRELOAD=/usr/lib/x86_64-linux-gnu/apitrace/wrappers/egltrace.so 
</pre>
(Adjust the path for other architectures).

Then just run your application. It will cause a trace file (for example binaryname.trace) to be created.

==== On an Ubuntu Touch device ====
Just as above, it should be possible just to set
<pre>
LD_PRELOAD=/usr/lib/arm-linux-gnueabihf/apitrace/wrappers/egltrace.s
</pre>
and run the application. However it fails due to odd linking order, so you need to help it with:
<pre>
LD_PRELOAD=/usr/lib/arm-linux-gnueabihf/apitrace/wrappers/egltrace.so:/usr/lib/arm-linux-gnueabihf/libhybris-egl/libEGL.so.1:/usr/lib/arm-linux-gnueabihf/libhybris-egl/libGLESv2.so.2
</pre>

=== Viewing the trace ===
On your PC, install
<pre>
sudo apt install apitrace-gui
</pre>
(package was named "apitrace-gl-frontend" in older Ubuntu releases).

Open the trace (copy it from whatever device) for viewing with
<pre>
qapitrace binaryname.trace
</pre>

Exploring the editor, I find "Trace" -> "Show thumbnails" very handy. Opening a frame, selecting the last gl call, and doing "Show thumbnails" generates a thumbnail beside each glDraw* call, clearly showing how you are using the GPU.

The "apitrace" application is useful, with it you can diff and dump to file.
