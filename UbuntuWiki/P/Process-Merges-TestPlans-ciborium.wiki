{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__


* '''Test plan for component''': ciborium
* '''Component Checklist''': https://wiki.ubuntu.com/Process/Merges/Checklists/Common
* '''Trunk URL''': lp:ciborium
* '''Ubuntu Package URL (LP)''': http://launchpad.net/ubuntu/+source/ciborium

=== Dependents/Clients ===

* udisks2
* ubuntu-push-client

=== Test Plan ===

==== Definitions ====

 SUT:: System Under Test

==== Prereqs ====

* Device with sdcard slot.
* SDCard formatted with at least one block device exposing the Filesystem interface being of type vfat.

==== Plan ====

* Install image on '''SUT''': <code>ubuntu-device-flash --channel ubuntu-touch/devel-proposed</code>
* Run <code>citrain device-upgrade [silo]</code>

===== Alternative for RTM =====

* Install image on '''SUT''': <code>ubuntu-device-flash --channel ubuntu-touch/ubuntu-rtm/14.09-proposed</code>
* Go to PPA and copy link for deb for ciborium's corresponding target arch.
* 
 {{{ 
phablet-shell
wget $ciborium_link
sudo mount -o remount,rw /
sudo dpkg -i ciborium*.deb
sudo apt install -f
sudo reboot
}}}

==== Inserting ====

* Insert the SD Card into the '''SUT''''s slot.
* Verify in <code>ciborium</code> upstart logs that a message like <code>2014/08/07 12:16:32 Mounted /org/freedesktop/UDisks2/block_devices/mmcblk1p1 as /media/phablet/MY CARD</code> is presented and verify that the path is indeed mounted.
* On the '''SUT''', verify that an OSD notification bubble and a persistent message is presented like:
<nowiki>[[File:mount.png|width=40]]</nowiki>
* The same should happen on boot.
* Inserting a card with a filesystem different than vfat will display an error message. An easy way to trigger this is running: <code> sudo /sbin/mkfs.ext4 /dev/mmcblk1 </code> from phablet shell (assuming no partitions and on phablet; don't use /dev/mmcblk0!!!).
<nowiki>[[File:mount-error.png|width=40]]</nowiki>
* Tapping on the osd or through interaction with the notification center should url-dispatch to the sdcard management app.
* If any of the directories <code> Music Pictures Videos Documents Downloads </code> didn't exist before, ciburium should create them.

==== Removing ====

* Remove the SD Card into the '''SUT''''s slot.
* Verify that the mount path, prior correct mounting, is no longer present.

==== SD Card Management app ====

* It shall list available '''drives''', not '''blocks'''
* Has a format option which will format after asking
<nowiki>[[File:format.png|width=40]]</nowiki>
* Has an unmount option.
* By design, if this app is focused, notifications are not displayed.

==== Formatting ====

* Install the file manager application.
* Unlock all features in the file manager application.
* Insert the SD Card into the '''SUT''''s slot.
* Ensure thar you can navigate to the SD Card from the file manager application.
* Once in the SD Card add a number fo testing files.
* Use the SD Card Management app to format the SD Card.
* Ensure that you can navigate to the SD Card from the file manager application and that the data was indeed removed.
* Check that the mounted sdcard contains the following media folders:
<pre>
$ find /media/phablet
./6E89-C6C5
./6E89-C6C5/Documents
./6E89-C6C5/Downloads
./6E89-C6C5/Music
./6E89-C6C5/Pictures
./6E89-C6C5/Videos
</pre>

==== Availability of the media folders ====

* With the sdcard mounted, remove everything using the shell ''rm -rf /home/phablet/<SDCARD>/*''
* Hit safely remove
* Remove the sdcard and add it again
* Now check that the mounted sdcard contains the following media folders:
<pre>
$ find /media/phablet
./6E89-C6C5
./6E89-C6C5/Documents
./6E89-C6C5/Downloads
./6E89-C6C5/Music
./6E89-C6C5/Pictures
./6E89-C6C5/Videos
</pre>

==== Stress Unmounting/Mounting ====

Iterate at least for 10 times (with the External Drivers app):
* Add a valid sdcard
* Check that the sdcard was indeed mounted: ''ls /home/phablet/''
* Hit safely remove
* Check that the card was indeed unmounted: ''ls /home/phablet/''
* Remove the sdcard

Sdcard needs to be mounted and unmounted successfully for every test iteration.

=== Additional information ===

* Monitor <code>$HOME/.cache/upstart/ciborium.log</code> for additional information.
* Mount path is system determined, logs should show where a block device is mounted, the case for now is <code>/media/$USER</code>, notice that this path does not fully exist on first boot.
