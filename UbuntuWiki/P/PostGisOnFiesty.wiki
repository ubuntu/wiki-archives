{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

__~+'''PostGIS on Ubuntu Fiesty 7.04'''+~__

__'''Overview'''__

PostGIS spatially enables a Postgresql server to allow numerous GIS operations with a wide range of applications.  One of the biggest problems encountered in setting up a PostGIS server is the wide variation between distributions.  For example, a howto for Edgy may not apply to Fiesty.  Working with Postgresql 8.1 is considerably different than 8.0.  Building packages from source also differs quite a bit from the apt-get or synaptic approach.

This howto is aimed at users who wish to install a PostGIS server, most likely for local use on a workstation, and run Ubuntu Fiesty Fawn 7.04 on i386.  I have tested this same approach on an AMD64 Ubuntu setup, and achieved similar results (some difficulties with converting shapefiles to PostGIS using SPIT).  It does not explain how actually carry out GIS work, but it should leave you ready to work with GRASS and QuantumGIS 0.74 in short order.

__'''Installation and Setup'''__

Open a command line and type the following:

<pre>
sudo apt-get install postgresql-8.1 postgis postgresql-8.1-postgis
</pre>

All of these should install just fine on a stock Fiesty i386.  Most of the configuration described in the postgresql.org documentation is taken care of automatically by using the Ubuntu packages.  You will already have a postgres user and a database cluster.  You will still need to configure the postgresql server for PostGIS.

At this point you need to use a postgresql utility called psql to change the password the postgres user needs for access to this database:

<pre>
sudo -u postgres psql template1
</pre>
("template1" is a generic database postgresql uses as a basis to spawn new databases, you don't need to understand it at this point)

the psql utility will now load its own text prompt.  Do not be alarmed!  Now enter this command (replace XXXXXXXX with your own password):

<pre>
ALTER USER postgres WITH PASSWORD 'XXXXXXXX';
</pre>
Quit psql:

<pre>
\q
</pre>
Now you'll need to create a database.  This should be very easy, just remember to use the postgres user <code>(sudo -u postgres)</code> to execute the command, or you'll have permissions problems up the wazzoo.  

<pre>
sudo -u postgres createdb mydb
</pre>
If all goes well it will say "CREATE DATABASE." If all does not, you probably aren't using the distributions intended for this howto.  I wish you luck, but I can't help with that.

"mydb" is the name of our test database.  Feel free to name it whatever you like.  You now have a postgresql database!  Congrats!  That's pretty much it for postgresql!

There are a few things you'll have to do to get POSTGIS to "spatially enable" your database.  First, you set up the postgis libs:

<pre>
sudo -u postgres createlang plpgsql mydb
</pre>
Then import the sql files to your database:

<pre>
sudo -u postgres psql -d mydb -f /usr/share/postgresql-8.1-postgis/lwpostgis.sql
</pre>
Then:
<pre>
sudo -u postgres psql -d mydb -f /usr/share/postgresql-8.1-postgis/spatial_ref_sys.sql
</pre>
Note: One of the most common problems in this setup is the location of the above files.  If you built from source, are using different package versions, or are using a different version of ubuntu, you may find that these files don't exist at that location.  They are probably around somewhere, but I can't help with that.

Now for some real excitement.  We're going to import an ESRI type shapefile into postGIS.  This can get a little iffy, and I know I could have written this command more simply, but it DOES work under the conditions specified for this howto.  

<pre>
sudo -u postgres shp2pgsql -D SHAPEFILE mytable mydb | sudo -u postgres psql mydb
</pre>
You'll need to replace "SHAPEFILE" with the name and location of your shapefile.  You can generally leave "mytable" as it is.  "mydb" is, of course, your database.  The most common problem here is making a typo on your file location.

Double Congratulations!  You've just imported a shapefile into a postgis, spatially enabled database!!!   GIS is one of the most complicated, gnarled up messes you'll ever deal with on a computer, so pat yourself on the back!

__~+'''Links:'''+~__

The Official Postgresql site:
<nowiki>[[http://www.postgresql.org]]</nowiki>

The Official PostGIS site:
<nowiki>[[http://www.postgis.org]]</nowiki>
