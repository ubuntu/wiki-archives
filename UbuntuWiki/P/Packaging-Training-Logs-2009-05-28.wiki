{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__


<pre>
<@nhandler> Hello everyone. My name is Nathan Handler. Today, we will be learning about creating packages using CDBS.
* asomething waves
<@nhandler> Could I get a quick show of hands to get a feel for who is here for the packaging training session?
* asomething looks around
<@nhandler> Before I begin, I would like to mention that this session is only going to cover the basics of using CDBS. It will not cover the advanced or special usage.
<@nhandler> Now, what exactly is CDBS?
<@nhandler> To quote https://wiki.ubuntu.com/PackagingGuide/Howtos/CDBS...
<@nhandler> "CDBS is a set of Makefile includes that uses debhelper to make building and maintaining Debian packages even easier. It uses advanced features of Makefiles to abstract the build process, so rules files end up primarily as a series of include statements."
<@nhandler> Now, when might you want to use CDBS?
<@nhandler> I often see people in #ubuntu-motu trying to learn how to package a small bash script that they put together.
<@nhandler> They look at the default debian/rules file created by dh_make, and they get a little nervous.
<@nhandler> Using CDBS, you can create a working package that has a debian/rules file only a couple of lines long.
<@nhandler> In order to demonstrate this, why we take a look at how easy it is to package a simple bash script using CDBS.
<@nhandler> Start by creating a directory to hold all of the files we will be dealing with. You can do this with: mkdir ~/cdbs-packaging
<@nhandler> Now, enter that new directory: cd ~/cdbs-packaging
<@nhandler> I have created a small script that we will attempt to package. You can download it to your current directory using: bzr branch lp:~nhandler/+junk/starwars.upstream
<@nhandler> You should now have a starwars.upstream folder
<@nhandler> If you enter this folder (cd starwars.upstream), you will see three files. There is 'starwars', the bash script. There is also a .desktop file and a .xpm icon.
* brianchidester has quit (Read error: 60 (Operation timed out))
<@nhandler> If you look at the bash script (cat ./starwars), you will see that it simply shows the all too familiar telnet star wars movie.
<@nhandler> Just to be clear, I did not create Star Wars or that telnet movie. I am simply using them for this educational demonstration.
<@nhandler> Now, it is time to start creating the package. You can download the necessary files using: bzr branch lp:~nhandler/+junk/starwars.debian debian
<@nhandler> For those of you who might have some experience packaging, you will notice that this newly created debian directory is missing a copyright file. It also has a few other issues that would prevent it from entering the repositories.
<@nhandler> This was done intentionally to try and keep the package as simple as possible.
<@nhandler> If you want to have your package enter the official repositories, you will want to read through the packaging guide (https://wiki.ubuntu.com/PackagingGuide/Complete) and Debian policy (http://www.debian.org/doc/debian-policy/)
<@nhandler> Now, going back to the package. Take a look at the rules file: cat debian/rules
<@nhandler> You might be surprised to notice that it only has two lines.
<@nhandler> The first line simply says that this is a Makefile. All debian/rules files need to have this line.
* brianchidester (n=brianchi@80.67.104.110) has joined #ubuntu-classroom
* brianchidester has quit (Read error: 104 (Connection reset by peer))
* DoruHush has quit ("Leaving.")
<@nhandler> The second line says that we want to use the debhelper.mk script provided by CDBS. This script will make the packaging of this script much easier.
<@nhandler> If you are interested in learning more about debhelper.mk, I would suggest that you open up /usr/share/cdbs/1/rules/debhelper.mk (you will need to have 'cdbs' installed).
<@nhandler> The file has lots of comments that explain exactly what it does.
<@nhandler> Now, you might be wondering how debhelper will know where to install all of our files. This is specified in debian/install.
<@nhandler> If you look at this file (cat debian/install), you will see that it lists the three files we want to install, and where we want them installed to.
* mib_bjx1mnoq (i=d2d43004@gateway/web/ajax/mibbit.com/x-0baabdaee838da9c) has joined #ubuntu-classroom
<mib_bjx1mnoq> hi
* MiraiWarren0_0 (n=cairo@pool-71-164-178-119.dllstx.fios.verizon.net) has joined #ubuntu-classroom
<@nhandler> Now, in order to use cdbs, you need to list it as a Build-Depends in debian/control. You can see that I have included this by doing: cat debian/control
<@nhandler> That is it. debian/changelog and debian/compat have nothing cdbs-specific in them. If you want to learn more about them, read some of the references I linked to earlier.
<@nhandler> We can now attempt to build the source package. However, you need to have some packages installed: sudo apt-get install devscripts cdbs
<@nhandler> Now, to build the source package, enter: debuild -S -us -uc
<Ampelbein> question: are the .install files specific to cdbs? so, if i want to use them i have to build-depend on cdbs? or is it debhelper that provides this support?
<@nhandler> Ampelbein: debhelper is what uses the .install files. We need the cdbs build-depends because we are including debhelper.mk in debian/rules (which is provided by cdbs)
<Ampelbein> ok, thanks.
<@nhandler> Running the command above will create an unsigned source package
<@nhandler> You will get some lintian warnings about the package containing .bzr directories. For our purposes, you can ignore that warning.
* brianchidester (n=brianchi@80.67.104.110) has joined #ubuntu-classroom
* brianchidester has quit (Read error: 104 (Connection reset by peer))
<@nhandler> Now, if you do a 'cd .. ; ls' you will see that you have four new files: starwars_0.1.dsc, starwars_0.1_source.build, starwars_0.1_source.changes, and starwars_0.1.tar.gz
<@nhandler> If you have pbuilder installed and configured properly, you can build the binary package using: pbuilder build starwars_0.1.dsc
<@nhandler> Otherwise, you can build the binary package in your PPA (https://help.launchpad.net/Packaging/PPA)
<@nhandler> I have already uploaded this package to my PPA: https://launchpad.net/~nhandler/+archive/ppa
<@nhandler> If you examine the the binary .deb file using 'dpkg --contents /path/to/deb', you will see that all of the files are getting installed to the correct locations.
<@nhandler> You can install the package using 'sudo dpkg -i /path/to/deb' to get the application to appear under Applications->Sound and Video->Star Wars. Clicking on it will run the bash script we looked at earlier.
<@nhandler> We have now successfully packaged a simple application using cdbs.
<@nhandler> Are there any questions about anything we have done?
<@nhandler> There is one more thing that I would like to mention
* Pollywog (n=Pollywog@69-12-173-117.static.humboldt1.com) has joined #ubuntu-classroom
<@nhandler> When using dh_make to help create a package, you can actually have it make the necessary changes to use CDBS for you
<@nhandler> To do this, enter 'b' when it asks you about the "Type of package".
* jdg (n=jgill@GE-Medical-Systems-Woodcock.s12-1-0-2-0.ar1.ROC1.gblx.net) has left #ubuntu-classroom
<@nhandler> This will create a debian/rules file similar to the one we saw earlier. It will also take care of adding a Build-Depends on 'cdbs' in debian/control
<@nhandler> Any last questions about CDBS?
<@nhandler> How about some feedback on these Packaging Training sessions in general. Any comments, suggestions, or feedback?
* k0001 has quit (Read error: 54 (Connection reset by peer))
<@nhandler> Well, if nobody has any questions or comments, I think we can end a little early.
<Pollywog> Will this be available later (logs)?
<mib_bjx1mnoq> and when?
<asomething> yes at https://wiki.ubuntu.com/Packaging/Training/Logs
<Pollywog> ty
<@nhandler> Thanks for coming everyone
</pre>

----
CategoryPackaging
