{|
  | '''Warning'''
  * This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
  * '''Images''' and '''attachments''' have been removed to conserve space.
  * '''Links''' may not work and there may be formatting issues.
  * A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__


== Using Ubuntu 14.04 as a KVM hypervisor for POWER ==

Although not officially supported, it is possible to run Ubuntu 14.04.2 LTS as a KVM hypervisor in POWER architecture. You can officially support Ubuntu as hypervisor starting at Ubuntu 14.10 and optimally at 15.04.

In order to do that, you need to be on 14.04.2 or later. Ubuntu KVM doesn't run on 3.13 kernel, which is part of original Ubuntu 14.04 and 14.04.1 release. You will also need to download some newer packages from the <nowiki>[[[https:--wiki.ubuntu.com-ServerTeam-CloudArchive|Cloud Archive repository]]</nowiki>.

This tutorial will explain you how to add a new set of packages into Ubuntu 14.04.2, so, you can run virtual machines over it.

=== Adding Cloud Archive repository ===

In order to do that, you need to add a external repository that contains a new version of `qemu` and `libvirt`. In order to do that, you new to run <code>add-apt-repository cloud-archive:kilo</code> run, as:

<pre>
        $ sudo add-apt-repository cloud-archive:kilo
         Ubuntu Cloud Archive for OpenStack Kilo
         More info: https://wiki.ubuntu.com/ServerTeam/CloudArchive
        Press [ENTER] to continue or ctrl-c to cancel adding it

        Reading package lists...

        Building dependency tree...
        Reading state information...
        The following NEW packages will be installed:
          ubuntu-cloud-keyring
        0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
        Need to get 5,086 B of archives.
        After this operation, 34.8 kB of additional disk space will be used.
        Get:1 http://www.las.ic.unicamp.br/pub/ubuntu-ports/ trusty/universe ubuntu-cloud-keyring all 2012.08.14 [5,086 B]
        Fetched 5,086 B in 0s (6,453 B/s)
        Selecting previously unselected package ubuntu-cloud-keyring.
        (Reading database ... 99413 files and directories currently installed.)
        Preparing to unpack .../ubuntu-cloud-keyring_2012.08.14_all.deb ...
        Unpacking ubuntu-cloud-keyring (2012.08.14) ...
        Setting up ubuntu-cloud-keyring (2012.08.14) ...
        Importing ubuntu-cloud.archive.canonical.com keyring
        OK
        Processing ubuntu-cloud.archive.canonical.com removal keyring
        gpg: /etc/apt/trustdb.gpg: trustdb created
        OK

</pre>

=== Installing Qemu and libvirt ===

Once you have that, you can install the newer qemu and libvirt, using `apt-get install qemu-system-ppc libvirt-bin`

<pre>
        $ sudo apt-get install qemu-system-ppc libvirt-bin
        Reading package lists... Done
        Building dependency tree
        Reading state information... Done
        The following extra packages will be installed:
          qemu-slof qemu-system-common
        Suggested packages:
          qemu-kvm qemu radvd samba vde2 openbios-ppc openhackware
        Recommended packages:
          dmidecode
        The following NEW packages will be installed:
          libvirt-bin qemu-slof qemu-system-common qemu-system-ppc
        0 upgraded, 4 newly installed, 0 to remove and 0 not upgraded.
        Need to get 0 B/4,618 kB of archives.
        After this operation, 38.0 MB of additional disk space will be used.
        Do you want to continue? [Y/n] y
        Selecting previously unselected package qemu-system-common.
        (Reading database ... 99210 files and directories currently installed.)
        Preparing to unpack .../qemu-system-common_1%3a2.2+dfsg-5expubuntu9~cloud0_ppc64el.deb ...
        Unpacking qemu-system-common (1:2.2+dfsg-5expubuntu9~cloud0) ...
        Selecting previously unselected package libvirt-bin.
        Preparing to unpack .../libvirt-bin_1.2.12-0ubuntu12~cloud0_ppc64el.deb ...
        Unpacking libvirt-bin (1.2.12-0ubuntu12~cloud0) ...
        Selecting previously unselected package qemu-slof.
        Preparing to unpack .../qemu-slof_20140630+dfsg-1ubuntu1~14.04_all.deb ...
        Unpacking qemu-slof (20140630+dfsg-1ubuntu1~14.04) ...
        Selecting previously unselected package qemu-system-ppc.
        Preparing to unpack .../qemu-system-ppc_1%3a2.2+dfsg-5expubuntu9~cloud0_ppc64el.deb ...
        Unpacking qemu-system-ppc (1:2.2+dfsg-5expubuntu9~cloud0) ...
        Processing triggers for man-db (2.6.7.1-1ubuntu1) ...
        Processing triggers for ureadahead (0.100.0-16) ...
        Setting up qemu-system-common (1:2.2+dfsg-5expubuntu9~cloud0) ...
        Setting up libvirt-bin (1.2.12-0ubuntu12~cloud0) ...
        libvirt-bin start/running, process 50408
        Setting up libvirt-bin dnsmasq configuration.
        Setting up qemu-slof (20140630+dfsg-1ubuntu1~14.04) ...
        Setting up qemu-system-ppc (1:2.2+dfsg-5expubuntu9~cloud0) ...
        qemu-kvm start/running

</pre>

=== Upgrading slof firmware ===

After that, you have a newer qemu and libvirt, now you need to update the SLOF package, and this is real easy, as you can run download it from the <nowiki>[[http://www.las.ic.unicamp.br/pub/ubuntu-ports/pool/main/s/slof/qemu-slof_20140630+dfsg-1ubuntu1_all.deb|14.04]]</nowiki> repository and install it with `dpkg -i`, as shown below:

<pre>
        $ wget http://www.las.ic.unicamp.br/pub/ubuntu-ports/pool/main/s/slof/qemu-slof_20140630+dfsg-1ubuntu1_all.deb
        $ sudo dpkg -i qemu-slof_20140630+dfsg-1ubuntu1_all.deb
        dpkg: error: requested operation requires superuser privilege
        ubuntu@pub:~$ sudo dpkg -i qemu-slof_20140630+dfsg-1ubuntu1_all.deb
        (Reading database ... 99418 files and directories currently installed.)
        Preparing to unpack qemu-slof_20140630+dfsg-1ubuntu1_all.deb ...
        Unpacking qemu-slof (20140630+dfsg-1ubuntu1) over (20140630+dfsg-1ubuntu1~14.04) ...
        Setting up qemu-slof (20140630+dfsg-1ubuntu1) ...
</pre>

=== Software Required versions ===
Once you do that, you should have the following package versions:

{| class="wikitable"
|-
| <tablestyle="width: 80%">  '''Package'''
| '''Version'''
|-
| qemu
| 1:2.2+dfsg-5expubuntu9~cloud0
|-
| qemu-slof
| 20140630+dfsg-1ubuntu1
|-
| libvirt
| 1.2.12-0ubuntu12~cloud0
|}

=== Configuring the environment and starting a VM ===

Once you have that, you have all the software need to run a KVM guest on your machine. In order to do that, you can follow the tutorial at <nowiki>[[https://wiki.ubuntu.com/ppc64el/CommonQuestions#How_to_use_Ubuntu_as_a_hypervisor.3F|Configuring Ubuntu to run as a KVM hypervisor]]</nowiki>
