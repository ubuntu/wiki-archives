{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__

* '''Test plan for component''': keeper-service
* '''Component Checklist''': <backlink to your component checklist>
* '''Trunk URL''': lp:keeper
* '''Ubuntu Package URL (LP)''':https://code.launchpad.net/keeper

=== Dependents/Clients ===

none

=== Setup NextCloud/OwnCloud account ===
** From the test plan: https://wiki.ubuntu.com/Process/Merges/TestPlan/storage-provider-webdav 
**** Follow the section '''Obtain access to a nextCloud/ownCloud Server''' 
**** Follow the section '''Test Plan''' up to the step '''Copy some files to ~/Music and ~/Videos.'''
  '''Version of owncloud tested successfully: 9.1.3.'''

=== Install keeper's command line client ===
*** Install the client
<pre>
sudo apt install keeper-cli
</pre>

** Reboot the system.

** Start the owncloud VM and ensure that you can access using `localhost:8888/owncloud` in a webbrowser (or the address that suits your configuration).

=== Test plan ===
==== Backup ====
* Copy some files to `~/Music`, `~/Videos`, `~/Documents` and `~/Pictures`.
* Go to your owncloud web interface and in delete the folder '''Ubuntu-Backups''' if it exists.
* Obtain the available sections for backup 
<pre>
/usr/lib/x86_64-linux-gnu/keeper/keeper list-sections
</pre>
* Check that the output lists `Music`, `Videos`, `Documents` and `Pictures`

* Obtain the list of available choices for restore (the list should be empty)
<pre>
/usr/lib/x86_64-linux-gnu/keeper/keeper list-sections --storage=default
</pre>

* Run a backup for all sections
<pre>
/usr/lib/x86_64-linux-gnu/keeper/keeper backup --sections=Movies,Pictures,Documents,Music
</pre>

* Check that all tasks finished successfully. 
  If they don't finish successfully it could be due to a known bug in the owncloud provider. In case that any of the tasks shows the '''failed''' state, remember which one it was.

* Obtain the list of available choices for restore.
<pre>
/usr/lib/x86_64-linux-gnu/keeper/keeper list-sections --storage=default
</pre>
  Now the list should show all the sections that finished its backup successfully. Those that finished with any status different from '''complete''' should not be listed. 
  The sections are shown as the name of the section plus the suffix :timestamp
<pre> 
example: 
     Pictures:2016-12-05T12:38:25
     Music:2016-12-05T12:38:25
     Movies:2016-12-05T12:38:25
     Documents:2016-12-05T12:38:25
</pre>

** Go to your owncloud web interface and navigate to the '''Ubuntu-Backups''' folder. 
     You should see another folder named as the timestamp where the backup started.
*** Check that a file called as each section that finished successfully exists with the '''.keeper''' suffix.
*** Check that a file called '''manifest.json''' exists.
     
** Run another backup for `Movies` and `Pictures` section.
<pre>
/usr/lib/x86_64-linux-gnu/keeper/keeper backup --sections=Movies,Pictures
</pre>

** Check that all sections finished successfully, if not remember which ones failed.

** Obtain the list of available choices for restore again.
<pre>
/usr/lib/x86_64-linux-gnu/keeper/keeper list-sections --storage=default
</pre>
    It should list the previous entries plus the new ones (remember that any section that failed should not be listed).
<pre>
example:
     Pictures:2016-12-05T12:38:25
     Music:2016-12-05T12:38:25
     Movies:2016-12-05T12:38:25
     Documents:2016-12-05T12:38:25

     Movies:2016-12-05T15:19:27
     Pictures:2016-12-05T15:19:27
</pre>

** Go to the owncloud web interface and check that the new backup is created and stored under a folder called as the timestamp where the backup started. 

==== Restore ====
** Go to the `Pictures` folder and erase all the contents.

** Restore the last backup for `Pictures` section:
<pre>
/usr/lib/x86_64-linux-gnu/keeper/keeper restore --sections=Pictures:2016-12-05T15:19:27
</pre>

** Wait until the task finishes successfully.

** Check that the `Pictures` folder contents have been restored and that they're exactly the same than we had previously.

** Remove the contents of all 4 folders: `Movies`, `Pictures`, `Music` and `Documents`.

** Restore all the sections from the first backup.
<pre>
/usr/lib/x86_64-linux-gnu/keeper/keeper restore --sections=Movies:2016-12-05T12:38:25,Pictures:2016-12-05T12:38:25,Documents:2016-12-05T12:38:25,Music:2016-12-05T12:38:25
</pre> 

** Check that all sections finish successfully and that the contents in the folders are the ones that we had when we did the first backup.

Note: You can try any other combination of backups-restores when testing. The ones described here are just examples.
