{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

* '''Test plan for component''': address-book-updater
* '''Component Checklist''': https://wiki.ubuntu.com/Process/Merges/Checklists/system-apps
* '''Trunk URL''': lp:address-book-service
* '''Ubuntu Package URL (LP)''': http://launchpad.net/ubuntu/+source/address-book-service

=== Restore from previous update ===

If you have installed the previous image with Buteo and has any of these accounts enabled for contact sync. You will need to manually remove the accounts and configuration files, to avoid duplicated contacts:

* Remove your google accounts using system settings;
* Remove address-book configuration files: 
*** rm ~/.config/Canonical/AddressBookService.conf
*** rm ~/.config/Canonical/AddressBookUpdate.conf

* Remove buteo sync profiles: 
*** rm -rf ~/.cache/msyncd/
* Install new packages or image;
* Reboot the device;
* Re-create the accounts;

=== Dependents/Clients ===

None

=== Test Plan ===

'''This test plan is not supposed to be complete; use it to guide your manual testing so they dont miss big functional areas that are part in the component; also this should be used as guideline to inspire the exploratory testing which should be adapted smartly based on the real content of a MP'''

== Sync evolution migration ==
* Install OTA7 or older image on phone with --wipe option to make sure all accounts and data deleted

* Open the address-book-app and add a new google account (Account A)
* Wait for the contact-sync to finish
* Mark at least two contacts as favorites

* Open system settings and create one account (Account B):
** Make sure that contact sync is disabled for this account
** Create a new contact on this account using Address book app

* Open system settings and create one account (Account C):
** Make sure that contact sync is disabled for this account
** Create a new contact on this account using Address book app

* Open system settings and create one account (Account D):
** Make sure that contact sync is disabled for this account
 
* Flash proposed image (without wipe);
* '''Install the last version of the package "buteo-sync-plugins-contacts-google" and "address-book-updater"'''
* reboot the phone

* A message should appear on messaging-menu saying that the address-book-app needs upgrade
** If you have internet connection a notification should appear saying that a update is running.
** If you do not have internet a notification should appear asking for internet connection.
* Check if a message appears asking to enable Account B:
** Tap on "yes" to enable account and run a sync before the update continue
* Check if a message appears asking to enable Account C:
** Tap on "no" to keep account disabled and store contacts locally.
* Account A and Account D should be updated without any message.

* Test content-hub mode (before update or while updating):
** Open GMail app and try to attach a contact into your message.
** The app should open as expected without any dialog.

* Test read-only mode (before update or while updating):
** Addressbook:
*** Sync icon should show a different icon
*** Sync icon should be disable if the update/sync is running

** Dialer/Messaging/Aaddressbook:
*** Try to edit the contact and you should be prompted that it's not allowed
*** Try create a new contact with the name "Test Contact":
**** this should be allowed, you can save the contact
**** after contact is saved, click it open it and make sure the Address Book field shows "Personal"
**** We need to verify that this contact still exists after the upgrade
  
* Test fail to update:
*** Network issue during sync
*** go into flight mode after the sync starts
*** make sure you see error reporting no network
*** make sure you can use applications in read-only mode (Check 'Test read-only mode')
*** Turn the wifi on:
**** Open address-book-app and click on sync button   
**** let the upgrade finish
*** Make sure the contacts previously marked Favorites are still there
*** Make sure the "Test Contact" created in "Test read-only mode" is still there

* After update:
** Check if the contact sync is enabled for accounts (Account A, Account B):
** Check if the contact sync still disabled for accounts (Account C, Account D);
** Check if the contacts created on Account B and Account C still exists;

== Sync evolution migration (all accounts disabled) ==
* Install OTA6 or older image on phone with --wipe option to make sure all accounts and data deleted
* Create a new google account using system settings page, make sure that contact sync is disabled
* Create a facebook account
* '''Install the last version of the package "buteo-sync-plugins-contacts-google" and "address-book-updater"'''
* reboot the phone
* Check if contact sync get update correct, and you can use address-book-app as normal.
