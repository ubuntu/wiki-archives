{|
  | '''Warning'''
  * This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
  * '''Images''' and '''attachments''' have been removed to conserve space.
  * '''Links''' may not work and there may be formatting issues.
  * A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__


Git is the source code management tool used by the Linux kernel developer community.  Ubuntu has adopted this tool for our own Linux kernel source code so that we can interact better with the community and the other kernel developers.

=== Current GIT Trees ===

All of the current live Ubuntu kernel repositories are at the URL below:

<pre>
http://kernel.ubuntu.com/git-repos/
</pre>

There is a tree for each of the currently supported releases as well as any open development and upcoming releases:

{| class="wikitable"
|-
| maverick
| git://kernel.ubuntu.com/ubuntu/ubuntu-maverick.git
|-
| lucid
| git://kernel.ubuntu.com/ubuntu/ubuntu-lucid.git
|-
| karmic
| git://kernel.ubuntu.com/ubuntu/ubuntu-karmic.git
|-
| jaunty
| git://kernel.ubuntu.com/ubuntu/ubuntu-jaunty.git
|-
| hardy
| git://kernel.ubuntu.com/ubuntu/ubuntu-hardy.git
|-
| dapper
| git://kernel.ubuntu.com/ubuntu/ubuntu-dapper.git
|}

Typically the distro kernel is on the master branch in these repositories.  A number of releases also have other <nowiki>[[KernelTeam-TopicBranches|Topic Branches]]</nowiki> which represent other related but divergent kernels for other purposes.

To find out what else is available try browsing http://kernel.ubuntu.com/git
and searching for ubuntu).

=== Maintaining local changes ===

During development, the kernel git repository is being constantly rebased
against Linus' tree. IOW, Ubuntu specific changes are not being ''merged'',
but rather popped off, the tree updated to mainline, and then the Ubuntu
specific changes reapplied; they are rebased.  There are two ways to track
the kernel git tree, depending on whether you have local changes or not:

'''No Local Changes'''
<pre>
git fetch
git reset --hard origin/master
</pre>

'''Preserve Local Changes'''
<pre>
git fetch
git rebase --onto origin/master origin/master@{1}
</pre>

=== Pushing changes to the main repo ===
Since the main repo is not publicly writable, the primary means for sending patches to the kernel team is using ''git format-patch''. The output from this command can then be sent to the <nowiki>[[mailto:kernel-team@lists.ubuntu.com|kernel-team]]</nowiki> mailing list.

Alternatively, if you have a publicly available git repository for which changes can be pulled from, you can use ''git request-pull'' to generate an email message to send to the <nowiki>[[mailto:kernel-team@lists.ubuntu.com|kernel-team]]</nowiki> mailing list.

=== Patch acceptance criteria ===
In general, Ubuntu will apply the same criteria applicable to upstream kernel. Here is a checklist of reading and tools related to posting kernel patches:

* <kernel-directory>/Documentation/SubmittingPatches
* <kernel-directory>/scripts/checkpatch.pl
* <kernel-directory>/scripts/cleanpatch
* <kernel-directory>/scripts/cleanfile
* <kernel-directory>/scripts/Lindent

If you are creating a new file, it is helpful to run it through ''cleanfile'' and/or ''Linent'' before creating a patch<<BR>>
If you have generated a patch, it helps running it through ''checkpatch.pl'' and ''cleanpatch'' if necessary<<BR>>
Also, using the commit template described above is a good idea for Ubuntu-specific patches

=== Developers with access to kernel.ubuntu.com ===
The kernel team has a ''git'' repo located on ''kernel.ubuntu.com'' (AKA zinc.ubuntu.com) in /srv/kernel.ubuntu.com/git/ubuntu.

You can, if you want, create a clone for yourself in your directory, and just have your changes pulled when ready.

Suggested way to do this:

<pre>
git clone -l -n -s /srv/kernel.ubuntu.com/git/ubuntu/ubuntu-jaunty.git
vi ubuntu-jaunty/.git/description
( give it a descriptive name )
mv ubuntu-jaunty/.git /srv/kernel.ubuntu.com/git/<user>/my-git-tree.git
</pre>

You can now push your changes to this tree via '''ssh'''. Note the '''-l -n -s''' options do a few special things, mainly making your repo share objects with ours (saves space).

Now you need to run ''git update-server-info'' in your tree so that it is available over http transport
<pre>
cd /srv/kernel.ubuntu.com/git/<user>/my-git-tree.git
git update-server-info
chmod +x /srv/kernel.ubuntu.com/git/<user>/my-git-tree.git/hooks/post-commit
</pre>

To work on your branch, now clone to your local machine from the same origin tree (not the tree you just created on zinc -- this is only for pushing to):

<pre>
git clone git://kernel.ubuntu.com/ubuntu/ubuntu-jaunty.git my-tree
git remote add zinc ssh://kernel.ubuntu.com/srv/kernel.ubuntu.com/git/<user>/my-git-tree.git
<do work>
git push zinc maser
</pre>

Suggested method for keeping this tree synced with the ubuntu tree, instead of git pull, is to do:

<pre>
cd my-tree
git fetch origin
git rebase origin
</pre>

This will keep your changes on top of the original tree (as opposed to being merged). This is also a good idea because during development (e.g. while following the upstream git repo), we frequently rebase to linux-2.6.git upstream, so the '''HEAD''' is not always suitable for pull/merge.

== Git tips and tricks ==
=== Reordering patches ===
<pre>
git rebase -i HEAD~10
</pre>
allows you to interactively reorder the last 10 patches in your branch. You can also squash some patches together. Just follow the directions at the bottom of the file opened up on typing the command.

=== .gitconfig ===

Setting up your $HOME/.gitconfig file can help reduce the number of arguments you need to specify to git commands, and let you specify commonly used remote repositories.
<pre>
[user]
        email = sconklin@canonical.com
        name = "Steve Conklin"
        signingkey = 0x3A758A1E

[sendemail]
smtpuser = sconklin@canonical.com
envelopesender=sconklin@canonical.com
smtpserver = /usr/bin/msmtp
</pre>
Is what I have in my file to set up my email address and email.

<pre>
[remote "sconklin"]
        url = "ssh://sconklin@zinc.canonical.com/srv/kernel.ubuntu.com/git/sconklin/ubuntu-karmic.git"
        fetch = +refs/heads/*:refs/remotes/sconklin/*
[remote "drm-2.6"]
        url = "git://git.kernel.org/pub/scm/linux/kernel/git/airlied/drm-2.6"
        fetch = +refs/heads/*:refs/remotes/drm-2.6/*
[remote "drm-intel"]
        url = "git://git.kernel.org/pub/scm/linux/kernel/git/anholt/drm-intel"
        fetch = +refs/heads/*:refs/remotes/drm-intel/*
</pre>
Sets up the remote repositories that I use most often. With these in the config, I can "git fetch sconklin" in any repo and get that remote.

A google search for ".gitconfig" will turn up other useful settings.

== More information ==
Please read the documentation included with the '''git-core''' package for more details on git commands. A tutorial is also available at http://www.kernel.org/pub/software/scm/git/docs/gittutorial.html.

For a list of quick git recipes and examples, see KernelTeam/GitCheatSheet.

----
CategoryKernel CategoryDocumentation
