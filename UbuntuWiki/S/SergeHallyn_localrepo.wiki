{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__

== Creating local package mirror ==

=== References ===
* https://help.ubuntu.com/community/Repositories/Personal?action=show&redirect=LocalAptGetRepositoriesTrivial
* https://help.ubuntu.com/community/AptMoveHowto
=== Motivation ===

If you want to test a package during debootstrap, you can create a local
mirror and have deboostrap refer to that.

There are probably simpler ways of doing this.  Right now I'm documenting
the steps I took which made this work.  I suspect several steps can be
dropped.

=== Steps ===

First, create the packages as you see fit.

Create the mirror directories:

<pre>
release=precise
mkdir -p /mirrors/debian/pool/main
mkdir -p /mirrors/debian/dists/$release/main/binary-amd64
</pre>

If you want to use this for deboostrap, then download the files debootstrap will need, and copy them into the mirror:

<pre>
debootstrap --download-only $release $release-cache
cp $release-cache/var/cache/apt/archive/* /mirrors/debian/pool/main
</pre>

Copy the customized packages into pool/main:

<pre>
cp *.deb /mirrors/debian/pool/main/
</pre>

Now create Packages list:

<pre>
cd /mirrors/debian
apt-ftparchive packages pool/main | gzip -9c > dists/$release/main/binary-amd64/Packages.gz
</pre>

We need a Releases file:

<pre>
cd /mirrors/debian
cat > release.conf << EOF
APT::FTPArchive::Release {
Origin "APT-Move";
Label "APT-Move";
Suite "$release";
Codename "$release";
Architectures "amd64";
Components "main";
Description "Local Updates";
};
EOF
apt-ftparchive -c release.conf release dists/$release/ > dists/$release/Release
</pre>

Now, you can add this mirror to your sources.list,

<pre>
cat >> /etc/apt/sources.list << EOF
deb file:/mirrors/debian $release main
EOF

or you can run debootstrap referring to this mirror:

<pre>
debootstrap --no-check-gpg $release $release-rootfs file:///mirrors/debian
</pre>
