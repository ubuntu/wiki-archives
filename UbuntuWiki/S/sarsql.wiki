{|
  | '''Warning'''
  * This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
  * '''Images''' and '''attachments''' have been removed to conserve space.
  * '''Links''' may not work and there may be formatting issues.
  * A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

== Sar-sql Wiki ==

Wiki page tracking and documenting work on the sar-sql script. Please consider it as a ''work in progress'' or ''very rough draft''.

=== Step by Step Installation ===

You will need to have '''root''' like privileges in the database server in order to complete these tasks.

1. Create sarsql user with the following commands. Replace '''user''', '''localhost''', the database name and the password has value to fit your particular installation requirements. If your taking snapshots from a server set as _read only_ you will need to add SUPER to the 1st GRANT statement.
<pre>
GRANT PROCESS, REPLICATION CLIENT ON *.* TO 'user'@'localhost' IDENTIFIED BY PASSWORD '*0000000000000000000000';
GRANT ALL PRIVILEGES ON `sarsql`.* TO 'user'@'localhost';
FLUSH PRIVILEGES;
</pre>

1.#2 Create the '''sarsql''' schema in the database:
<pre>
CREATE DATABASE sarsql;
</pre>

1.#3 Create a secure configuration file with the user credentials (in Linux: '''0600''') :
<pre>
cat .sarsql.conf

user=user
password=Password
</pre>

1.#4 Create a wrapper script to define parameters, log file and command invocation. You may use the example below adjusting the directories to match your server:
<pre>

RDIR=/opt/sarsql
SARDIR=/opt/sarsql/

RUSER=`grep user $RDIR/.sarsql.conf | cut -d "=" -f 2`
RPWD=`grep password $RDIR/.sarsql.conf | cut -d "=" -f 2`
RSNAPSHOT='--status --process --slave --master'
CMDLINE="$RSNAPSHOT --user $RUSER --pass $RPWD --database sarsql"

cd $RDIR
PATH=$SARDIR:$PATH
mysar.pl $CMDLINE >> sarsql.log 2>&1
</pre>

1.#5 Run the wrapper at least once to initialize the tables and/or test the parameters

1. Schedule the wrapper in '''cron'''. Use '''crontab''' or my favorite: add a file to '''/etc/cron.d/''' with the proper entry as shown below. Make sure you change it to match your environment:
<pre>
cat mysql_sarsql

MAILTO=mysql_dbas@domain.com
* /5 * * * * mysql /opt/sarsql/sarsql_wrapper.sh
</pre>
