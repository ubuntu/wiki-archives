{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

== Introduction ==
<nowiki>[[https://developer.ubuntu.com/en/start/platform/guides/online-accounts-developer-guide/|Online accounts]]</nowiki> has several components that application developers may use:
* account-application and account-service: describe the services the application will use (should be specified together)
* account-provider and account-qml-plugin: describe the providers and services to extend Online Accounts (should be specified together)

== Implementation for 15.04 OTA-4 and prior ==
At a high-level, this is essentially the same process as for <nowiki>[[https://wiki.ubuntu.com/SecurityTeam/Specifications/ApplicationConfinement|ApplicationConfinement]]</nowiki>, with the following differences:
* the click manifest should specify the correct framework for the release it is targeting (eg, `ubuntu-sdk-15.04`)
* the click manifest should specify `apparmor` with `account-application` and `account-service`
* if both `account-application` and `account-service` are specified, the click manifest should express them together
* when using `account-application` and `account-service`, the `accounts` policy group should be used with the default template (eg, `ubuntu-sdk`)

Eg:
* click manifest: <pre>
{
    "name": "foo"
    "version": "0.1",
    "hooks": {
        "bar": {
            "account-application": "bar.application",
            "account-service": "bar.service",
            "apparmor": "bar.apparmor",
            "desktop": "bar.desktop"
        }
    }
    ...
</pre>
* security manifest (bar.apparmor):<pre>
{
    "policy_groups": [
        "accounts",
        "networking"
    ],
    "policy_version": 1.3
}
</pre>

Prior to Ubuntu Touch 15.04 OTA-5, specifying `account-provider` and `account-qml-plugin` would not work with `apparmor` and therefore it would run unconfined and trigger a manual review in the store.

== Implementation for 15.04 OTA-5 and higher ==
With 15.04 OTA-5, online accounts added support for <nowiki>[[https://launchpad.net/bugs/1219644|confinement of online account providers]]</nowiki>. This is the same as with the 15.04 OTA-4 and earlier changes (above), with the following differences:
* the click manifest should specify `apparmor` with `account-provider` and `account-qml-plugin`
* if both `account-provider` and `account-qml-plugin` are specified, the click manifest should express them together
* when using `account-provider` and `account-qml-plugin`, the `accounts` policy group should be used with the `ubuntu-account-plugin` template

Eg:
* click manifest:<pre>
{
    "name": "foo"
    "version": "0.1",
    "hooks": {
        "bar": {
            "account-application": "bar.application",
            "account-service": "bar.service",
            "apparmor": "bar.apparmor",
            "desktop": "bar.desktop"
        }
        "baz": {
            "account-provider": "baz.provider",
            "account-qml-plugin": "baz-qml-plugin",
            "apparmor": "baz.apparmor"
        }
    }
    ...
</pre>
* security manifest (baz.apparmor):<pre>
{
    "template": "ubuntu-account-plugin",
    "policy_groups": [
        "accounts",
        "networking"
    ],
    "policy_version": 1.3
}
</pre>

== References ==
* https://developer.ubuntu.com/en/start/platform/guides/online-accounts-developer-guide/
* https://developer.ubuntu.com/apps/platform/guides/app-confinement/
* https://launchpad.net/bugs/1219644
