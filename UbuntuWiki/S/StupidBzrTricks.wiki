{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__

After working for Canonical for a year, I've collected a number of tricks that make Bzr easier/faster to use. I'm sharing them here in the hopes that they might be useful to other people, and that they might contribute their own.

Most of these are in the form of bash functions, so that I can just quickly type the function names rather than repeatedly typing tedious commands.

<nowiki>[[https://github.com/robru/dotfiles/blob/master/.bash_aliases|Here's my .bash_aliases file,]]</nowiki> for easier copy&pasting than the snippets below.

=== Make 'bzr diff' work like 'git diff' ===

<pre> bash
export LESS='XSERF'
alias bzrdiff='bzr cdiff|less'
</pre>

=== Easily back out of deep directories ===

<pre> bash
alias ..='cd ..'
alias ...='cd ../..'
alias ....='cd ../../..'
</pre>

=== Create and enter directories in one step ===

<pre> bash
function mkcd {
    mkdir -pv -- "$1" && cd -- "$1"
}
</pre>

=== Easily manage tons of local branches ===

The following bits largely go together, and make the assumption that your local directory names match launchpad project/branch names, such as "~/src/launchpad-project-name/feature-branch-name". 

==== Branch a project and enter it in one step ====

<pre> bash
function bzrbranch {
    [ $# -eq 0 ] && branch="trunk" || branch=$1
    bzr branch lp:$(basename $PWD) "$branch" && cd -- "$branch"
}
</pre>

==== Push a branch to Launchpad ====

<pre> bash
function bzrpush {
    bzr push lp:~/$(basename $(dirname $PWD))/$(basename $PWD) --remember
}
</pre>

==== Propose a merge on Launchpad ====

<pre> bash
function bzrpropose {
    if [ $# -eq 0 ]; then
        echo 'Please specify a commit message.'
    else
        default=$BZR_EDITOR
        export BZR_EDITOR=/bin/true
        yes|bzr lp-propose-merge -m "$@"
        export BZR_EDITOR=$default
    fi
}
</pre>

==== Commit & Propose in one step ====

Great if you're just making a small change.

<pre> bash
function bzrcompose {
    if [ $# -eq 0 ]; then
        echo 'Please specify a commit message.'
    else
        bzr commit -m "$@"
        bzrpush
        bzrpropose "$@"
    fi
}
</pre>

=== Example workflow ===

So, the above is a lot to take in, so here's an example of how I might use it day to day. I keep my local branches under <code>~/src/</code> but none of the above code enforces that specific directory.

<pre> bash
robru@rouge:~$ cd ~/src/

robru@rouge:~/src$ mkcd unity
mkdir: created directory ‘unity’

robru@rouge:~/src/unity$ bzrbranch fix-some-bug
Branched 3487 revisions.

robru@rouge:~/src/unity/fix-some-bug$ $EDITOR some/file

robru@rouge:~/src/unity/fix-some-bug$ bzrdiff

robru@rouge:~/src/unity/fix-some-bug$ bzrcompose 'Fix that bug (LP: #nnnnn)'
Committing to: /home/robru/src/unity/fix-some-bug/
modified some/file
Committed revision 233.
Using default stacking branch /+branch-id/662123 at chroot-75432912:///~robru/unity/
Created new stacked branch referring to /+branch-id/662123.
lp:~robru/unity/fix-some-bug is already up-to-date.
Commit message was not edited, use anyway? ([y]es, [n]o): yes
Created new window in existing browser session.

robru@rouge:~/src/unity/fix-some-bug$ ...

robru@rouge:~/src$
</pre>

And then you'll see the merge request pop open with your browser. The merge's commit message will match the commit message for the single commit being merged, and you'll be able to request reviews in the browser.

For a more in-depth edit that might require more than one commit, it's also easy:

<pre> bash
robru@rouge:~$ cd ~/src/

robru@rouge:~/src$ mkcd unity
mkdir: created directory ‘unity’

robru@rouge:~/src/unity$ bzrbranch fix-some-bug
Branched 3487 revisions.

robru@rouge:~/src/unity/fix-some-bug$ $EDITOR some/file

robru@rouge:~/src/unity/fix-some-bug$ bzrdiff

robru@rouge:~/src/unity/fix-some-bug$ bzr commit -m 'Step 1 of fix.'
Committing to: /home/robru/src/unity/fix-some-bug/
modified some/file
Committed revision 233.

robru@rouge:~/src/unity/fix-some-bug$ $EDITOR some/other/file

robru@rouge:~/src/unity/fix-some-bug$ bzrdiff

robru@rouge:~/src/unity/fix-some-bug$ bzr commit -m 'Step 2 of fix.'
Committing to: /home/robru/src/unity/fix-some-bug/
modified some/other/file
Committed revision 234.

robru@rouge:~/src/unity/fix-some-bug$ bzrpush
Using default stacking branch /+branch-id/662123 at chroot-75432912:///~robru/unity/
Created new stacked branch referring to /+branch-id/662123.

robru@rouge:~/src/unity/fix-some-bug$ bzrpropose 'Fix that bug (LP: #nnnnn)'
lp:~robru/unity/fix-some-bug is already up-to-date.
Commit message was not edited, use anyway? ([y]es, [n]o): yes
Created new window in existing browser session.

robru@rouge:~/src/unity/fix-some-bug$ ...

robru@rouge:~/src$
</pre>

Much less typing when you don't have to specify branch names more than once! The functions just use the directory names as implicit project/branch names.
