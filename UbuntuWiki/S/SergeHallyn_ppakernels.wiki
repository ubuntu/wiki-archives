{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__

Compiling a kernel in a ppa can take a few tricks.  Here is how I do it:

** Grab the pristine kernel for the release you want, and/or check out a new branch for your work:

<pre>
git clone git://kernel.ubuntu.com/ubuntu/ubuntu-natty.git
cd ubuntu-natty
git co -b mytest
</pre>

** <hackhackhack> and commit your changes as usual

<pre>
git status | grep modified | awk -F: '{ print $2 }' | xargs git add
git commit -s -m 'My test'
</pre>

** Make sure the tree is clean and ready

<pre>
fakeroot debian/rules clean
</pre>

** Now create a packaging changelog entry.  If the previous entry was 2.6.38-9.43, then I might call my test 2.6.38-9.43creds1.

<pre>
dch -i
</pre>

** *Important* - copy your changelog entry from debian/changelog into debian.master/changelog.

** Make sure that the ppa will skip module and ABI checking
*** Add the following lines to debian/rules:

<pre>
export skipmodules=true
export skipabi=true
</pre>
*** set skipmodule to 1 in debian/scripts/module-check, so it starts with:

<pre>

$flavour = shift;
$prev_abidir = shift;
$abidir = shift;
$skipmodule = 1;
</pre>

** Build the kernel source package using the following command:

<pre>
dpkg-buildpackage -S -sa -rfakeroot -I.bzr -I.git -I.gitignore -i"\.git.*"
</pre>
(Thanks to Sarvatt and tgardner for the info about ignoring VCS files)

** You can also test-build locally using

<pre>
fakeroot debian/rules binary-generic
</pre>
to save having to deal with errors when building in ppa.

** Finally push the package to your ppa.

<pre>
cd ..
dput ppa:myuser/ppa *.changes
</pre>

To compile on your own system, just do:

<pre>
fakeroot debian/rules clean
fakeroot debian/rules binary-generic
</pre>

or if you also need ddebs (thanks Sarvatt):

<pre>
fakeroot debian/rules binary-generic skipdbg=false
</pre>
