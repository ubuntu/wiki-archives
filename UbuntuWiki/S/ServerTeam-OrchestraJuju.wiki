{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__

This page assumes you have an orchestra setup already working, and discusses how to configure juju to control this setup

=== 1. Installing juju ===

Starting Oneiric 11.10, juju is available in universe

<pre>
sudo apt-get install juju
</pre>

to install a daily build from PPA or to install from source code, check out the <nowiki>[[http://juju.ubuntu.com/docs/|juju documentation]]</nowiki>

=== 2. Configuring the environment ===

<pre>
sudo mkdir -p ~/.juju
sudo vim ~/.juju/environments.yaml
</pre>

And we copy the following

<pre>
juju: environments
environments:
  orchestra:
    type: orchestra
### Specify the orchestra server's IP address
    orchestra-server: 10.1.2.3
### Specify storage. In this case we are using webdav installed by orchestra.
    storage-url: http://10.1.2.3/webdav
### Specify cobbler's usr/pass
    orchestra-user: cobbler
    orchestra-pass: cobbler
    admin-secret: fooooo
### Branch from where we will install ensemble
### juju-branch: lp:juju
### Mangement classes
    acquired-mgmt-class: orchestra-juju-acquired
    available-mgmt-class: orchestra-juju-available
    default-series: oneiric
</pre>

=== 3. Creating SSH keys ===

Ensemble requires SSH keys to be able to access the deployed nodes. In case those keys do not exist, then we have to create them before we bootstrap our environment:

<pre>
ssh-keygen -t rsa
</pre>

=== 4. Bootstrapping the environment ===

After the configuration done above, we bootstrapped the environment:

<pre>
juju bootstrap
</pre>

This process will select any of the machines available to orchestra to be the zookeeper node. If you do not have full power control setup in Orchestra, then you will need to reboot the box that was selected at this time, so it will install juju. You can tell that it was selected because its 'mgmt_classes' field will now say 'orchestra-juju-acquired' instead of 'orchestra-juju-available'.

In this example, the machine's name is '''mabolo'''

<pre>
ubuntu@orchtrasrvr:~$ juju status
2011-09-08 18:02:22,148 INFO Connecting to environment.
machines:
  0: {dns-name: mabolo.lan, instance-id: MTMxNDMwNzI0OS40ODkyODE2MzAuODE5ODY}
</pre>

'''NOTE:''' Note that after executing the command we had to manually start/restart the system to PXE boot it. This can be automated if cobbler is configured to power-on the servers
