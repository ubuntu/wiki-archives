{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

From http://gould.cx/ted/blog/Saving_the_world_one__w_at_a_time

/!\ Please, for gnome-related packages use this upstream page: <nowiki>[[http://live.gnome.org/GnomeGoals/UseTimeoutAddSeconds|http://live.gnome.org/GnomeGoals/UseTimeoutAddSeconds]]</nowiki>

=== Saving the world one uW at a time ===

I'm here at UDS and joined a session between the kernel and desktop teams talking about power. Like all of such sessions the kernel team thinks that the desktop should fix all the problems and vice versa. At their suggestion, I took an action item.

One of the features of GTK+ is that it provides two timeout functions: gtk_timeout_add and gtk_timeout_add_seconds [1]. The difference is much more important than not having to add a "* 1000" in one and not the other. The important thing that the second function does is that it tried to group wake-ups to ensure that the program wakes up as little as possible. This is never perfect, but it's a small thing that can help to save some power and reduce the number of wake-ups.

So I looked through the Ubuntu main archive to figure out how many applications use the more precise function, but just pass in several seconds as the parameter. I figured this would be a few apps, and I'd submit a couple patches, then I could go back to blaming the kernel team for all our problems. There are more than a couple packages. There are a lot of packages. The <nowiki>[[http://gould.cx/ted/blog.files/no_timeout_seconds_main.txt|results of the grep]]</nowiki> and a <nowiki>[[http://gould.cx/ted/blog.files/no_timeout_seconds_main_pkgs.txt|cleaned up list of packages]]</nowiki> that are likely to have easy fixes.

I realize now that I can't do this by myself, the only hope is to document how to fix it.

So if you'd like to help save a little power on your machine, follow these instructions.

/!\ Please, for gnome-related packages use this upstream page: <nowiki>[[http://live.gnome.org/GnomeGoals/UseTimeoutAddSeconds|http://live.gnome.org/GnomeGoals/UseTimeoutAddSeconds]]</nowiki>

1. Take one of the packages in the <nowiki>[[http://gould.cx/ted/blog.files/no_timeout_seconds_main_pkgs.txt|list above]]</nowiki> and find it in the <nowiki>[[http://package-import.ubuntu.com/|package repository]]</nowiki> <nowiki>[[https://lists.ubuntu.com/archives/ubuntu-devel-announce/2008-November/000514.html|(instructions)]]</nowiki>.
2. Branch it:
    `$ bzr branch http://package-import.ubuntu.com/x/xproject/jaunty localfix`
3. Find the instances that might be causing the problem.
    `$ rgrep timeout_add *`
4. Commit and build a package:
    `$ bzr commit -m "Saving the world"`<<BR>>
    `$ dch -i`<<BR>>
    `# aptitude build-dep xproject`<<BR>>
    `$ debuild`
5. Test it on your system, make sure things still work reasonably.
6. Generate a patch:
    `$ bzr diff -r ancestor:`
7. <nowiki>[[https://wiki.ubuntu.com/Bugs/Upstream#line-12|Submit it upstream!]]</nowiki>

----

[1] Note that <nowiki>[[http://bugzilla.gnome.org/show_bug.cgi?id=547119|PyGObject has timeout_add_seconds() but it was not documented]]</nowiki>.

----

Add your name to the Assignee column if you wish to tackle that package. After you have submitted the patch upstream, change row's background to yellow by adding '''<rowbgcolor="#ff9">''' in the first cell of the column. After the patch has been commited upstream, change row's background to green by adding '''<rowbgcolor="#9f9">''' in the first cell of the column. This will let people know that the package in that row has been hugged.

{| class="wikitable"
|-
| <rowbgcolor="#ccc"> '''Package'''
| '''Assignee'''
| '''Upstream Bug'''
|-
| <rowbgcolor="#ff9">foo (example)
| Andrewsomething
| <nowiki>[[http://bugzilla.gnome.org/|GNOME Bug XXXXXX]]</nowiki>
|-
| avahi
| 
| 
|-
| '''b'''acula
| 
| 
|-
| '''c'''onsolekit
| 
| 
|-
| gcompris
| 
| 
|-
| gimp
| 
| 
|-
| gksu
| 
| 
|-
| hal
| 
| 
|-
| irssi
| SteveLangasek
| 
|-
| jockey
| 
| 
|-
| ldm
| 
| 
|-
| libbtctl
| 
| 
|-
| libhildonfm
| 
| 
|-
| <rowbgcolor="#9f9">liferea
| <nowiki>[[https://launchpad.net/~arunanbala|Arunan Bala]]</nowiki>
| Already fixed upstream, all timeouts over 1s using g_timeout_add_seconds in SVN trunk <nowiki>[[http://liferea.svn.sourceforge.net/viewvc/liferea?view=rev&revision=4342|Fixes for noted instances]]</nowiki>
|-
| midbrowser
| 
| 
|-
| network-manager
| 
| 
|-
| nvidia-setting
| 
| 
|-
| oem-config
| 
| 
|-
| openoffice.org-l10n
| 
| 
|-
| pbbuttonsd
| 
| 
|-
| <rowbgcolor="#9f9">pidgin
| <nowiki>[[https://launchpad.net/~arunanbala|Arunan Bala]]</nowiki>
| <nowiki>[[http://developer.pidgin.im/ticket/8831|finch #8831]]</nowiki> <nowiki>[[http://developer.pidgin.im/ticket/8834|pidgin #8834]]</nowiki> <nowiki>[[http://developer.pidgin.im/ticket/8875|libpurple #8875]]</nowiki>
|-
| pigment-python
| 
| 
|-
| policykit
| <nowiki>[[https://launchpad.net/~arunanbala|Arunan Bala]]</nowiki>
| Patch sent to f.d.o development mailing list, mail currently pending approval
|-
| screem
| 
| 
|-
| screen-resolution-extra
| 
| 
|-
| system-config-cluster
| 
| 
|-
| system-config-printer
| 
| 
|-
| thin-client-manager
| 
| 
|-
| <rowbgcolor="#9f9">tracker
| <nowiki>[[https://launchpad.net/~marcelstimberg|Marcel Stimberg]]</nowiki>
| <nowiki>[[http://bugzilla.gnome.org/573834|GNOME Bugzilla #573834]]</nowiki>
|-
| <rowbgcolor="#9f9">transmission
| Andrewsomething
| <nowiki>[[http://trac.transmissionbt.com/ticket/1585|Ticket #1585]]</nowiki>
|-
| tsclient
| 
| 
|-
| twisted
| 
| 
|-
| ubiquity
| 
| 
|-
| <rowbgcolor="#9f9">update-notifier
| ColinWatson
| 
|-
| usb-creator
| 
| 
|-
| vim
| 
| 
|-
| '''w'''ebkit
| 
| 
|-
| xsane
| 
| 
|-
| xscreensaver
| 
| 
|}

----

Gnome-related packages, only here for historical reasons. Please, use  <nowiki>[[http://live.gnome.org/GnomeGoals/UseTimeoutAddSeconds|http://live.gnome.org/GnomeGoals/UseTimeoutAddSeconds]]</nowiki> instead

{| class="wikitable"
|-
| <rowbgcolor="#ccc"> '''Package'''
| '''Assignee'''
| '''Upstream Bug'''
|-
| <rowbgcolor="#9f9">brasero
| Debarshi Ray
| <nowiki>[[http://bugzilla.gnome.org/564397|GNOME Bugzilla #564397]]</nowiki>
|-
| <rowbgcolor="#9f9">'''d'''bus-python
| <nowiki>[[https://launchpad.net/~khaeru|Paul Kishimoto]]</nowiki>
| All test/example code
|-
| <rowbgcolor="#ff9">deskbar-applet
| JavierJardon
| <nowiki>[[http://bugzilla.gnome.org/show_bug.cgi?id=581207 | Gnome Bugzilla #581207]]</nowiki>
|-
| <rowbgcolor="#9f9">dia
| <nowiki>[[https://launchpad.net/~arunanbala|Arunan Bala]]</nowiki>
| <nowiki>[[http://bugzilla.gnome.org/show_bug.cgi?id=573921|GNOME Bugzilla #573921]]</nowiki>
|-
| <rowbgcolor="#9f9">'''e'''kiga
| 
| False alarm.
|-
| <rowbgcolor="#ff9">evolution
| <nowiki>[[https://launchpad.net/~marcelstimberg|Marcel Stimberg]]</nowiki>
| <nowiki>[[http://bugzilla.gnome.org/573830|GNOME Bugzilla #573830]]</nowiki>
|-
| <rowbgcolor="#9f9">gconf
| <nowiki>[[https://launchpad.net/~khaeru|Paul Kishimoto]]</nowiki>
| <nowiki>[[http://bugzilla.gnome.org/show_bug.cgi?id=565312|GNOME Bugzilla #565312]]</nowiki>
|-
| <rowbgcolor="#9f9">gedit
| <nowiki>[[https://launchpad.net/~khaeru|Paul Kishimoto]]</nowiki>
| <nowiki>[[http://bugzilla.gnome.org/show_bug.cgi?id=565127|GNOME Bugzilla #565127]]</nowiki>
|-
| <rowbgcolor="#ff9">gftp
| <nowiki>[[https://launchpad.net/~arunanbala|Arunan Bala]]</nowiki>
| <nowiki>[[http://bugzilla.gnome.org/show_bug.cgi?id=573727|GNOME Bugzilla #573727]]</nowiki>
|-
| <rowbgcolor="#9f9">gnome-applets
| BryanQuigley
| <nowiki>[[http://bugzilla.gnome.org/show_bug.cgi?id=573604|GNOME Bugzilla #573604]]</nowiki>
|-
| <rowbgcolor="#9f9">gnome-games
| 
| <nowiki>[[http://bugzilla.gnome.org/show_bug.cgi?id=564202|GNOME Bugzilla #564202]]</nowiki>
|-
| <rowbgcolor="#ff9">gnome-mount
| <nowiki>[[https://launchpad.net/~arunanbala|Arunan Bala]]</nowiki>
| <nowiki>[[http://bugzilla.gnome.org/show_bug.cgi?id=577812|GNOME Bugzilla #577812]]</nowiki>
|-
| <rowbgcolor="#9f9"> gnome-power-manager
| <nowiki>[[https://launchpad.net/~khaeru|Paul Kishimoto]]</nowiki>
| <nowiki>[[http://bugzilla.gnome.org/show_bug.cgi?id=565076|GNOME Bugzilla #565076]]</nowiki>
|-
| <rowbgcolor="#ff9"> gnome-system-monitor
| Debarshi Ray
| <nowiki>[[http://bugzilla.gnome.org/show_bug.cgi?id=581099|GNOME Bugzilla #581099]]</nowiki>
|-
| <rowbgcolor="#9f9">gtksourceview
| <nowiki>[[https://launchpad.net/~arunanbala|Arunan Bala]]</nowiki>
| Reviewed, only use is in debug code (Gnome SVN trunk 24/2/09)
|-
| <rowbgcolor="#9f9">gvfs
| Awalton
| <nowiki>[[http://bugzilla.gnome.org/show_bug.cgi?id=564052|GNOME Bugzilla #564052]]</nowiki>
|-
| <rowbgcolor="#9f9">'''m'''etacity
| BryanQuigley
| <nowiki>[[http://bugzilla.gnome.org/show_bug.cgi?id=573718|GNOME Bugzilla #564073]]</nowiki> - Closed, Unneeded - Look at bug for more
|-
| <rowbgcolor="#9f9">'''n'''autilus
| NelsonBenitez
| Fixed, <nowiki>[[http://bugzilla.gnome.org/show_bug.cgi?id=574033|GNOME Bugzilla #574033]]</nowiki>
|-
| <rowbgcolor="#9f9">nautilus-sendto
| <nowiki>[[https://launchpad.net/~arunanbala|Arunan Bala]]</nowiki>
| <nowiki>[[http://bugzilla.gnome.org/show_bug.cgi?id=578030|GNOME Bugzilla #578030]]</nowiki>
|-
| <rowbgcolor="#ff9">network-manager-applet
| JavierJardon
| <nowiki>[[http://bugzilla.gnome.org/show_bug.cgi?id=580693|GNOME Bugzilla #580693]]</nowiki>
|-
| <rowbgcolor="#9f9">pidgin
| <nowiki>[[https://launchpad.net/~arunanbala|Arunan Bala]]</nowiki>
| <nowiki>[[http://developer.pidgin.im/ticket/8831|finch #8831]]</nowiki> <nowiki>[[http://developer.pidgin.im/ticket/8834|pidgin #8834]]</nowiki> <nowiki>[[http://developer.pidgin.im/ticket/8875|libpurple #8875]]</nowiki>
|-
| <rowbgcolor="#9f9">'''s'''abayon
| Debarshi Ray
| <nowiki>[[http://bugzilla.gnome.org/564405|GNOME Bugzilla #564405]]</nowiki>
|-
| <rowbgcolor="#9f9">seahorse
| Debarshi Ray
| <nowiki>[[http://bugzilla.gnome.org/564403|GNOME Bugzilla #564403]]</nowiki>
|-
| <rowbgcolor="#9f9">totem
| Philip Withnall
| <nowiki>[[http://bugzilla.gnome.org/564073|GNOME Bugzilla #564073]]</nowiki>
|-
| <rowbgcolor="#9f9">vinagre
| <nowiki>[[https://launchpad.net/~khaeru|Paul Kishimoto]]</nowiki>
| all instances < 1000 ms
|-
| <rowbgcolor="#9f9">vino
| JavierJardon
| <nowiki>[[http://bugzilla.gnome.org/show_bug.cgi?id=581094|GNOME Bugzilla #581204]]</nowiki>
|-
| <rowbgcolor="#9f9">'''x'''chat-gnome
| JavierJardon
| <nowiki>[[http://bugzilla.gnome.org/show_bug.cgi?id=581094|GNOME Bugzilla #581094]]</nowiki>
|}
