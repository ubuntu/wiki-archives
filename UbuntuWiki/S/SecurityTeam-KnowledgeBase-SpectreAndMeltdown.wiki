{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__



== Information leak via speculative execution side channel attacks ==

In January 2018, <nowiki>[[https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html|security researchers announced]]</nowiki> a new class of side channel attacks that impact most processors, including processors from Intel, AMD, ARM and IBM. The attack allows malicious userspace processes to read kernel memory and malicious code in guests to read hypervisor memory.

To address the issue in Ubuntu, updates to the kernel, processor microcode, hypervisor, and various other userspace packages will be needed. These updates are being announced in <nowiki>[[https://usn.ubuntu.com/usn/|Ubuntu Security Notices]]</nowiki> as they are available.

There were three original vulnerabilities involved:
{| class="wikitable"
|-
| '''Group'''
| '''Name'''
| '''Variant'''
| '''Description'''
| '''Ubuntu CVE Tracker'''
|-
| Jan 2018
| Spectre
| Variant 1
| Bounds Check Bypass
| <nowiki>[[https://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-5753.html | CVE-2017-5753]]</nowiki>
|-
| Jan 2018
| Spectre
| Variant 2
| Branch Target Injection
| <nowiki>[[https://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-5715.html | CVE-2017-5715]]</nowiki>
|-
| Jan 2018
| Meltdown
| Variant 3
| Rogue Data Cache Load
| <nowiki>[[https://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-5754.html | CVE-2017-5754]]</nowiki>
|}

<<BR>>

The Spectre and Meltdown vulnerabilities have varying impacts in different environments, and the mitigations available can be difficult to understand. We've prepared a <nowiki>[[TechFAQ|Technical FAQ]]</nowiki> to help answer many common questions.

''This article will be updated periodically with new information as it becomes available, until the issues have been resolved.''

=== Current Status ===

From a guest and non-hypervisor bare-metal perspective, as of the Feb 21 kernel updates, as far as we are aware, the mitigations for Spectre and Meltdown on 64-bit amd64, ppc64el and s390x are feature-complete as long as all microcode, firmware and hypervisor updates underneath the system are done. However:

* Ubuntu kernels have been rebuilt using retpolines on i386 and amd64 for Ubuntu 17.10, Ubuntu 16.04 LTS, and Ubuntu 14.04 LTS (linux-lts-xenial aka Hardware Enablment kernel) only. We are investigating selective rebuilds of Ubuntu userspace packages to make use of retpoline.

Additionally:

* No fix is currently available for Meltdown on 32-bit x86; moving to a 64-bit kernel is the currently recommended mitigation.
* No fixes are yet available for ARM platforms. Note that a relatively small number of standard ARM cores <nowiki>[[https://developer.arm.com/support/security-update|are known to be affected]]</nowiki>.
* For Ubuntu hypervisors, further work will be required to expose the Spectre variant 2 mitigations to guests running on top of Ubuntu, including a qemu update and some additional kernel updates.

==== Kernel Mitigations ====

Ubuntu enables available kernel mitigations to provide a secure-by-default experience. It should be noted that the security features to mitigate these vulnerabilities can lead to a decrease in system performance. Reputable reports of <nowiki>[[PublishedApplicationData| published application performance data]]</nowiki> can aide in understanding the impact in various environments. Environments which do not execute untrusted code may benefit from toggling the <nowiki>[[MitigationControls|mitigation controls]]</nowiki> to disable some or all of the kernel mitigations.

The current kernel mitigation status is as follows:
{| class="wikitable"
|-
| <|2> '''Ubuntu'''
| <|2> '''Kernel'''
| <-3> '''i386'''
| <-3> '''amd64'''
| <-3> '''ppc64el'''
| <-2> '''s390x'''
| <-3> '''armhf'''
| <-3> '''arm64'''
| <|2> '''Latest USN'''
|-
| S1
| S2
| M
| S1
| S2
| M
| S1
| S2
| M
| S1
| S2
| S1
| S2
| M
| S1
| S2
| M
|-
| 17.10
| 4.13
| Y
| R
| -
| Y
| F,R
| Y
| Y
| F
| F
| Y
| F
| -
| -
| -
| Y
| F
| Y
| <nowiki>[[https://usn.ubuntu.com/usn/usn-3581-1/|USN-3581-1 on 2018-02-22]]</nowiki> <nowiki>[[https://usn.ubuntu.com/usn/usn-3597-2/|USN-3597-2 on 2018-03-15 for arm64]]</nowiki>
|-
| <|2> 16.04 LTS
| 4.13 HWE
| Y
| R
| -
| Y
| F,R
| Y
| Y
| F
| F
| Y
| F
| -
| -
| -
| Y
| F
| Y
| <nowiki>[[https://usn.ubuntu.com/usn/usn-3581-2/|USN-3581-2 on 2018-02-22]]</nowiki> <nowiki>[[https://usn.ubuntu.com/usn/usn-3597-2/|USN-3597-2 on 2018-03-15 for arm64]]</nowiki>
|-
| 4.4
| Y
| R
| -
| Y
| F,R
| Y
| Y
| F
| F
| Y
| F
| -
| -
| -
| -
| -
| -
| <nowiki>[[https://usn.ubuntu.com/usn/usn-3582-1/|USN-3582-1 on 2018-02-22]]</nowiki>
|-
| <|2> 14.04 LTS
| 4.4 HWE
| Y
| R
| -
| Y
| F,R
| Y
| Y
| F
| F
| 
| <-2|2> U
| -
| -
| -
| <-3|2> U
| <nowiki>[[https://usn.ubuntu.com/usn/usn-3582-2/|USN-3582-2 on 2018-02-22]]</nowiki>
|-
| 3.13
| Y
| R
| -
| Y
| F,R
| Y
| -
| -
| F
| -
| -
| -
| <nowiki>[[https://usn.ubuntu.com/usn/usn-3583-1/|USN-3583-1 on 2018-02-22]]</nowiki>
|-
| <|2> 12.04 ESM
| 3.13 HWE
| <|2-3> U
| Y
| F
| Y
| 
| <|2-11> U
| <nowiki>[[https://usn.ubuntu.com/usn/usn-3542-2/|USN-3542-2 on 2018-01-22]]</nowiki>
|-
| 3.2
| Y
| F
| Y
| <nowiki>[[https://usn.ubuntu.com/usn/usn-3580-1/|USN-3580-1 on 2018-02-21]]</nowiki>
|}

<<BR>>
{| class="wikitable"
|-
| '''Key '''
| '''Meaning'''
|-
| S1
| Spectre / Variant 1 / CVE-2017-5753
|-
| S2
| Spectre / Variant 2 / CVE-2017-5715
|-
| M
| Meltdown / Variant 3 / CVE-2017-5754
|-
| Y
| Updates have been published to mitigate the issue
|-
| F
| Updates have been published to mitigate the issue but require updated firmware/microcode
|-
| R
| Kernel compiled with Retpoline, please see the  <nowiki>[[TechFAQ#Retpoline|FAQ around Retpoline]]</nowiki> to better understand the extent of this mitigation
|-
| -
| Updates are not yet available
|-
| U
| Architecture is unsupported
|}
<<BR>>

==== Processor Firmware Availability ====
{| class="wikitable"
|-
| Ubuntu Architectures
| Vendor Statements
| Firmware Status
| Notes
|-
| i386, amd64
| <nowiki>[[https://security-center.intel.com/advisory.aspx?intelid=INTEL-SA-00088&languageid=en-fr|Intel]]</nowiki>, <nowiki>[[https://www.amd.com/en/corporate/speculative-execution|AMD]]</nowiki>
| Available, see <nowiki>[[https://usn.ubuntu.com/usn/usn-3531-3/|USN-3531-3]]</nowiki> and <nowiki>[[https://usn.ubuntu.com/usn/3690-2/|USN-3690-2]]</nowiki>
| Note that some users experienced <nowiki>[[https://bugs.launchpad.net/ubuntu/+source/intel-microcode/+bug/1759920|lockups]]</nowiki> with the 180108 version of the intel-microcode
|-
| ppc64el
| <nowiki>[[https://www.ibm.com/blogs/psirt/potential-impact-processors-power-family/ | IBM]]</nowiki>
| Available from IBM
| 
|-
| s390x
| <nowiki>[[https://www.ibm.com/blogs/psirt/potential-cpu-security-issue/ | IBM ]]</nowiki>
| Available from IBM
| 
|-
| armhf, arm64
| <nowiki>[[https://developer.arm.com/support/security-update| ARM]]</nowiki>, <nowiki>[[http://phx.corporate-ir.net/phoenix.zhtml?c=209126&p=cavium_response| Cavium]]</nowiki>
| Available from system vendors
| A relatively small number of standard ARM cores are known to be affected
|}

==== Userspace Mitigations ====

Mitigations have been released for the following non-kernel packages:

{| class="wikitable"
|-
| Package
| USN
| Notes
|-
| Firefox
| <nowiki>[[https://usn.ubuntu.com/usn/usn-3516-1/|USN-3516-1]]</nowiki>
| <nowiki>[[https://blog.mozilla.org/security/2018/01/03/mitigations-landing-new-class-timing-attack/|Reduces resolution of timers, disables a mechanism that could be used to build a timer]]</nowiki>
|-
| WebKitGTK+
| <nowiki>[[https://usn.ubuntu.com/usn/usn-3530-1/|USN-3530-1]]</nowiki>
| <nowiki>[[https://webkitgtk.org/2018/01/10/webkitgtk2.18.5-released.html|Reduces resolution of timers, disables a mechanism that could be used to build a timer]]</nowiki>
|-
| NVIDIA graphics drivers
| <nowiki>[[https://usn.ubuntu.com/usn/usn-3521-1/|USN-3521-1 ]]</nowiki>
| 
|-
| QEMU
| <nowiki>[[https://usn.ubuntu.com/usn/usn-3560-1/|USN-3560-1]]</nowiki>
| Exposes Spectre variant 2 mitigations, added by microcode/firmware updates, to guests (i386, amd64, and s390x only)
|-
| libvirt
| <nowiki>[[https://usn.ubuntu.com/usn/usn-3561-1/|USN-3561-1]]</nowiki>
| Exposes Spectre variant 2 mitigations, added by microcode/firmware updates, to guests (i386 and amd64 only)
|}

==== Cloud Images ====
Cloud images which address CVE-2017-5753 and CVE-2017-5715 (aka Spectre) and CVE-2017-5754 (aka Meltdown) are available for <nowiki>[[download|https:--cloud-images.ubuntu.com]]</nowiki> from for the following releases:

{| class="wikitable"
|-
| '''Release'''
| '''Serial'''
|-
| trusty
| <nowiki>[[https://cloud-images.ubuntu.com/releases/trusty/release-20180122/ | 20180122]]</nowiki>
|-
| xenial
| <nowiki>[[https://cloud-images.ubuntu.com/releases/xenial/release-20180222/ | 20180222]]</nowiki>
|-
| artful
| <nowiki>[[https://cloud-images.ubuntu.com/releases/artful/release-20180222/ | 20180222]]</nowiki>
|}
<<BR>>
'''Important notes'''
* As release images are published in clouds many are indexed @ https://cloud-images.ubuntu.com/locator/  This tool can be used to find images with the above serials, or later, with applicable fixes.
* Previously released cloud images (serial 20180109 for xenial and artful and serial 20180110 for trusty) only mitigated Meltdown
* Note: A small number of systems running linux 4.4.0-108.131 were affected by LP: #Bug:1741934 which was fixed in 4.4.0-109.132. Cloud instances were not affected by the bug. Cloud images created using 4.4.0-108.131 and its derivatives (for example, linux-aws 4.4.0-1047.56) have the mitigations for Meltdown.
* Kernels compiled with retpoline enabled compiler flags on amd64 and i386 are only available for Ubuntu 16.04 LTS and Ubuntu 17.10 (serial 20180222 for both).

==== Ubuntu Core images ====
Canonical officially supports reference kernel snaps for amd64 (pc-kernel), i386 (pc-kernel), rpi2/rpi3 (pi2-kernel) and dragonboard (dragonboard-kernel). Updates for affected architectures for Meltdown are available:

{| class="wikitable"
|-
| '''Kernel'''
| '''Snap revision'''
| '''Ubuntu Core image'''
|-
| pc-kernel (amd64)
| 98
| http://cdimage.ubuntu.com/ubuntu-core/16/stable/current/ubuntu-core-16-amd64.img.xz
|-
| pc-kernel (i386)
| 99
| http://cdimage.ubuntu.com/ubuntu-core/16/stable/current/ubuntu-core-16-i386.img.xz
|}
<<BR>>
Early Raspberry Pi 2 boards use the <nowiki>[[https://www.raspberrypi.org/documentation/hardware/raspberrypi/bcm2836/README.md|Cortex-A7]]</nowiki> processor and later versions use the <nowiki>[[https://www.raspberrypi.org/documentation/hardware/raspberrypi/bcm2837/README.md|Cortex-A53]]</nowiki> processor. Raspberry Pi 3 boards use the <nowiki>[[https://www.raspberrypi.org/documentation/hardware/raspberrypi/bcm2837/README.md|Cortex-A53 processor]]</nowiki>. 96boards Dragonboard 410c boards use the <nowiki>[[https://www.96boards.org/product/dragonboard410c/|Cortex-A53]]</nowiki>.
<nowiki>[[https://developer.arm.com/support/security-update|According to ARM]]</nowiki>, none of these devices support speculative execution and are therefore unaffected by Spectre and Meltdown.  

==== Pre-release Updates Available For Testing ====

None at this time.

=== Timeline ===
* 2017 Nov 09: the Ubuntu Security team is notified by Intel under NDA
* 2017 Nov 20: the CRD is established as 2018-01-09
* 2017 Dec: the Ubuntu Security team receives notifications from additional silicon vendors about the impact to their products
* 2018 Jan 03: <nowiki>[[https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html|issue becomes public]]</nowiki> a few days before the CRD
* 2018 Jan 04: Canonical publicly <nowiki>[[https://insights.ubuntu.com/2018/01/04/ubuntu-updates-for-the-meltdown-spectre-vulnerabilities/ | communicates ]]</nowiki> the planned update schedule
* 2018 Jan 04: Mozilla releases <nowiki>[[https://blog.mozilla.org/security/2018/01/03/mitigations-landing-new-class-timing-attack/|timing attack mitigations]]</nowiki>
* 2018 Jan 05: Ubuntu Firefox updates are made available in <nowiki>[[https://usn.ubuntu.com/usn/usn-3516-1/ | USN 3516-1]]</nowiki>
* 2018 Jan 07: Candidate kernels are beginning to be made available for testing at <nowiki>[[https://launchpad.net/~canonical-kernel-team/+archive/ubuntu/pti/ | ppa:canonical-kernel-team/pti]]</nowiki>.  This initial round will address CVE-2017-5754 (aka Meltdown or Variant 3) for x86_64. We will address CVE-2017-5715 and CVE-2017-5753 (aka Spectre or Variant 1 & 2) in a subsequent round.  We will also address additional architectures in subsequent rounds.
* 2018 Jan 09: NVIDIA driver updates published, see <nowiki>[[https://usn.ubuntu.com/usn/usn-3521-1/| USN-3521-1]]</nowiki>
* 2018 Jan 09: Ubuntu kernel updates are made available in <nowiki>[[https://usn.ubuntu.com/usn/usn-3522-1/|USN 3522-1 (Ubuntu 16.04 LTS)]]</nowiki>, <nowiki>[[https://usn.ubuntu.com/usn/usn-3523-1/|USN 3523-1 (Ubuntu 17.10)]]</nowiki>,  <nowiki>[[https://usn.ubuntu.com/usn/usn-3522-2/|USN 3522-2 (Ubuntu 14.04 LTS (HWE))]]</nowiki>, and <nowiki>[[https://usn.ubuntu.com/usn/usn-3524-1/|USN-3524-1 (Ubuntu 14.04 LTS)]]</nowiki>.
* 2018 Jan 09: Notification issued for <nowiki>[[https://lists.ubuntu.com/archives/ubuntu-security-announce/2018-January/004214.html|livepatch users]]</nowiki> to reboot after applying kernel update.
* 2018 Jan 10: Updates for the pc-kernel snaps for Meltdown are released to the stable channel
* 2018 Jan 11: Updates to the intel-microcode package were released, see <nowiki>[[https://usn.ubuntu.com/usn/usn-3531-1/| USN-3531-1]]</nowiki>
** '''Note:''' These updates were reverted on ''2018 Jan 22''
* 2018 Jan 11: Core image updates for amd64 and i386 are <nowiki>[[http://cdimage.ubuntu.com/ubuntu-core/16/stable/current/|published]]</nowiki>
* 2018 Jan 12: <nowiki>[[https://launchpad.net/ubuntu/+source/linux | Linux kernel]]</nowiki> version 4.13.0-29.32 for Artful 17.10 with Spectre mitigations is available in artful-proposed for testing.
* 2018 Jan 16: <nowiki>[[https://launchpad.net/ubuntu/+source/linux | Linux kernel]]</nowiki> version 4.4.0-111.134 for 16.04 and 3.13.0-140.189 for 14.04 with Spectre mitigations is available in the respective -proposed pocket for testing.
* 2018 Jan 17: <nowiki>[[https://launchpad.net/ubuntu/+source/linux | Linux kernel]]</nowiki> version 4.13.0-30.33 for Ubuntu Bionic with Spectre mitigations is available in the bionic-proposed pocket for testing.
* 2018 Jan 22: Previous updates to the intel-microcode package were reverted at Intel's request, see <nowiki>[[https://usn.ubuntu.com/usn/usn-3531-2/| USN-3531-2]]</nowiki>
* 2018 Jan 22: Ubuntu kernel updates addressing all three vulnerabilities (CVE-2017-5715, CVE-2017-5753, CVE-2017-5754) across amd64, ppc64el and s390x are released in <nowiki>[[https://usn.ubuntu.com/usn/usn-3541-1/|USN-3541-1 (Ubuntu 17.10)]]</nowiki>, <nowiki>[[https://usn.ubuntu.com/usn/usn-3540-1/|USN-3540-1 (Ubuntu 16.04 LTS)]]</nowiki>, <nowiki>[[https://usn.ubuntu.com/usn/usn-3541-2/|USN-3541-2 (Ubuntu 16.04 LTS (HWE))]]</nowiki>, <nowiki>[[https://usn.ubuntu.com/usn/usn-3542-1/|USN-3542-1 (Ubuntu 14.04 LTS)]]</nowiki> and <nowiki>[[https://usn.ubuntu.com/usn/usn-3540-2/|USN-3540-2 (Ubuntu 14.04 LTS (HWE))]]</nowiki>.
* 2018 Jan 22: Ubuntu Cloud Images have been released with Spectre kernel mitigations
* 2018 Feb 07: QEMU and libvirt security updates published to expose Spectre variant 2 mitigations to guests
* 2018 Feb 21: Ubuntu kernel update addressing Spectre for x86 for Ubuntu 12.04 ESM in <nowiki>[[https://usn.ubuntu.com/usn/usn-3580-1/ | USN 3580-1]]</nowiki>
* 2018 Feb 21: Ubuntu kernel updates built with retpoline compiler options for x86 to mitigate Spectre v2 are released <nowiki>[[https://usn.ubuntu.com/usn/usn-3581-1/|USN 3581-1 (Ubuntu 17.10)]]</nowiki>, <nowiki>[[https://usn.ubuntu.com/usn/usn-3582-1/|USN 3582-1 (Ubuntu 16.04 LTS)]]</nowiki>, <nowiki>[[https://usn.ubuntu.com/usn/usn-3581-2/|USN 3581-2 (Ubuntu 16.04 LTS (HWE))]]</nowiki>, <nowiki>[[https://usn.ubuntu.com/usn/usn-3582-2/|USN 3582-2 (Ubuntu 14.04 LTS (HWE))]]</nowiki>
* 2018 Feb 21: gcc packages supporting retpoline options for x86 published to <nowiki>[[ https:--launchpad.net-ubuntu-+source-gcc-7-7.2.0-8ubuntu3.2 | Ubuntu 17.10]]</nowiki>, <nowiki>[[ https:--launchpad.net-ubuntu-+source-gcc-5-5.4.0-6ubuntu1~16.04.9 | Ubuntu 16.04 LTS]]</nowiki>, and <nowiki>[[ https:--launchpad.net-ubuntu-+source-gcc-4.8-4.8.4-2ubuntu1~14.04.4 | Ubuntu 14.04 LTS]]</nowiki>
* 2018 Feb 21: Ubuntu kernel update addressing meltdown for ppc64el for Ubuntu 14.04 LTS in <nowiki>[[https://usn.ubuntu.com/usn/usn-3583-1/|USN 3583-1]]</nowiki>
* 2018 Feb 22: Ubuntu Cloud Images have been released with retpoline compiled kernels for amd64 and i386 for Ubuntu 17.10 and Ubuntu 16.04 LTS
* 2018 Mar 9: Ubuntu kernel update addressing spectre for amd64 and i386 Ubuntu 14.04 LTS in <nowiki>[[https://usn.ubuntu.com/3594-1/|USN 3594-1]]</nowiki>
* 2018 Mar 13: intel-microcode 20180312 updates are made available in the <nowiki>[[https://launchpad.net/~ubuntu-security-proposed/+archive/ubuntu/ppa|ubuntu-security-proposed PPA]]</nowiki> and uploaded to Ubuntu Bionic
* 2018 Mar 15: Ubuntu kernel updates for 4.13 and 4.13 HWE released with mitigations for arm 64, see <nowiki>[[https://usn.ubuntu.com/usn/usn-3597-2/|USN-3597-2]]</nowiki>
* 2018 Mar 29: intel-microcode 20180312 released, see <nowiki>[[https://usn.ubuntu.com/usn/usn-3531-3/|USN-3531-3]]</nowiki> 
* 2018 May 29: amd64-microcode made available for testing in the <nowiki>[[https://launchpad.net/~ubuntu-security-proposed/+archive/ubuntu/ppa|ubuntu-security-proposed PPA]]</nowiki>
* 2018 Jun 20: amd64-microcode updates released, see <nowiki>[[https://usn.ubuntu.com/usn/3690-1/|USN-3690-1]]</nowiki>
* 2018 Jul 5: amd64-microcode update released fixing regression, see <nowiki>[[https://usn.ubuntu.com/usn/3690-2/|USN-3690-2]]</nowiki>

=== Additional Side Channel Issues ===
Since Spectre and Meltdown were disclosed, additional side channel issues have been disclosed and documented in separate !KnowledgeBase articles. You can see these articles at the following URLs:
{| class="wikitable"
|-
| May 2018
| <nowiki>[[..-Variant4| Variant 4]]</nowiki>
| Speculative Store Bypass
| <nowiki>[[https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3639.html | CVE-2018-3639]]</nowiki>
|-
| June 2018
| <nowiki>[[..-LazyFP| LazyFP]]</nowiki>
| LazyFP Save/Restore
| <nowiki>[[https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3665.html | CVE-2018-3665]]</nowiki>
|-
| July 2018
| <nowiki>[[..-BCBS| BCBS]]</nowiki>
| Bounds Check Bypass Store
| <nowiki>[[https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3693.html | CVE-2018-3693]]</nowiki>
|}
