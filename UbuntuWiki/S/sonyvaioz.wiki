{|
  | '''Warning'''
  * This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
  * '''Images''' and '''attachments''' have been removed to conserve space.
  * '''Links''' may not work and there may be formatting issues.
  * A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

'''NOTE: THIS PAGE CONTAINS LEGACY INFORMATION ABOUT RUNNING LINUX ON THE SONY VAIO Z SERIES.  FOR THE LATEST INFORMATION, PLEASE JOIN OUR LAUNCHPAD GROUP OR VIEW THE ARCHIVED MAIL THREADS.
https://launchpad.net/~sony-vaio-z-series '''

A complete installation howto here by eva-brucherseifer:
http://www.basyskom.org/~eva/log_installation_vaio_z21vnx.html

-------------------------------------------------------------------
You can check the model and generation of you laptop with this command:

''sudo dmidecode -s system-product-name''
-------------------------------------------------------------------

The current battery life with latest sony-laptop module is 5 hours and 30 minutes, with power consumptions as low as 9.5W. To achieve this, use a standard Jaunty with the following points:

- laptop-mode enabled (package 'laptop-mode-tools'): intel-sata-powermgmt, sched-mc-power-savings and usb-autosuspend.
- don't lock the cpufreq to the lowest frequency: this is bad for power usage.
- rfkill on the bluetooth device (using a personal laptop-module).
- lower (but not lowest) LCD brightness.
- with the specific module laptop-mode can tweak the power management of the driver iwlagn but it uses the interface
/sys/class/net/$IF/device/power_level; I use to do a further 'iwconfig wlan0 power on' with great difference (using a personal laptop-module).

--------------------------------------------------------------------------------------------------------------------------------------

Current issues:

Nvidia/Intel hybrid graphics switching.

This machine is the successor of the SZ premium series, and has a Dynamic Hybrid Graphics system that will enable/disable the nvidia graphics card using a software "hot" switch instead of a hardware "cold" switch (SZ series).

http://vaio-online.sony.com/prod_info/series1/z/interview_Z/index_05.html

In the way it's shown in the video, it seems like Windows Vista does the equivalent of a "gdm restart" in Linux when switching from the nvidia graphics card to the integrated intel card (to confirm).

eva-brucherseifer reports that Sony's DSDT is significantly different from previous models, probably to enable special hardware support e.g. for the graphics card switching, enabling/disabling the 3G module and more. Any further input here is welcome.

DSDT is an acronym for Differentiated System Description Table. The table contains the Differentiated Definition Block, which supplies the information and configuration information about the base system. It is always inserted into the ACPI Namespace by the OS at boot time. Unfortunately, many hardware vendors and OEMs are not capable of supplying fully functional tables.

For laptops like the Sony Vaio Z series, there is currently Linux support for cold switch of the graphics card:

Load Eva's sony-laptop module with speed_stamina=3.
In the file called /etc/modprobe.d/sony-laptop.conf add the following line:

-------------------------------------------------------------------
options sony-laptop speed_stamina=3
-------------------------------------------------------------------

Then boot with this kernel parameter (use the quotes):

-------------------------------------------------------------------
acpi_osi="!Windows 2006"
-------------------------------------------------------------------

Just put it in the kernel command line of your boot manager.

Now you can switch between stamina and speed without booting to Windows, but your laptop have to be completely powered off, not rebooted.

Nvidia driver overwrites libglx.so and libGL.so.1 with symbolic links like mentioned above. So before installing nvidia driver, backup the current libglx.so und libGL.so.1 to libglx.so.INTEL/libGL.so.INTEL. If you have already installed nvidia, you can get the original files from "xserver-xorg-core" package, respectively "libgl1-mesa-glx".

For loading the correct xorg.conf, this little script needs to run before starting xserver:

-------------------------------------------------------------------

lspci | grep "00:02.1"

if [ $? -eq 0 ]; then
   cp /etc/X11/xorg.INTEL /etc/X11/xorg.conf
   ln -sf /usr/lib/libGL.so.INTEL /usr/lib/libGL.so.1
   ln -sf /usr/lib/xorg/modules/extensions/libglx.so.INTEL /usr/lib/xorg/modules/extensions/libglx.so
else
   cp /etc/X11/xorg.NVIDIA /etc/X11/xorg.conf
   ln -sf /usr/lib/libGL.so.185.18.08 /usr/lib/libGL.so.1
   ln -sf /usr/lib/xorg/modules/extensions/libglx.so.185.18.08 /usr/lib/xorg/modules/extensions/libglx.so
fi
-------------------------------------------------------------------

To have the right screen resolution when using the nvidia card on the Linux Sony Vaio Z-series:
If your resolution is 1600x900, then on the nvidia side I have added the DPI to force it to the intel value:

-------------------------------------------------------------------
Section "Device"

Identifier "Configured Video Device"

Driver "nvidia"

Option "UseEDIDDpi" "FALSE"

Option "AddARGBGLXVisuals" "true"

Option "DPI" "96 x 96"

EndSection
-------------------------------------------------------------------
(For brightness control, one can add shortcuts for low, medium, high brightness through nvidia driver commands.)

To get the speakers to shut when using the headphones plug, add this line to "/etc/modprobe.d/alsa-base":

-------------------------------------------------------------------
options snd-hda-intel model=sony-assamd
-------------------------------------------------------------------
(Another user proposes "model=hippo" instead to make a "Headphone" slider appear in alsamixer.)

To get the microphone working, create a file (by root or using 'sudo') in /etc/modprobe.d/ with a line like

-------------------------------------------------------------------
options snd-hda-intel model=toshiba-s06
-------------------------------------------------------------------
then reboot (or unload and reload the module).

The jack for external microphone works using:

-------------------------------------------------------------------
options snd-hda-intel model=sony-assamd
-------------------------------------------------------------------
in a file in '/etc/modprobe.d/'.

Troubleshooting for Sound/Mic
You can check for your default mixer by going to System>>Preferences>>Sound. After you have the right mixer selected (You can choose between HDA Intel, OSS, or Alsa options), you can select "Open Volume Control" by right clicking the Volume applet, and make sure that in "Options," the "Input Source," is 'Int DMic'.
(Attention: Digital-Capture-Source starts muted by default. You may have to "un-" mute it by hand, depending on your choice of mixer.)

Suspend/hibernate reported to work:
a) with this kernel => 2.6.27-11-generic #1 SMP Thu Jan 29 19:24:39 UTC 2009 i686 GNU/Linux
b) through powersaved via kpowersave (KDE).
c) Trying the instructions here: http://www.claudiocamacho.org/tech/sr11m_debian.php#s4s15

You can use this script to bring back the backlight settings after wake-up, instead of the simple "echo mem > /sys/power/state". It restores the original display settings after wakeup, especially the backlight, which otherwise is set to the highest value (at least on my system). It assumes that Eva's sony-laptop module is installed.

The Fingerprint Reader does work with configuration based on work by eva-brucherseifer:
http://www.basyskom.org/~eva/log_installation_vaio_z21vnx.htmlEva's work
(Please realize that fingerprint readers in Linux in general do not offer any added security for your machine, and may not be the best choice for functions such as logging into one's system)

To switch on/off the 3G device, There is now support in the sony_laptop kernel driver and to get it work with hsoconnect. For a more detailed installation summary, see this page:
http://www.basyskom.org/~eva/log_installation_vaio_z21vnx.html

-------------------------------------------------------------------
Bluetooth (Gnome, Ubuntu, specifically)
http://blueman-project.org/
Using Blueman package instead of gnome-bluetooth will give much better results. It allows one to shutoff bluetooth completely from the gui, and device browsing and tethering is also much improved.

For Ubuntu Jaunty
1) Add Source
deb http://ppa.launchpad.net/blueman/ppa/ubuntu jaunty main

2) Install Blueman
sudo apt-get install blueman

-------------------------------------------------------------------

case $(</sys/devices/platform/sony-laptop/speed_stamina) in
(stamina) videoId=00/02.0
            ;;
(speed) videoId=01/00.0
esac

tmpfile=/tmp/video_state
trap 'rm -f $tmpfile' 0 1 15
cat /proc/bus/pci/$videoId > $tmpfile
sync

echo mem > /sys/power/state

sleep 2
cat $tmpfile > /proc/bus/pci/$videoId
rm -f $tmpfile
-------------------------------------------------------------------

Can people that can't suspend to ram please subscribe to this bug and try to submit the following info:
https://bugs.launchpad.net/ubuntu/+source/linux/+bug/283401
1. Please include the output of the command "uname -a" in your next response. It should be one, long line of text which includes the exact kernel version you're running, as well as the CPU architecture.
2. Please run the command "dmesg > dmesg.log" after a fresh boot and attach the resulting file "dmesg.log" to this bug report.
3. Please run the command "sudo lspci -vvnn > lspci-vvnn.log" and attach the resulting file "lspci-vvnn.log" to this bug report.

--------------------------------------------------------------------------------------------------------------------------------------

Unsolved/Pending Bugs:

One could disable the hal polling on the CD drive but actually there is a bug in it (https://bugs.launchpad.net/ubuntu/+source/hal/+bug/358390).

Optic DVD unit: it should be possible to use ACPI to turn it off, but nobody has found how yet.

Firewire: unloading the module may power off the device (unconfirmed).

Reboot problems. (MARKED SOLVED: UPDATE VAIO BIOS THROUGH YOUR WINDOWS INSTALLATION, SEEMS TO FIX HANG DURING REBOOT)
* It freezes in the last stage of the process (more info needed, file a bug in http://bugs.launchpad.net).

The Pro Magic Gate slots for memory cards don't work neither.

Issues in getting gsynaptics to work with touchpad (more info needed, file a bug in http://bugs.launchpad.net).

The Intel driver also has a problem, reported here:
http://bugs.freedesktop.org/show_bug.cgi?id=17508
--------------------------------------------------------------------------------------------------------------------------------------
