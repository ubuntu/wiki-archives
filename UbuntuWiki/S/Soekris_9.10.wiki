{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

== Soekris net5501 ==
This article is to describe how to get Ubuntu Karmic Koala working with the Soekris <nowiki>[[http://soekris.com/net5501.htm|net5501]]</nowiki>.
=== Notes ===
This was patterned after the <nowiki>[[Soekris|Soekris on Feisty Fawn]]</nowiki> page, which has much better explanations.
=== Preliminary Work ===
Some notes:
* My Soekris box has a 500GB Fujitsu drive in it; it does not have a compact flash.
* My dhcp server is a FreeBSD server, but it uses ISC-DHCP, so the dhcpd.conf entries should be the same
* My tftp/http server is a Fedora server, so the apache configuration will be slightly different than an ubuntu server's.  I encourage someone to update the instructions to make it pure ubuntu and remove the references to FreeBSD & Fedora.
* I could never get the grub menu to show up on the serial port.  The kernel boot output and login prompt yes, but the grub menu, no.  I finally gave up.  I hope wiser minds can figure this out.
* To connect to the net5501, I use a trendnet TU-S9 usb-serial port with a 9-pin female-female gender changer and 9-pin null modem adapter.  My ubuntu laptop recognizes the trendnet and assigns it /dev/ttyUSB0.  I use minicom as my terminal client.
==== Setting console speed ====
* Set your preferred console program to 19200 8n1 no-flow-control and connect your computer to the serial port of your Soekris.  ANSI terminal emulation is better than VT102.
* Power on your Soekris and hit CTRL-P to enter the BIOS.
* Type the following commands:
<pre>
set ConSpeed=115200
reboot
</pre>
* Now change your terminal program to 115200 bps.  You should be able to interact with the soekris.
==== Setting up PXE-Environment ====
Some notes:
* dhcp server:  vazir.nono.com, 10.22.0.23  FreeBSD
* http server:  tata.nono.com, 10.22.0.29  Fedora
* soekris:  staging-1.nono.com, 10.22.0.91  Ubuntu
* the tftp/http server has an image of the install iso at /local/iso/ubuntu-9.10-server-i386.iso.
* do this on your http server that will serve the ubuntu image:
<pre>
sudo mkdir -p /mnt/ubu /local/dnld/ubuntu/9.10/i386
sudo mount -o loop /local/iso/ubuntu-9.10-server-i386.iso /mnt/ubu
sudo rsync -axSH --stats /mnt/ubu/ /local/dnld/ubuntu/9.10/i386/
sudo vim /etc/xinetd.d/tftp
    server_args             = -vv -s /local/dnld/ubuntu/9.10/i386
sudo killall -HUP xinetd
sudo vim /etc/httpd/conf/httpd.conf
    Alias /ubuntu/ "/local/dnld/ubuntu/9.10/i386/"
    <Directory "/local/dnld/ubuntu/9.10/i386">
        Options Indexes FollowSymLinks
        AllowOverride None
        Order allow,deny
        Allow from all
    </Directory>
sudo service httpd restart
sudo vim /local/dnld/ubuntu/9.10/i386/ks.cfg
    install
    url --url http://10.22.0.29/ubuntu/
cd /local/dnld/ubuntu/9.10/i386
sudo vim install/netboot/pxelinux.cfg/default
    SERIAL 0 115200 0
    LABEL server
            kernel ubuntu-installer/i386/linux
            append ks=http://10.22.0.29/ubuntu/ks.cfg base-installer/kernel/linux/extra-packages-2.6= tasks=standard pkgsel/language-pack-patterns= pkgsel/install-language-support=false vga=normal initrd=ubuntu-installer/i386/initrd.gz console=ttyS0,115200n8 --
</pre>
* Now on the dhcp server (note, you will ''definitely'' have a different mac addr).  These instructions are for a FreeBSD server, so the location of the dhcp file will be different on ubuntu (/etc/dhcpd.conf?), as will the mechanism to restart it.
<pre>
sudo vim /usr/local/etc/dhcpd.conf
host staging-1 {
    hardware ethernet 00:00:24:cc:7e:48;    # new soekris
    fixed-address 10.22.0.91;
    next-server tata.nono.com;
    filename "install/netboot/pxelinux.0";
    option root-path "/local/dnld/ubuntu/9.10/i386";
}
sudo /usr/local/etc/rc.d/isc-dhcpd restart
</pre>
==== Let's start the install ====
Warning:  make a separate, small /boot partition at the beginning of the disk, otherwise you will spend the day troubleshooting grub "error: out of disk" messages.
<pre>
English
United States
Manual
   primary 1 .25 GB ext3 /boot bootable
   primary 2 .25 GB ext3 /mnt/ubu_10/boot
   logical 5 40GB  ext4 /
   logical 6 40GB  ext4 /mnt/ubu_10/
   logical 7 3GB   swap
   logical 8 416.6GB ext4 /local
Joe Mama
joemama
xxx
xxx
Go Back
Execute a Shell # "An installation step failed..."
Continue
Execute a Shell # "After this message, ..."
Continue
mount -t proc none /target/proc
chroot /target
bash -o vi # or whatever your favorite shell & settings are
vi /etc/default/grub # put these lines at the very bottom
    GRUB_CMDLINE_LINUX_DEFAULT="console=tty0 console=ttyS0,115200n8"
    GRUB_TERMINAL="serial"
    GRUB_SERIAL_COMMAND="serial --unit=0 --speed=115200 --word=8 --parity=no --stop=1"
update-grub # ignore "Cannot find list of partitions!"
vi /etc/init/ttyS0.conf
### ttyS0 - getty
### 
### This service maintains a getty on ttyS0 from the point the system is
### started until it is shut down again.

    start on stopped rc RUNLEVEL=[2345]
    stop on runlevel [!2345]

    respawn
    exec /sbin/getty -8 115200 ttyS0
^D
^D
finish the installation
-   UTC?  yes
-   finished, reboot?  continue
</pre>

=== Known bugs ===
* I could never get the grub menu to show up on the serial console.

----
CategoryHardware
