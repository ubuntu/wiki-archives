{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

== Migrating Launchpad Servers to Hoary ==

=== Status ===

* Created: 2005-04-26 by JamesTroup
* Priority: NeedsPriority
* People: JamesTroupLead, SteveAlexanderSecond
* Contributors: AndrewBennetts, StuartBishop, RobertCollins, MarkShuttleworth
* Interested:
* Status: LaunchpadSpecification, ApprovedSpecification
* Branch: 
* Malone Bug: 
* Packages: 
* Depends: 
* Dependents:
** UduSessions: 1 

=== Introduction ===

This specification is intended to describe how and when we plan to upgrade the servers running the Launchpad infrastructure from the Warty distribution to the Hoary distribution.

=== Rationale ===

The upgrade from Warty to Hoary involves changing a lot of software, most significantly including changing the default version of python from 2.3 to 2.4.  These changes have the possibility of introducing bugs and other breakage and so require careful planning of the upgrade to mitigate these risks.

=== Scope and Use Cases ===

This specification is limited to the servers running Launchpad and related services.  Namely: 

* emperor (database)
* macquarie (production)
* mawson (dogfood)
* chinstrap (pqm)
* galapagos (importd)

=== Implementation Plan ===

The major risk in upgrading the Launchpad servers is in upgrading to python2.4.  To mitigate this risk the upgrade will be done in 3 parts:

=== Stage 1:  Upgrade to Hoary (python2.3) ===

In the first stage we will upgrade to hoary but also install python2.3 (and python2.3-* as needed) and use that rather than hoary's default of python2.4.

Since /usr/bin/python is a symlink rather than using the update-alternatives mechanism this requires the Launchpad code to hardcode the path to the interpreter to use python2.3.  Apparently all the code except the cron scripts already does this.  StuartBishop is going to fix the cron script to also do this before the upgrade begins.

The upgrade will also be staged across machines so that breakage can be isolated.  The plan & schedule is:

* On 2005-05-05 (Thu) chinstrap will be upgraded.  This means any commits will be running their test-suites in the hoary (but using python2.3) environment.
* Assuming no problems: emperor, galapagos and mawson will then be upgraded.
* After a certain period (anything from 3 - 7 days), assuming no further problems, macquarie will be upgraded.

Each upgrade will be scheduled to coincide with relevant services admin availability (i.e. StuartBishop for emperor, DavidAllouche for galapagos etc.).

=== Stage 2: Launchpad developers and dogfood switch to python2.4 ===

The second stage is for the developers and dogfood to switch to using python2.4.  This will allow any resulting bugs and kinks to be detected and ironed out before production is upgraded. 

=== Stage 3: Switch production to python2.4 ===

This will be the same staged roll out as in stage 1.

==== Data Preservation and Migration ====

Our existing backup strategies and infrastructure will provide adequate data preservation.  There should not be any need to migrate data.

----
CategoryUdu
CategorySpec 
