{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__



== BazLocalMirrors ==

=== Comments ===

=== Status ===

* Created: 2005-04-25 by ScottJamesRemnant
* Priority: MediumPriority
* People: JamesBlackwellLead, RobertCollinsSecond, JamesBlackwellQueue, RobertCollinsQueue
* Contributors: 
* Interested: ScottJamesRemnant, MartinPool
* Status: EditedSpecification, BazaarSpecification, LaunchpadSpecification
* Branch: 
* Malone Bug: 
* Packages: 
* Depends: 
* Dependents:
** UduSessions: 1, 4, 8, etc 

=== Introduction ===

The supermirror will not scale indefinitely. This specification covers mirroring the supermirror to other locations. This specification supports limited supermirror mirroing and the tracking of which branches are being mirrored by which mirror.

=== Rationale ===

Having one massive arch server and super-mirror really doesn't scale.  Mirrors should be automatically selected and localised based on countries and Internet hubs.

Though the supermirror remains a central point of aggregation for all archives, client load is distributed amongst many machines -- many of which will be hosted by third parties such as Universities. In addition, Each third party may choose which portions of the supermirror that they wish to mirror. 

Rather than dictate a one-size-fits-all mirror script for mirror slaves, the implementation is not defined for them. Instead, they may download from a supermirror list of branches that are available and their current versions and choose which parts they mirror. By sending notification to the admin of the supermirror, an equivilant archive, created by the mirror of the supermirror, will be monitored. Thusly, willing participats become a local part of the supermirror.

=== Scope and Use Cases ===

HCT etc. will need to select a suitable local mirror for retrieving packages; and for sending changes to.

 1. A local university decides to have a local mirror of the SuperMirror for performance improvements and bandwidth savings.

 1. A visitor to the aforementioned university would like to use work listed at the supermirror. She would like to use the closest mirror but does not know that the University's mirror exist. 

 1. Simon registers an archive on the supermirror. Simon would prefer to use the fastest nearby mirror

 1. A large Linux distribution would like a limited mirror of the supermirror, for the packages that they own.

=== Implementation Plan ===

1. Create a supermirror archive. In the supermirror archive create a supermirror branch. In the supermirror branch, for each branch at the supermirror, keep a metadata file that lists things such as the revisions in the branch, the last date the branch was mirrored, so forth and so on.

2. When a branch at the supermirror is updated, update the metadata file for the branch in the supermirror branch and commit. 

3. Mirrors of the supermirror may use the supermirror branch to decide which branches to either start mirroring or to update mirroring. If they are already mirroring, they can track whether or not they need to update their mirror by checking against the latest revision listed in the meta-data file for the branch archive

4. Mirrors of the supermirror may create an archive of the same format as the supermirror (which is a list of what archives/branches. this local mirror supports). If the supermirror is notified of these archives, then the supermirror will use the branch to track what branches the mirror is tracking, its status, etc. The supermirror will use this information for the mirror list for other mirrors.

5. When clients and mirrors contact the supermirror for downloading branches, the supermirror will indicate to either the client or mirror two mirrors: 1. the mirror that is geographically closest (likely to be fastest) and the mirror that is most current. The client, based on local configuration, can choose which one it wants.

6. The mirror or client will update against the listed branch.

==== Data Preservation and Migration ====

No data needs to be changed or migrated.

==== Packages Affected ====

* `Launchpad`
* `Super Mirror`
* `Bazaar`
* `HCT`

==== User Interface Requirements ====

No known user interface requirements exist. 

=== Outstanding Issues ===

* (Incorrect line) Need two-way mirroring to allow writing to the local supermirrors, and sending the patches towards the main one.

==== UDU BOF Agenda ====

==== UDU Pre-Work ====

----
CategoryUdu
CategorySpec 
