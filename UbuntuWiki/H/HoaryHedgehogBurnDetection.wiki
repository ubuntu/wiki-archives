{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

== Burn Detection ==

  "''...one step away from Copy Protection''"

* <sladen> I think there's a real case for having d-i check the parts of the CD itself.  There's an unbelievable number of dud burns happening; [...]
* <'''Neal'''> we could improve the boot help files and documentation to clarify that the user just needs to boot into expert mode to check the integrity by hand.
* <'''Kamion'''> we could default cdrom-checker/start to true, but it's probably pretty slow ...
* <'''Kamion'''> shame that we can't do the integrity check only on burnt CDs, not pressed ones

Greater than 50% of the installation problems I've responded to have been down to mis-burnt CDs.  The normal method for asking the user to check this out is to have them:

<pre>
sudo md5sum /dev/cdrom      # eg.  /dev/hdc
</pre>

and compare this to the <nowiki>[[http://archive.ubuntulinux.org/cdimage/daily/current/MD5SUMS|MD5SUMS]]</nowiki> file on the Ubuntu download site.  Mainly, this turns out to be CD itself, although it one instance it was a dodgy file and rsync dealt with that for them:

<pre>
rsync -cCvzapP --stats rsync://archive.ubuntu.com/cdimage/daily/current/warty-i386.iso ./warty-i386.iso
</pre>

=== Continuing the conversation ===

* <sladen> Kamion: yes we can.  Just munge Canonical's offical ISO's with an extra flag
* <'''Kamion'''> sladen: disapprove heavily of that kind of thing

Well, this is the simplist solution.  Have two ISO images, one which is sent off to get pressed commerically and one which goes on the website and has '''cdrom-checker/start''' enabled.

* <'''Kamion'''> sladen: also, we'll be publishing the official ISOs; what's to stop people burning them, or indeed from copying pressed CDs?

If the actual ISO images must remain the same.  This makes a possible solution somewhat harder;  you need to find an out-of-band way (not in the ISO) of detecting whether the CD was burnt vs. pressed.

* <sladen> Kamion: can bit-twiddle sometime off the end of the CD;  is somebody copies it, it'll disappear
* <'''Kamion'''> sladen: I will not do that, sorry
* <'''Kamion'''> if somebody else wants to, they'll need to have CD-pressing equipment to test it with
* <sladen> Kamion: if I wrote the code, would you consider using it?  :-)
* <'''Kamion'''> sladen: probably not, I really dislike that sort of hack
* <'''Kamion'''> sladen: it's one step away from copy protection

Okay, Kamion isn't keen on this one.  Though this is probably the best one to follow up.  By writing data off the end of the CD, it would have the advantage that straight-forward copy (eg.  All the 'extras' items in Neo at defaults) would produce an ISO exactly matching the one on the website.  When this ISO is written back to disk it would match the MD5SUM from the website.

If an `extremely special' burn had been done, the CD would still show up as having from the pressed batch;  however, anyone doing this probably either ''is'' pressing them themselves in large quanities, or knows what they're doing.

This is of course, assuming it is possible to write extra data off the end of the CD in a same way;  the key thing to remember would be that '''this is just guidance to D-I to putting up a dialogue''' stating that this CD /may/ have been burnt, and asking whether the user wish to run a checksum.  This is analogous with Debian asking whether to run a full badblocks check before formatting new partitions.

* <'''Kamion'''> sladen: if we could test in software whether the CD had been burnt, that would be marginally less gross; AFAIK you can't
* <'''Kamion'''> sladen: and I mean something that doesn't depend on properties of the ISO
* <sladen> Kamion: it maybe possible to do something non-hackish, if they burnt to a CD-RW

CD ''rewriters'' seem to be able to check for ''rewriteable'' disks...

=== Efficiency ===

The above is appears not to be efficient;  whilst it might be simple and easy to give the user the option of checksumming the disk (the code already exists in d-i), reading the entire disk through twice (once to checksum and then a second time to copy the packages off) seems inefficient.  In the ideal setup the limiting factor in the installation would be the speed of the CD-ROM drive.

Hence, it would make more sense to have D-I check only itself, udebs and config files (~10MB ?). It could do that regardless (in the background whilst the user is responding to questions).

Now that the packages lists have been checked, it might be worth checking the the validity of each deb (by a method other than waiting for the tar extraction to file...).  This would be best done when the package file has already been loaded into RAM.  Introducing GPG, as is intented elsewhere, would flag this up immediately too.

The downside is that the user can't be told ''immediately'' at the start of installatoin that their CD is a dud and so may go all the way through partitioning, or even most of installation, before finding out.

=== Conclusion ===

'''Anyway, given that even a pressed CD can get "damaged in the post", is it really worth the hassle?'''

Quite possibly not.  Most burning programs try to insist on a verify (although people do turn it off to save time...).

Perhaps it would be possible to checksum the first 50MB and present the user with an extrapolated estimate based on the time it should take and the speed of the CD drive;  ...but that's introducing another irritating question to the installation (and the computer's view, it would always be ''yes, I want to check the CD so I know I don't feed myself nonsense''.

Five minutes (time to verify a CD on a 12x reader) is fairly small in comparision to the full installation time (20min - 40min).

At the end of the day, what costs Canonical will be support time;  if the numbers add up and a large percentage of time is being wasted owing to duff CDs, it might be worth looking into again.

=== Notes ===

PaulSladen 2004-09-22

From JanC Thu Dec 9 19:21:01 +0000 2004
From: JanC
Date: Thu, 09 Dec 2004 19:21:01 +0000
Subject: detect CD-R(W)
Message-ID: <20041209192101+0000@www.ubuntulinux.org>

You can detect CD-R(W) media by reading the ATIP info (e.g. cdrecord's -atip option), but that only works with CD/DVD-(re)writer drives AFAIK.
