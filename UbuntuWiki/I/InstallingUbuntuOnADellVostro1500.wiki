{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

=== Introduction ===

The company i work for, recently bought some Dell Vostro 1500 for our technical staff, and luckily i was allowed to do some tests on them for this wiki. I hope it helps someone out there.

Installing Ubuntu Gutsy 7.10 on a Dell Vostro 1500 is straightforward. This time i took two different approaches, one using Dell Reinstallation ISO, the other one using Ubuntu standard ISO.  Both aproaches seem to work well, if you use the Dell ISO you'd save some time solving the audio issue and the flash player bug ( https://bugs.launchpad.net/ubuntu/+source/flashplugin-nonfree/+bug/173890 ) , the other problems seem to be there, but as i've said in my previous post these are not showstoppers in any way.

=== About Dell Reinstallation ISO ===

As Dell kindly provided some OS Reinstallation ISOs for Inspiron 1420n, 530n and the XPS M1330n i've decided to give them a try.  As I've previously used the Inspiron 1420n fixes for my Vostro 1700 (https://wiki.ubuntu.com/InstallingUbuntuOnADellVostro1700) i'm using the 1420n intel x3100 DVD ISO image for the install. You can grab your copy here:

http://linux.dell.com/wiki/index.php/Ubuntu_7.10#Dell_OS_Reinstallation_7.10_DVD_ISO

WARNING:  If you push the Windows Media Direct Button after installing the Dell OS Reinstallation DVD you would lost the GRUB start, i'm just looking at this issue so i can provide a workaround.  If you push it back after power off the laptop it seems to solve or restore the previous partition. But every time you push this button when the laptop is powered off you'll lost your partition table. I'm working in this issue in order to find and acceptable workaround.

=== About Dell Vostro 1500 ===

The specs for the laptop are:

* 15.4" WXGA+ (1280x800)
* 2GB DDR2 667Mhz SDRAM
* DVD+/-RW 8X IDE (HL-DT-ST DVD+/-RW GSA-T21N, FwRev=A102 ) Hitachi LG drive 
* MK1246GSX, FwRev=LB212D 120G TOSHIBA Hard Drive
* Intel Corporation Mobile GM965/GL960 Integrated Graphics 
* Intel PRO/Wireless 3945ABG (802.11a/b/g) 
* Broadcom Corp BCM2045 Dell Computer Corp Bluetooth (ID 413c:8126)
* Ricoh Co Ltd R5C822 SD/SDIO/MMC/MS/MSPro Host Adapter (03:01.1)
* Intel Corporation 82801H (ICH8 Family) HD Audio Controller

=== List of bugs affecting this system ===

Wireless subsystem (Dell's ISO & Ubuntu's ISO)

With the ipw3945 driver:

https://bugs.launchpad.net/ubuntu/+source/linux/+bug/109887   [Wireless connection drops] 

With the iwl3945 driver:

https://bugs.launchpad.net/ubuntu/+source/linux-ubuntu-modules-2.6.22/+bug/176271  [throughput diminished]
https://bugs.launchpad.net/ubuntu/+source/linux-ubuntu-modules-2.6.22/+bug/130457  [suspend, hibernate issues]

Audio subsystem (Ubuntu's ISO)

https://bugs.launchpad.net/ubuntu/+source/linux-source-2.6.22/+bug/78257 [No sound after suspend]

Hard Disk Drive  (Dell's ISO & Ubuntu's ISO)

https://bugs.launchpad.net/ubuntu/+source/linux-source-2.6.22/+bug/137470  [NCQ spurious completions]

https://bugs.launchpad.net/ubuntu/+source/acpi-support/+bug/59695   [Click Noise in HDD, excessive load/unload cycles may shorten your hdd lifetime]

=== Dell's ISO details of Installation ===

You'll have three option for starting the DVD, a simple ENTER would let you go with the Dell automated install. live would let you start a traditional Ubuntu  Live CD and hd would let you start from the Disk Drive.

With the ENTER option the Live Desktop would not start but an automated install would be held.  Take into account that as this ISO is a Reinstallation media, it would WIPE OUT totally your hard drive.  Also you wouldn't have the chance to adjust your partitioning schema as is by factory default's (I don't like it very much, but it's minded for a general audience so probably is the simplest one).  At the end of the automated install you'll be asked for language, keyboard and user data.  

Restart your system and you'll be ready to go.

Be sure to apply all of the updates, also it's a good time to enable all the repositories.

As soon as it's finished you'll want to solve the Wireless and Hard Disk Drive issues.

=== Ubuntu's ISO details of Installation ===

The major issue at install time is the repartitioning of the Dell System.  Mine had Vista Home Basic and Dell Media Center (Xp embebed).  Sadly the partitioning scheme was really awful, there was 3 primary partitions (Dell Utility, OS for Vista, Recovery for the Factory Image) and  a tiny extended partition for Media Center.  Besides all my effort to repartitioning the drive with a sane scheme without losing the system i was forced at the end to wipe out the system and install Ubuntu alone.  On a side note i was pretty amazed with the capabilities of Gparted it really worked really well.

For Internet access during install you can use the Wireless or the Wired card, you only have to make sure with the wireless that you're connected to the access point.

You'll notice that the system has no audio at all, but don't worry that this would get solved after install

==== Solving the issues ====

=== AUDIO ===

(Ubuntu's ISO)

This is completely solved with the Dell ISO, so this only applies to the normal installation.

Before solving the audio issue, please make a full update.   In my testings if i didn't update the system i wasn't able to solve the audio issue.

Now with the missing sound. There are several bug reports about this, and there are multiple problems also.  

 https://wiki.ubuntu.com/Gutsy_Intel_HD_Audio_Controller   - No sound with Intel HDA Audio
 
There are two possible workarounds for this problem, one is to install the Ubuntu's linux-backports-module but this seems to give low volume and needs some hacks to solve the volume issue that i didn't test, the other one is to install the Conexant HSF Driver and the modified Linux Backport Module kindly provided by Dell.  With this two drivers the volume is perfect (at least for me).

In order to install it go to Dell's wiki  

http://linux.dell.com/wiki/index.php/Ubuntu_7.10/Issues/Built_In_Digital_Mic_Does_Not_Work

And install the l-b-m and hsfmodem deb packages from there.

It seems that this packages solve the external mic not working (i haven't tested it yet). However there's another problem with  no sound after standby mode.  

https://bugs.launchpad.net/ubuntu/+source/linux-source-2.6.22/+bug/78257

I've solved this issue with:

<pre>
sudo echo options snd-hda-intel model=dell-m42 >> /etc/modprobe.d/alsa-base
</pre>

and installing the l-b-m provided by Dell.  However there's another solution (not tested by me) provided by Dell at this wiki

http://linux.dell.com/wiki/index.php/Ubuntu_7.10/Issues/Audio_Failure_On_Resume

=== HARD DISK DRIVE ===

(Dell's ISO & Ubuntu's ISO)

It seems to be some issues with the NCQ (some hard drive sata new technology) implementation in Linux Kernel. The problems seem to be solved for upstream and probably for Hardy but Gutsy would not have (at this time) a solution but a workaround.

Also it seems to no affect all hard drivers.  You'll know that you have this issue if you hear clicks in your hard drive from time to time.  The fix is this:

<pre>
sudo gedit /etc/rc.local

Add just BEFORE the exit 0 line

sh -c "echo 1 > /sys/block/sda/device/queue_depth"
</pre>

Sadly, the infamous hard drive killer (that should be noted is not Ubuntu's fault at all and it's present in Suse, Mandriva, Fedora, Windows -yes windows- and Mac OS X). Please check the bug report #5695 to find out if your system is affected, it seems to be directly related to your Hard Disk Drive Model and FIRMWARE revision (so you can check if your hard drive has a firmware update pending to solve the issue. At this time there's none for Dell Vostro 1500 nor Toshiba HDD)

More information here:

https://wiki.ubuntu.com/DanielHahler/Bug59695

The bug : https://bugs.launchpad.net/ubuntu/+source/acpi-support/+bug/59695

After some testing i've decided to go with the Debian Fix   (https://launchpad.net/ubuntu/+source/acpi-support/+bug/59695/comments/375  and https://launchpad.net/ubuntu/+source/acpi-support/+bug/59695/comments/376 )  that seems to use a lot of ideas from the Ugly fix provided by Ubuntu Demon (http://ubuntuforums.org/showpost.php?p=3675960&postcount=26) , but it seems a bit more official. 

However after some testing i've modified the 128 from line 24 to 192. It seems that this value is directly related to the disk and battery type. And in this Vostro the 192 value was most quieter than 128.

So download the 90-hdparm.sh file  

http://launchpadlibrarian.net/12024037/90-hdparm.sh

<pre>

sudo gedit 90-hdparm.sh

Change the 128 for a 192 in line 24:

23   if [ $AC_POWER -eq 1 ] ; then
24         hdparm -B 192 $dev

sudo install 90-hdparm.sh /etc/acpi/start.d/
sudo install 90-hdparm.sh /etc/acpi/resume.d/
sudo install 90-hdparm.sh /etc/acpi/battery.d/
sudo install 90-hdparm.sh /etc/acpi/ac.d/

reboot

</pre>

=== WIRELESS ===

(Dell's ISO & Ubuntu's ISO)

Wireless has some issues here. Gutsy by default uses the ipw3945 driver.  This driver is actually depreciated by intel and is replaced by the iwl3945 (hardy's default). There're some issues with the ipw3945 driver a driver crash when transfering big files and suddenly disconnections. The solution is to replace (in Gutsy) the ipw3945 for the iwl3945.

However there're still some issues with the iwl3945 driver. 

1. Replace the ipw345 with the iwl3945 driver.

<pre>
sudo echo blacklist ipw3945 >> /etc/modprobe.d/blacklist-ipw3945
sudo echo iwl3945 >> /etc/modules
</pre>

2. Solve the iwl3945 issues

Suspend issue (caused by an incomplete rename of the interface):

<pre>
sudo mv /etc/udev/rules.d/70-persistent-net.rules /etc/udev/rules.d/70-persistent-net.rules.bak
</pre>

Hibernate issue

<pre>
sudo gedit /etc/default/acpi-support

Add iwl3945 to MODULES line.

MODULES="iwl3945"

MODULES_WHITELIST=""

</pre>

After this changes reboot your system.  Take into account that the Wireless connectivity after suspend or hibernate would take a few moments to start over again.

I haven't confirmed yet the throughput issue nor found a workaround for it.

Also another annoyance is that the iwl3945 driver doesn't light up the wifi led with the gutsy version.

=== COMPIZ FUSION ===

The Intel Graphic Card is blacklisted by default by Compiz.  The problem is related to Video Playback and Compiz Fusion on Intel 965GM. If you enable Compiz Fusion you won't get Video Playback.  This problem is related to the inner works of the intel driver as far as i understand, so it won't get solved pretty soon.

http://linux.dell.com/wiki/index.php/Ubuntu_7.10/Issues/Compiz_Fusion_965GM_Incompatibility

However, there's a workaround for this, open up a terminal and execute this command:

<pre>
mkdir -p ~/.config/compiz/ && echo SKIP_CHECKS=yes >> ~/.config/compiz/compiz-manager
</pre>

For the Video Playback the suggestion is to run gstreamer-properties and change the Video output to No XV, this didn't worked for me quite well so whenever i'm gonna play videos i must disable compiz.

=== FIRMWARE UPDATES ===

Dell is developing an update firmware system, here are the instructions to use it with Ubuntu.  This is taken directly from Dell's Linux Wiki

http://linux.dell.com/wiki/index.php/Repository/firmware

<pre>
wget -q -O - http://linux.dell.com/repo/firmware/bootstrap.cgi | bash
aptitude install firmware-addon-dell
aptitude install $(bootstrap_firmware -a)
update_firmware
</pre>

=== SENSORS AND FAN CONTROL ===

I like to monitor my systems for temp, fan, etc. So in order to get this working in the Vostro i had to do this:

1. For Hdd monitoring

<pre>
apt-get install hddtemp
</pre>

I choose to let the daemon running. For checking purposes i ran:

<pre>
hddtemp /dev/sda
/dev/sda: ST9160821AS: 33Â°C
</pre>

2. For CPU Temp monitoring

<pre>
sudo echo coretemp >> /etc/modules
</pre>

3. For CPU, Fan and Temp monitoring

<pre>
sudo echo i8k >> /etc/modules
sudo echo options i8k force=1 >> /etc/modprobe.d/i8k.modprobe
</pre>

The options i8k force=1 is needed because the Vostro is not in the i8k module list for supported systems.

4. For FAN Control

You would need to compile a litle piece of software: dellfand

http://dellfand.dinglisch.net/

<pre>
sudo apt-get install g++
wget http://dellfand.dinglisch.net/dellfand-0.9.tar.bz2
tar xvjf dellfand-0.9.tar.bz2 
cd dellfand-0.9; make 
</pre>

For testing purposes:

<pre>
root@vostro:/tmp/dellfand-0.9# ./dellfand 
v0.9: Fan 0 Status 1 Speed 61980 CPU Temp 31C
</pre>

For installing it and enabling for default

<pre>
sudo  cp etc.default.dellfand /etc/default/dellfand
sudo  cp etc.init.d.dellfand /etc/init.d/dellfand
sudo  update-rc.d dellfand defaults
sudo /etc/init.d/dellfand start
</pre>

With dellfand the fan in your system would cool it when the temp is higher.

5. Visually Addons
 
<pre>
sudo  apt-get install sensors-applet
</pre>

Add it to your panel and adjust it according to your needs.  There are other monitoring software available that probably could take this info and show it graphically, i choose this one, you're free to check others. (gkrellm, gdesklets, superkaramba for kde, and probably others)

=== BLUETOOH ===

I haven't worked a lot with this, but i know about some problems in gutsy, so you must check this links in order to workaround any issue you could find.

What i know at this point is that you must install gnome-vfs-obexftp in order to transfer files.

<pre>
sudo apt-get install gnome-vfs-obexftp
</pre>

Also there's some GUI usability problems with the Bluetooth applet that you must be aware off.

* https://help.ubuntu.com/community/BluetoothSetup
* http://ubuntuforums.org/showthread.php?t=580347&page=3
* http://forum.fedoraforum.org/showthread.php?p=908776

=== Other Stuff ===

About Suspend, Standby and Hibernate issues i must say that up to this point everything works like a charm, a big exception is the audio output problem after standby in fact i didn't noticed it until i made this wiki page.

I hope this helps some people out there, i 'd be adding more relevant info into this wiki for further reference.

Regards

  Andres Mujica

  SEAQ

  http://www.seaq.com.co
----
CategoryLaptop CategoryHardware
