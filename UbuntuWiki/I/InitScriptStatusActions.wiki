{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__


=== Background ===

The LSB suggests that init scripts provide a ''status'' action:
* http://refspecs.freestandards.org/LSB_3.1.0/LSB-Core-generic/LSB-Core-generic/iniscrptact.html

DustinKirkland worked with Debian to <nowiki>[[http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=490095|provide a method]]</nowiki>, <code> status_of_proc() </code>, in /lib/lsb/init-functions, in the <nowiki>[[http://packages.qa.debian.org/l/lsb.html|lsb-base]]</nowiki> library package.  This function is fully integrated in Intrepid as of <nowiki>[[https://launchpad.net/ubuntu/+source/lsb|lsb-3.2-14]]</nowiki>.

=== Adding status actions to init scripts ===

Numerous init scripts should be patched to call <code> status_of_proc() </code> and provide a ''status'' action.  A simple recipe follows for adding such functionality.

==== Patch Checklist ====
When you encounter an init script that <nowiki>[[https://wiki.ubuntu.com/InitScriptStatusActions#head-75448d0a482c28a007476b3be2394d9db3213662|lacks a status action]]</nowiki>:
 1. Determine the source package
** <code> dpkg -S /etc/init.d/FOO </code>
 1. Open a bug in Launchpad against the package
** http://launchpad.net/ubuntu/+source/FOO/+filebug
 1. Grab the source and build dependencies
** <code> apt-get source FOO </code>
** <code> sudo apt-get build-dep FOO </code>
 1. Locate the init script in the source tree, sometimes
** <code> debian/*.init </code>
** <code> debian/rc </code>
 1. Patch the source to
** have the init script call status_of_proc()
** have the init script add "status" to the usage statement
** add a dependency in debian/control for lsb-base >= 3.2-14
** add the changelog entry referencing your Launchpad bug, (LP: #999999)
 1. Assuming that you have the package installed, test your patched init script for the new functionality and regressions.  Check that $? after the status calls are 0 on success, and non-zero on failure.
** <code> sudo sh debian/FOO.init start </code>
** <code>  * Starting FOO      [ OK ] </code>
** <code> sh debian/FOO.init status; echo $? </code>
** <code>  * FOO is running. </code>
** <code> sudo sh debian/FOO.init stop </code>
** <code>  * Stopping FOO      [ OK ] </code>
** <code> sh debian/FOO.init status; echo $? </code>
** <code>  * FOO is not running. </code>
** <code> sudo sh debian/FOO.init start </code>
** <code>  * Starting FOO      [ OK ] </code>
 1. Build a source package
** <code> debuild -S </code>
 1. Generate a patch
** <code> debdiff </code>
 1. Compare your work to some of the other patches
** <nowiki>[[http://launchpadlibrarian.net/15924139/at.status.debdiff|atd]]</nowiki>
** <nowiki>[[http://launchpadlibrarian.net/15936081/openssh.status.debdiff|openssh-server]]</nowiki>
# Add your patch to the Launchpad bug you filed, mark as ''Confirmed''
# Subscribe ''kirkland'', and (''ubuntu-main-sponsors'' or ''ubuntu-universe-sponsors'') as appropriate
# For bonus points, file a bug in Debian, and work the patch back upstream
** Use <nowiki>[[Debian-Usertagging]]</nowiki>
** <code>User: ubuntu-devel@lists.ubuntu.com</code>
** <code>Usertags: origin-ubuntu ubuntu-patch intrepid</code>

=== Init Scripts that Need a Status Action ===
The following is a crude list of init scripts in Intrepid that are lacking a "status" action.  I say "crude" in that this list was generated on 2008-07-21 by installing the Intrepid Ubuntu (server, ubuntu-desktop, kubuntu-desktop, xubuntu-desktop), and grepping through /etc/init.d for scripts that lacked the string "status)".  Please help improve this list by adding/removing init scripts to/from this list, and linking to a bug number.  Please leave an informative note in this wiki page's changelog.

You can run <code> dpkg -S /etc/init.d/... </code> to determine the source package of any of the following scripts.

==== Init scripts with daemon(s) ====

====== /etc/init.d/... ======

# acpid: Bug:251681 (FIXED)
# at: Bug:247091 (FIXED)
# bind9: Bug:247084 (Patch submitted, awaiting main sponsorship)
# bip: Bug:251287 (FIXED), <nowiki>[[http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=492126|Debian #492126]]</nowiki>
# bluetooth: Bug:251684 (FIXED)
# bootlogd: Bug:259435 (Patch submitted, awaiting main sponsorship)
# brltty: Bug:251626 (FIXED)
# cron: Bug:201504 (FIXED)
# dbus Bug:252214 (FIXED), <nowiki>[[http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=492541|Debian #492541]]</nowiki>
# dhcdbd: Bug:251624 (FIXED)
# dovecot: Bug:247096 (FIXED)
# gdm: Bug:251375 (FIXED)
# hal: Bug:252350 (FIXED), <nowiki>[[http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=492625|Debian #492625]]</nowiki>
# kdm: Bug:259446 (Patch submitted, awaiting main sponsorship)
# lighttpd: Bug:251924 (FIXED)
# mysql
# mysql-ndb
# mysql-ndb-mgm
# mythtv-backend Bug:251325 (FIXED)
# nginx: Bug:251985 (FIXED)
# nis
# openvpn
# openssh: Bug:247103 (FIXED)
# portmap: Bug:254499 (Patch submitted, awaiting main sponsorship)
# powernowd
# pulseaudio (Be careful with this one:  the default for desktop installs is via session, not via this initscript.)
# rsync: Bug:251320 (FIXED), <nowiki>[[http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=492138|Debian #492138]]</nowiki>
# samba: Bug:247087 (Patch submitted, awaiting main sponsorship)
# squid: Bug:251299 (FIXED), <nowiki>[[http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=492131|Debian #492131]]</nowiki>
# sysklogd: Bug:247106 (FIXED)
# system-tools-backends: Bug:300743 (Patch submitted)
# usplash
# winbind: Bug:247087 (FIXED)
# xinetd: Bug:251975 (FIXED)
 
==== Init scripts without daemon(s) ====

===== No daemon, but detectable status =====
The following init scripts do not have an associated daemon, however, they do perform actions on the system which could be algorithmically checked.  I'm noting some suggested items that could be checked in a 'status' action.

====== /etc/init.d/... ======

# apport - status should look at /proc/sys/kernel/core_pattern
# binfmt-support - status should check update-binfmts --display, perhaps
# checkfs.sh - status could show the time/date/results of the last check
# checkroot.sh - similar to checkfs.sh, perhaps?
# mountoverflowtmp - status could check the tmp mountpoint
# mythtv-status: Bug:251330 (Patch awaiting sponsorship), checks if mythtv-status has run successfully
# networking - status could check network connectivity
# pcmciautils - status could check lsmod for needed modules
# policykit - status could check directory existence and permissions
# rmnologin - status could check /var/lib/initscripts/nologin
# screen-cleanup - status could check /var/run/screen
# single - status could check if in single user mode or not
# skeleton - the skeleton init script itself should be enhanced to have a status action!
# urandom - status could check /dev/urandom
# firehol - status could check if current iptables match those firehol generates from its configuration ("firehol debug") else dispay the diff. Bug:185978

===== No daemon =====
The following init scripts do not have an associated deamon.  On initial review of the code, a 'status' action for these scripts does not necessarily make sense.  If you have an idea of a sensible status action, please note the suggestion and move the item to the list above (detectable status).

====== /etc/init.d/... ======

# acpi-support
# alsa-utils
# bootmisc.sh
# console-screen.sh
# console-setup
# dns-clean
# glibc.sh
# halt
# hostname.sh
# hotkey-setup
# hwclockfirst.sh
# hwclock.sh
# keyboard-setup
# killprocs
# loopback
# module-init-tools
# mountall-bootclean.sh
# mountall.sh
# mountdevsubfs.sh
# mountkernfs.sh
# mountnfs-bootclean.sh
# mountnfs.sh
# powernowd.early
# pppd-dns
# procps
# rc
# rc.local
# rcS
# readahead
# readahead-desktop
# reboot
# resolvconf
# sendsigs
# stop-bootlogd
# stop-bootlogd-single
# stop-readahead
# umountfs
# umountnfs.sh
# umountroot
# vbesave
# wpa-ifupdown
# xserver-xorg-input-wacom

=== References ===
# http://lists.debian.org/debian-devel/2008/07/msg01031.html
# http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=490095
# http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=483285
# http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=291148
# http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=208010
# http://packages.qa.debian.org/l/lsb.html
# https://wiki.ubuntu.com/OnnoBenschop/ubuntu-server/init.d-status
