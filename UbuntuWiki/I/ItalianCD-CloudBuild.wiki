{|
  | '''Warning'''
  * This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
  * '''Images''' and '''attachments''' have been removed to conserve space.
  * '''Links''' may not work and there may be formatting issues.
  * A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__



== Introduction ==
This page explains how to create an Ubuntu Localized ISO using the Amazon Cloud. Since Amazon provides free resources for new subscribers, and cheap prices for on demand instances, it can be a good solution for LoCo Teams. If you know another good cloud solution for building Ubuntu CD, just let PaoloSammicheli know, we'll create a script also for it :)

== Cloud resources ==
We used the cloud instances <nowiki>[[http://aws.amazon.com/ec2/|EC2]]</nowiki> for the building, and a <nowiki>[[http://aws.amazon.com/s3/|S3]]</nowiki> bucket for the final image hosting. The <nowiki>[[http://aws.amazon.com/free/|Free usage tier]]</nowiki> include both these services.
* WARNING: Intense I/O activity may go over the free tier. In my experience it will not cost more than few dollars per month. Anyway if you are concerned about fees check the Amazon documentation for estimate charge and enable an alarm threshold.
== The Script ==
The script is designed to be deployed in a newly created cloud image (based on Ubuntu 12.04, both i386 or amd64). It creates the directory structure keeping separate the building directory from the final directory. In this way, building always from the same dir it will save time reusing the already downloaded ubuntu packages. At the end of the process it creates a zsync file and a md5 checksum and it uploads it in the s3 bucket.
Since it uses the directory format YYYYMMDD, it is easily linkable from the <nowiki>[[http://localized-iso.qa.ubuntu.com/|Localized Iso Tracker]]</nowiki> for crowdsourcing the tests.

=== Source Code ===
* Source code available with <nowiki>[[http://bazaar.launchpad.net/~ubuntu-defaults-it-team/ubuntu-defaults-it/additional-tools/view/head:/LoCo-CD-build|Bazaar]]</nowiki>
=== Instructions ===
* Create a <nowiki>[[http://aws.amazon.com/s3/|S3]]</nowiki> Bucket
* Create a <nowiki>[[http://aws.amazon.com/ec2/|EC2]]</nowiki> cloud instance with Ubuntu 12.04 i386 or amd64
* Log in the image, create a /bin directory in /home/ubuntu directory
** [optional] run <nowiki>[[https://launchpad.net/byobu/|byobu]]</nowiki> and make it default every login
* Copy the <nowiki>[[http://bazaar.launchpad.net/~ubuntu-defaults-it-team/ubuntu-defaults-it/additional-tools/view/head:/LoCo-CD-build|script]]</nowiki> inside /home/ubuntu/bin
* Creating a <nowiki>[[http://s3tools.org/s3cmd|.s3cfg]]</nowiki> file in /home/ubuntu with the credentials for your bucket
* Configure the <nowiki>[[http://bazaar.launchpad.net/~ubuntu-defaults-it-team/ubuntu-defaults-it/additional-tools/view/head:/LoCo-CD-build|script]]</nowiki> with desired release, architecture, language and S3 infos.
* Run it: 
<pre>
$ LoCo-CD-build YYYYMMDD
</pre>
** if you run it without parameters it will get the current day. Ex: 20120730
* At the end it will upload the iso, md5 and zsync files in a /YYYYMMDD directory in the specified bucket
** Now you can shutdown your cloud instance ;)

=== Features ===
* Install requested packages
* Create ISO, md5 and zsync files and upload it in a S3 bucket
* Workaround for <nowiki>[[http://pad.lv/998351|bug #998351]]</nowiki>
* Workaround for <nowiki>[[http://pad.lv/1029279|bug #1029279]]</nowiki>
