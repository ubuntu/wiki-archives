{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

This is a compilation of some best practices for installing (K)Ubuntu Feisty on a MacBookPro. See also http://wiki.debian.org/MacBookPro and (older) pages MacBookPro and  IntelMacSupport on this wiki. 

=== Prepare MacBook for dual boot ===

Start your MacOS and 
* Download and install Boot Camp 
* Reduce the MacOS partition size to e.g. 30G with 
<pre>
sudo diskutil resizeVolume disk0s2 30G 
</pre>
* Download and install rEFIt 
Enable rEFIt to run on every boot with 
<pre>
cd /efi/refit && ./enable-always.sh 
</pre>
If at a later stage of your installation rEFIt starts up slowly or behaves strange after e.g. updating OS X, you may retype the last line in an OS X terminal.
It has ben reported, that only MacBookPro Duo 2 sometimes completely locks the keyboard when starting up Linux. Just reboot again.
If you want to make Ubuntu the default boot option in rEFIt you should edit /efi/refit/refit.conf and change #legacyfirst to legacyfirst.

=== Downloading the ISO ===

You would want to go to this page: http://www.ubuntu.com/getubuntu/download and download the alternate desktop CD (tick box at the bottom of the screen).

If you have a Core2Duo, you may choose "64bit AMD and Intel computers" for the type of computer for improved performance in some applications. Please note this will mean incompatibility with some applications and many 32bit codecs (e.g. WMV) and any performance improvements are minimal at best. Most people still choose to go with the i386 ISO. However, all the core functions, including wireless, are also available with the 64bit AMD version.

If you have the older CoreDuo Macbooks, you have to leave the selected: "Standard personal computer".

=== Install from the Feisty Alternate Release ===

You need to do a text based install from the (K)Ubuntu Alternate ISO and use manual partitioning, delete the Windows partition completely, and assign a 2GB swap partition and a ext3 partition (no boot flag required) with the rest of the freed memory on your harddisk.

=== Fixing xorg drivers ===

When you reboot the (K)Ubuntu next time from your HD, it is likely that after a startup screen you end up with just a blinking character on the top left.
You need to access a shell and do some fixes manually.
Reboot again, and try to interrupt GRUB by pressing ESC and launch the recovery mode. If your keyboard is locked either, it will be tricky to reach a shell. 
Here is one way: You boot again with the live CD, enter the repair mode, mount your ubuntu partition, and edit the GRUB menu file, so that next time when you boot from your HD, the system starts in recovery mode.
<pre>
sudo mount /dev/sda4 /mnt
cd /mnt
sudo nano /boot/grub/menu.lst
--> change default from 0 to 1
</pre>
Don't forget to change that number later again to 0, so that your system boots automagically in graphics mode, when you are done with all installations.

Ok, we assume you have a shell now, so grab the ATI drivers for Ubuntu:

<pre>
dpkg-reconfigure xserver-xorg -phigh
</pre>

just choose the standard answers until you get back to the shell again and type

<pre>
startx
</pre>

if that doesn't work try

<pre>
sudo apt-get install xorg-driver-fglrx
sudo aticonfig --initial
sudo aticonfig --overlay-type=Xv
sudo /etc/init.d/gdm restart
</pre>

The right resolution for the MacBook Pro is 1440 * 900.

-- ruebezahl -- 
re-arranged by --rasos with descriptions from revis.org

=== Enabling F-key combos: dim screen, keyboard light, sound ===

<pre>
sudo apt-get install pommed
</pre>

If you want to use the hardware function keys only with the fn key (leaving the F keys e.g. for changing screens), edit the following lines in /etc/pommed.conf

<pre>
general {
##### fnmode: functions keys first (no need to use fn) or last
##### Value is either 1 or 2, effect is hardware-dependent

        fnmode = 2
}
</pre>

fnmode should be 2 if you want standard keyboard behavior. You'll then need to restart pommed:

<pre>
sudo /etc/init.d/pommed restart
</pre>

You can still access the hardware functions by holding down Fn key when you press the F key. For example, to mute hit Fn-F3.

=== Wireless ===
The '''Core Duo''' model Works out of box, but the '''Core 2 Duo''' does not. Here you need to add a module to the kernel (instructions taken from http://www.revis.co.uk/site/?q=node/147 )
Be sure, you have development tools installed, as you need to compile it from madwifi. 
Preparing environment (you may need sudo before each command):
<pre>
aptitude update
aptitude install build-essential
aptitude install module-assistant
m-a prepare
</pre>
Fetch and complie the madwifi source:
<pre>
svn checkout http://svn.madwifi.org/madwifi/trunk madwifi
cd madwifi
make clean
make
sudo make install
sudo modprobe ath_pci
</pre>

=== Access HFS+ formatted HD with your MacOS data ===

We assume you have your OS X data backed up on an external HD. Let's first prepare the access rights (this is one way, to do so). 
In OS X mode, open a terminal, find out the name of the drive under /Volumes and switch off journalling:
<pre>
cd /Volumes
ls
diskutil disablejournal mybackupdisk
</pre>
Then find out, which uid you have, mine is 502.
<pre>
id
</pre> 
Then start your Feisty, add a user with the same uid, and add it to the group of yourself.
Connect the HD e.g. with firewire. Find out the name of your device in the /dev directory, for the external HD we assume sdb3. The internal HD OS X partition would usually be sda2. 
<pre>
sudo mount -t hfsplus /dev/sdb3 /mnt
cd /mnt
ls -l
</pre>
You should be able to read and also write (if you have disabled journaling before) now. Kubuntu also has a Dialog for adding disks in the System Preferences / Advanced section.

=== Touchpad ===

Emulate the right mouse click with three fingers on the touchpad. Get the feeling for two fingers scrolling!
Have the following lines into your /etc/X11/xorg.conf file in the synaptics section:
<pre>
Section "InputDevice"
	Identifier  "Synaptics Touchpad"
	Driver      "synaptics"
	Option "SendCoreEvents" "true"
	Option "Device" "/dev/psaux"
	Option "Protocol" "auto-dev"
	Option "MaxTapTime" "150"
	Option "MaxTapMove" "220"
	Option "MaxDoubleTapTime" "180"
	Option "LockedDrags" "on"
	Option "VertTwoFingerScroll" "1"
	Option "TapButton1" "1"
	Option "TapButton2" "2"
	Option "TapButton3" "3"
	Option "Emulate3Buttons" "true"
EndSection
</pre>

Find out more about all touchpad options with 
<pre>
man synaptics
</pre>
The circular scrolling (like on the iPod) works, but somehow locked the mousepad for a second or two. I switched it off again (--rasos).

There is also the option of adding the mac style two button + click = right click on feisty by using this patch [ http://douglas.mayle.org/synaptics-two-finger-click.diff] which will allow you to add the following option to xorg.conf

<pre>
....
Option "TwoFingerButton1" "2"
....
</pre>

Also if you have problems compiling the synaptics driver from source, take a look at this bug report  [ https://bugs.launchpad.net/ubuntu/+source/xserver-xorg-input-synaptics/+bug/54290]

--Fotis7--
=== Other Issues ===

'''Some of the following issues seem to apply only for the Feisty Beta and are fixed in the final release'''

=== Network ===

On ubuntu, some users experience a bug where the network wire needs to be plugged in at boot in order for the network interface to work automatically. It you experience that bug, simply run ifconfig eth0 up followed by dhclient eth0 (if using dhcp).

This bug appears to have been fixed in the final version and doesn't affect kubuntu users.

=== Heat/Whine ===

My Macbook Pro C2D gets very hot with ubuntu and my fans keep spinning almost everytime.
Whine is present sometimes. (But not in OS X)
Since Apple says that the heat/whine issues have been fixed with the release of the C2D Models there must be a software issue somewhere.
I am going to recompile my kernel with the patches from the mactel-linux guys and post my results here...

--- ruebezahl ---

Jason Paraekh [website http://www.jasonparekh.com/2006/macbook-fan-control-in-linux/] has some info on cooling Macbook/Macbook Pro. The mactel patches are included in the kernel built for Feisty beta and on.

-- MikeBasinger --

To get rid of the whine (high pitch sound) then, use run this command as root :

<code>echo 2 > /sys/module/processor/parameters/max_cstate</code>

To do this at each reboot, add the line to /etc/rc.local 

=== Suspend/Hibernate ===

Hibernate works in 7.04 beta, but suspend does not. However, it does in Kubuntu Feisty.

I got sleep working by modifying options in /etc/default/acpi-support. Set:
POST_VIDEO=false

As described here: https://bugs.launchpad.net/ubuntu/+source/linux-restricted-modules-2.6.20/+bug/84991

=== Touchpad ===

==== Two finger scrolling ====

Requires editing the Xorg.conf file as shown in <nowiki>[[MacBook]]</nowiki>.

==== Oversensitive touchpad ====

To prevent from accidentally tapping the touchpad when typing, type the following:

<pre>
syndaemon -t -d
</pre>

This will prevent inadvertent clicking while you're entering text. You can add this command permanently by going to System>Preferences>Sessions and adding it to Startup Programs.

--- Imrazor2 ---

==== Touchpad/mouse lag when using keyboard ====

You may notice that the mouse or touchpad becomes unresponsive when holding down a key (especially annoying in games.) This is due to a program called mouseemu. To fix temporarily, run the following command:

<pre>
sudo killall mouseemu
</pre>

If that works and doesn't cause any other problems or disable any other features, you may want to disable it permanently. To remove mouseemu, run the following:

<pre>
sudo apt-get remove mouseemu
</pre>

--- Imrazor2 ---

=== Right click without external mouse ===

In 7.04-Beta, simply press F12.  It appears that Option-F12 is a middle-click.  If you need something more, several hacks can be found on the <nowiki>[[MacBook]]</nowiki> page.

Note: On my 2GHz Macbook Pro, the touchpad is automatically configured so that a one-finger tap is a left click, two-finger tap is a middle-click, and three-finger tap is a right click. Try it!ad

=== Sound ===
==== Speakers ====

Previous instructions are completely outdated by the 7.04-Beta.  Sound output worked out of the box on my MBP without modifying the speaker settings.  I believe that "side" was removed, now "master" appears in the settings by default. - Jonatin

==== Internal Microphone ====
Does not work. Any ideas?

==== Quality/Distortion Issue ====

'''NOTE:''' This issue may be at least partially resolved with 7.04-Beta, I have had no problems with distorted sound at all in games, Rythmbox, or Amarok since I clean-installed the Beta. - Jonatin

Hackeron: for me, sound quality is poor under Linux - it sounds as if the volume is always set to 100% and reduced by software -- there is distortion in speech and higher frequencies that is very audible with external speakers or quality headphones - if anyone knows a way to fix this, please add it here.

To get past the quality/distortion issue do the following:
<pre>
sudo rmmod snd_hda_intel
sudo modprobe snd_hda_intel
</pre>
(You remove the hda_intel extension from the kernel and then add it again)
I added this to my /etc/rc.local.
Sound works perfectly now!

(Make sure snd_hda_intel isn't in use though, in my case I had to kill pommed before removing the module. Otherwise it won't work)

--- ruebezahl ---

=== Keyboard ===
==== How to @ ====
System > Preferences > Keyboard > Layout Options
Go to "Third level choosers". Here you might activate "Press any of Alt keys to choose 3rd level" or another option as you like.

=== How to # on UK keyboard ===

Only way I got this to work is to switch to the US layout which means ~ is where ± is supposed to be and the sterling key is not usable any longer.

=== Apple remote control ===
Install pommed
<pre>
sudo apt-get install pommed
</pre>
Then edit /etc/pommed.conf
<pre>
sudo gedit /etc/pommed.conf
</pre>
Scroll down to "# Apple Remote" and set enabled to ''yes'', if it is not already enabled (''enabled = yes'').

To test it, start a song on your Rhytmbox and hit the next,previous,up,down or the play-button (wich stops the track) on the remote control.
The button-events of the remote control are handled like normal keystrokes. You can change the event handlers at ''settings > keyboard-shortcuts''. Look at the ''audio'' setttings there. 

=== Built in isight camera (webcam) ===
The isight does not work since Kernel update in Beta 5. Until iSight support is back (maybe it will be), there is a solution described on the Bugreport: https://bugs.launchpad.net/ubuntu/+source/linux-source-2.6.20/+bug/105638/

=== Video related ===
==== With OpenSource drivers ====
Very, very poor performance, you'll really need to use closed source drivers.

==== With ATI drivers / fglrx (closed source) ====
Some gstreamer based players can't be used, some colours get inverted because of a bug in the closed source drivers.

=== Increasing battery life ===
==== Disable Bluetooth ====
(will this save battery power?  (probably not - i can get about 2 weeks sleep in OS X with wake from bluetooth enabled))
Deactivate "Bluetooth" at ''System > Administration > Services''

==== Powertop ====
Use a tickless kernel (2.6.21 and above) and try intel's powertop http://www.linuxpowertop.org/

Running powertop and following its recommendations does help, but power consumption is still much more aggressive than in OSX

==== Lower Graphics Clock - ATI Powerplay ====

The first (CoreDuo) and second (Core2Duo, none Santa-Rosa) generation of the Macbook Pro are driven by an ati x1600 graphics card.
You can set these cards in different performance modes to reduce the power usage if not needed and gain battery life. This is done by the "aticonfig" tool shipped with the fglrx driver.

On the first generation this works flawlessly:

<pre>
core/mem      [flags]
-----------------
1: 128/135 MHz  [low voltage]
* 2: 311/297 MHz  [performance mode, default state]
3: 311/297 MHz
</pre>

Somehow this does not work with the second generation and will fail:
<pre>
Error: POWERplay is not supported on your hardware.
</pre>

A useful workaround for this bug can be found here: http://ati.cchtml.com/show_bug.cgi?id=608#c9
Simply download the source for the patched radeontool (30kb), do a “make” and run
<pre>
./radeontool power low
</pre>
This will reduce your power consumption by ~7-8 W and finally allows battery capacity around 2,5hr, instead of just 1,5hr. And keep in mind, it's more silent because of less heat.

----
CategoryHardware
