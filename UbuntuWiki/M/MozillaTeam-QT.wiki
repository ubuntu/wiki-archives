{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__


== Ideas for the gtk vs qt Mozilla builds ==

=== Introduction ===

In the Shiretoko/3.1/1.9.1 branch, Qt is now an alternative to Gtk2. In Ubuntu, this is interesting for KDE users.
To avoid the proliferation of unsupported packages, the Ubuntu Mozillateam should support this.

From upstream's point of view, this is as simple as using --enable-default-toolkit=cairo-qt (we have cairo-gtk2 by default).

 <pre>
--enable-default-toolkit=cairo-qt
 </pre>

==== xulunner-1.9.1 ====

(Results based on my experiments within a xulrunner-1.9.1-qt.head branch)

* debian/control

 <pre>
Build-Depends: ..., libqt4-dev
 </pre>

* cairo:

system cairo (at least up to 1.8.0) could not be used as mozilla needs '''cairo-qpainter''' which is for now only in the mozilla branch.
This is unfortunate because of the lcd-filter debacle so if we do this, we should consider porting the lcd filter patch to xul.

 <pre>
--disable-system-cairo
 </pre>

* gnome:

we should at least drop gnomevfs and gnomeui from the configure switches, and drop gnomevfs from the extensions list (configure is already doing that at build time).

 <pre>
--disable-gnomevfs --disable-gnomeui --enable-extensions=default,...,-gnomevfs
 </pre>

* build:

a build with the switches mentioned above goes smoothly up to the install step. From debian/xulrunner-1.9.1.install, those files are no longer built:

 <pre>
debian/tmp/usr/lib/xulrunner-1.9.1*/components/libimgicon.so
debian/tmp/usr/lib/xulrunner-1.9.1*/components/libdbusservice.so
 </pre>

Note: dbus is available on kde but the configure test wants dbus + glib, and glib is ignored for non gtk2 builds.
EDIT: https://bugzilla.mozilla.org/show_bug.cgi?id=454841

of course, the files in the gnome-support package are missing:

 <pre>
debian/tmp/usr/lib/xulrunner-1.9.1*/components/libmozgnome.so
debian/tmp/usr/lib/xulrunner-1.9.1*/components/libnkgnomevfs.so
 </pre>

The following files are also missing but do not require debian/xulrunner-1.9.1.install to be updated:

 <pre>
debian/tmp/usr/lib/xulrunner-1.9.1*/icons/*
debian/tmp/usr/lib/xulrunner-1.9.1*/chrome/icons/*
debian/tmp/usr/lib/xulrunner-1.9.1*/components/filepicker.xpt
debian/tmp/usr/lib/xulrunner-1.9.1*/components/nsFilePicker.js
 </pre>

The following files are new:
 <pre>
debian/tmp/usr/lib/xulrunner-1.9.1*/components/gtkqticonsconverter.js
debian/tmp/usr/lib/xulrunner-1.9.1*/components/gtkqticonsconverter.xpt
 </pre>

* linker

From all the files in the new tree, only those two are linked against qt libs

 <pre>
debian/tmp/usr/lib/xulrunner-1.9.1*/libxul.so
debian/tmp/usr/lib/xulrunner-1.9.1*/xulrunner-bin
 </pre>

==== Packaging changes - proposal ====

* Build the package twice with an OBJDIR and two different configure preferences.
* Introduce xulrunner-1.9.1-gtk and xulrunner-1.9.1-qt with

 <pre>
Package: xulrunner-1.9.1
Depends: xulrunner-1.9.1-gtk (= ${binary:Version}) | xulrunner-1.9.1-qt (= ${binary:Version}),
         ${shlibs:Depends}, ${misc:Depends}

Package: xulrunner-1.9.1-gtk
Conflicts: xulrunner-1.9.1-qt

Package: xulrunner-1.9.1-qt
Conflicts: xulrunner-1.9.1-gtk
 </pre>

and in xulrunner-1.9.1-gtk (from the 1st build):
 <pre>
usr/lib/xulrunner-1.9.1*/libxul.so
usr/lib/xulrunner-1.9.1*/xulrunner-bin
usr/lib/xulrunner-1.9.1*/components/libimgicon.so
usr/lib/xulrunner-1.9.1*/components/libdbusservice.so
usr/lib/xulrunner-1.9.1*/icons/*
usr/lib/xulrunner-1.9.1*/chrome/icons/*
usr/lib/xulrunner-1.9.1*/components/filepicker.xpt
usr/lib/xulrunner-1.9.1*/components/nsFilePicker.js
 </pre>

and in xulrunner-1.9.1-qt (from the 2nd build):
 <pre>
usr/lib/xulrunner-1.9.1*/libxul.so
usr/lib/xulrunner-1.9.1*/xulrunner-bin
usr/lib/xulrunner-1.9.1*/components/gtkqticonsconverter.js
usr/lib/xulrunner-1.9.1*/components/gtkqticonsconverter.xpt
 </pre>

or, we could assume that gtk users are also gnome users and reuse xulrunner-1.9.1-gnome-support.

==== firefox-3.1 ====

it seems we need 2 source packages as we want different build-deps. This is unfortunate. Ideas??

Problem, we probably don't want another transition for addons and plugins: '''firefox | firefox-3.1 | abrowser-3.1 | firefox-3.1-qt'''
