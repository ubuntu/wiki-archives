{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__


This page documents the idea of moving to tarball releases at moblin.org.

 Current issues:

* out of date tarballs
* broken tarballs
* missing tarballs

=== example update of hildon-theme-mobile-basic, moving to tarball release ===

* Check versions in target archive(s) versus upstream
   - upstream tarball release is 0.33
   - ubuntu-mobile ppa (https://launchpad.net/~ubuntu-mobile/+archive) has a
     package versionned at 0.32
   - Ubuntu hardy has a package versionned at 0.27 ("rmadison
     hildon-theme-mobile-basic"; rmadison is in the devscripts package)

* Download
<pre>
   mkdir htmb
   cd htmb
## hardy
   mkdir hardy && cd hardy && dget -x http://archive.ubuntu.com/ubuntu/pool/universe/h/hildon-theme-mobile-basic/hildon-theme-mobile-basic_0.27.dsc
## ppa
   mkdir ppa && cd ppa && dget -x http://ppa.launchpad.net/ubuntu-mobile/ubuntu/pool/main/h/hildon-theme-mobile-basic/hildon-theme-mobile-basic_0.32.dsc
## upstream release
   mkdir release && cd release && wget http://moblin.org/repos/releases/hildon-theme-mobile-basic-0.33.tar.gz && tar xvzf hildon-theme-mobile-basic-0.33.tar.gz
## upstream git (only useful to check older versions); use rsync:// if you
## don't have a moblin.org account
   mkdir git && cd git && git clone moblin.org:/home/repos/projects/hildon-theme-mobile-basic.git/
</pre>

* Compare hardy version with the release it claims to base on
   - Locate the 0.27 code; there were no tarball back when 0.27 was committed;
     there's no 0.27 tag in the upstream git repo ("git tag"); "git log" / gitk
     help pinpoint that the commit for the 0.27 release was
     5235a36a0bd97bfc83b87dec55493204ecf31306
   - Get that code; e.g. cd git/hildon-theme-mobile-basic && git checkout
     5235a36a0bd97bfc83b87dec55493204ecf31306
   - Compare the trees; .git differences are uninteresting; filterdiff is in
     patchutils; you can also use "lsdiff" or "diffstat" to get an overview of
     the changes without reading the diff
<pre>
   diff git/hildon-theme-mobile-basic hardy/hildon-theme-mobile-basic-0.27 | filterdiff -x '*/.git/*' | sensible-editor -
</pre>
   - Conclusion: only debian/changelog differs, there was no modification to
     the upstream source (which included packaging back then) in 0.27; nothing
     was added to hardy which wasn't upstream already, so there will be nothing
     to merge from hardy between uploads

* Compare ppa version with the release it claims to base on
   - See above with 0.32 instead of 0.27
   - There are /two/ tags for 0.32, hardy-v0.32 and gaston-v0.32; "git diff
     hardy-v0.32 gaston-v0.32" shows that only target dist changes
   - Get that code; e.g. "git checkout hardy-v0.32"
   - Compare the trees
   - Conclusion: the ppa source package and the upstream release are identical;
     nothing was added to the ppa which wasn't upstream already, so there will
     be nothing to merge from the ppa between upload

* Prepare new upstream release from the latest UME tree (ppa obviously) for
   hardy
   - Compare latest tree (ppa tree) with upstream release tree
<pre>
   diff ppa/hildon-theme-mobile-basic-0.32 release/hildon-theme-mobile-basic-0.33 | lsdiff
</pre>
   - Review shows that debian/ and .git/ aren't in the tarball anymore -- as
     expected -- other "upstream" changes are visible in the ChangeLog/diff
   - Create the new package from the upstream tarball and the packaging from
     the latest UME packaging; the tarball is needed for non-native packages
<pre>
   cp -a release/hildon-theme-mobile-basic-0.33 hardy
   cp -a ppa/hildon-theme-mobile-basic-0.32/debian hardy/hildon-theme-mobile-basic-0.33
   cp release/hildon-theme-mobile-basic-0.33.tar.gz hardy/hildon-theme-mobile-basic_0.33.orig.tar.gz
</pre>
   - Create a new changelog entry for the new upstream release; you can use
     "dch" to do this; the version should now be 0.33-0ubuntu1 (non-native) for
     hardy e.g.:
<pre>
hildon-theme-mobile-basic (0.33-0ubuntu1) hardy; urgency=low

** New upstream release; switch to non-native.

 -- Loic Minier <lool@dooz.org>  Wed, 02 Apr 2008 16:30:46 +0200
</pre>
   - Build (if you have one pbuilder setup, build in pbuilder!), install, and
     test the package
   - If you can, upload to hardy, otherwise, file a bug with the debdiff
     between the version in hardy and the new version or simply the .dsc and
     the .diff.gz and a link to the upstream tarball; you can create the
     debdiff with:
<pre>
debdiff hardy/hildon-theme-mobile-basic_0.27.dsc hardy/hildon-theme-mobile-basic_0.33-0ubuntu1.dsc > hardy/hildon-theme-mobile-basic_0.33-0ubuntu1.debdiff
</pre>

* Pending upload to hardy, or if you want people pulling from snapshot + ppa
   to get the update, prepare an upload to the ppa
   - Prepare a working tree for the next ppa upload from the new .dsc for hardy
<pre>
   cd ppa && dpkg-source -x ../hardy/hildon-theme-mobile-basic_0.33-0ubuntu1.dsc
</pre>
   - Add a changelog entry for the verbatim backport; again you can use dch
     here and should use hardy version + ~804um1 and target at hardy; e.g.:
<pre>
hildon-theme-mobile-basic (0.33-0ubuntu1~804um1) hardy; urgency=low

** Backport to ubuntu-mobile ppa.

 -- Loic Minier <lool@dooz.org>  Wed, 02 Apr 2008 16:47:05 +0200
</pre>
   - Build, install, test, upload
