{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__

=== Using bzr to Manage Extension Packages ===

==== New Upstream Version of Existing Extension ====
When a particular extension project releases a new version, we need to release a corresponding package in ubuntu.  This is called a new upstream release.  Among other things, we will need to update the source, change the package version numbers and perform changelog maintenance.  This is a step-by-step guide to updating a package for a new upstream release.

'''NOTE:'''  I will be using the firebug extension as an example of how to update a package's new upstream source.
 1. Make sure you have the latest XPI.TEMPLATE <pre>
bzr branch http://bazaar.launchpad.net/~mozillateam/firefox-extensions/XPI.TEMPLATE
</pre>
 1. Create a local branch of the current ubuntu package.  We will treat this as the upstream from here on out, so lets call it that to avoid confusion. <pre>
bzr branch http://bazaar.launchpad.net/~ubuntu-dev/firefox-extensions/firebug.ubuntu firebug.upstream
</pre>
 1. Download a new version of the upstream project.  This can be accomplished in a number of ways - in the case of firebug, they use svn via google code. <pre>
svn co http://fbug.googlecode.com/svn/branches/firebug1.2
</pre>
# cd .ubuntu branch
# bzr merge /path/to/upstream/branch
# dch -vNEWUPSTREAMVERSION-0ubunu1 -DUNRELEASED
# edit changelog
# bzr commit -m "* merge NEWUPSTREAMVERSION from .upstream branch"
# testbuild, fix package; rinse, repeat
# dch -r
# bzr commit -m "* RELEASE NEWUPSTREAMVERSION-0ubuntu1 to ubuntu/intrepid" 

==== Work in progress beyond this line ====

using one branch for both .upstream and .ubuntu

Find upstream revision number in branch log
<pre>
bzr log lp:nspluginwrapper
</pre>
Branch upstream branch using that revision number
<pre>
bzr branch lp:nspluginwrapper -r UPSTREAM-REVISION upstream
</pre>
Branch ubuntu branch
<pre>
bzr branch lp:nspluginwrapper ubuntu.VERSION-XubuntuY
</pre>
Copy over new source to the upstream branch
<pre>
cd upstream
cp -r ../new-source .
bzr commit -m "New upstream version a.b.c"
</pre>
Merge updated local upstream branch with the ubuntu branch
<pre>
cd ../ubuntu.VERSION-XubuntuY
bzr merge ../upstream
</pre>
Configure .bzr-builddeb/default.conf to specify upstream branch revision ID
<pre>
editor .bzr-builddeb/default.conf
</pre>
Check REVISION-ID of your upstream commit in 'bzr log --show-ids'.
.bzr-builddeb/default.conf:
<pre>
[BUILDDEB]
merge = True
export-upstream = .
export-upstream-revision = revid:REVISION-ID
</pre>
Commit changes produced by merge and configuration of .bzr-builddeb/default.conf
<pre>
bzr commit -m "Merge with upstream revision UPSTREAM-REVISION+1
</pre>
Apply the rest of your packaging changes
<pre>
dch -vNEWUPSTREAMVERSION-0ubuntu1 -DUNRELEASED
change-1
change-2
...
bzr commit -m "changes..."
</pre>
Release it...
<pre>
dch -r
bzr commit -m "RELEASE VERSION-XubuntuY to ubuntu/name"
</pre>
----
<nowiki>[[CategoryMozillaTeam]]</nowiki>
