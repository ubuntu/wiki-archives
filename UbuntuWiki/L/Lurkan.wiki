{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__



=== Presentación ===

=== Resetas de cocina ===

==== Cifrado y automontaje de USB en Kubuntu 8.04.1 ====

(20/10/2008 20:43)

La idea es tener un USB, SD o cualquier dispositivo desmontable con su información cifrada, para garantizar su seguridad.

Pues va la receta de cocina:

'''Ingredientes:'''

1. Kubuntu 8.04.1 actualizado. probado con la 3.5.10 de kde pero funciona con todas las anteriores.
* cryptsetup
* /etc/udev/rules.d/94-udev-cripsetup.rules
   con el sigueinte contenido

<pre>
KERNEL!="dm-*", GOTO="device_mapper_end"
ACTION!="add|change", GOTO="device_mapper_end"
IMPORT{program}="/sbin/dmsetup export -j $major -m $minor"<U+FEFF>
LABEL="device_mapper_end"
ENV{DM_NAME}=="temporary-cryptsetup-*", OPTIONS+="ignore_device"
</pre>

1.#4 /etc/udev/rules.d/94-udev-cripsetup.rules
  donde vamos a agregar en la linea 18 la siguiente linea

<pre>
SUBSYSTEMS=="mapper",                   GROUP="plugdev"
</pre>

1.#5 Modulos del kernel que  vamos a instalar pero que ya están compilados en los paquetes de kubuntu.

<pre>
dm_crypt
</pre>

'''Utensilio de cocina a utilizar y como utilizar.'''

1. Un shell, que seguramente sera konsole, ¿existe otro?
* ~$       es el prompt del un usuario
* ~#       es el prompt de root.
* XXX      partición y dispositivo de cada usuario, se puede obtener conectando el dispositivo y escribiendo dmesg en el shell y buscarlo al final , sda1 sdb1 sdc1 pueden ser las opciones a buscar.
* Cucharón grande y resistente marca VIM o VI o incluso emacs

'''Preparación:'''

Primero debemos de revisar que tenemos nuestra distribución actualizada, siempre es mejor utilizar ingredientes frescos.

Hacer todo como root y esto puede hacerse de dos formas, escribiendo sudo antes de cada linea o hacerlo de forma permanente, entendiendo por permanente el tiempo que estemos en esta shell.

Como a mi no me gusta pasármela escribiendo sudo prefiero hacer un sudo por sesión.

<pre> numbers=off
lurkan@lurkan-desktop:~$ sudo -s       #Escribimos sudo -s
[sudo] password for agsm:              #Nos preguntara el pasword del usuario que se puede convertir en root.
root@lurkan-desktop:~#                 #Nos hemos convertido en root para toda esta sesión.
</pre>

lurkan@lurkan-desktop:~$ '''sudo -s'''       #Escribimos sudo -s

[sudo] password for agsm:              #Nos preguntara el pasword del usuario que se puede convertir en root.

root@lurkan-desktop:~#                 #Nos hemos convertido en root para toda esta sesión.

~# '''aptitude update''' #Para que actualize la base de datos y sepa que paquetes necesitan actualización.

~# '''aptitude safe-upgrade'''  #Nos dira lso paquetes que se necesitan actualizar.

Una vez con el nustro Gnu/Linux kubuntu 8.04.1 fresquesito  comenzamos a mezclar los ingredientes

~# '''aptitude install cryptsetup''' #Instala el programa crypsetup.

~# modprobe dm_crypt #Carga un modulo de cifrado.

~# echo dm_crypt >> /etc/modules #Cargará el modulo en cada arranque de nuestro GNU/Linux.

~# luksformat -t ext3 /dev/XXXX #Fomatea (BORRA TODO, absolutamente todo) y cifra la partisión, así mismo nos pedira el pasword a utilizar, por favor no lo OLVIDEN ya queno es recuperable

~# cryptsetup luksOpen /dev/XXXX cryptmnt

# Crearemos a fuego lento el script de inicio del punto 3 y lo pondremos en su lugar con estos permisos

-rw-r--r-- 1 root root   241 2008-10-19 01:16 94-udev-cripsetup.rules

3.-   /etc/udev/rules.d/94-udev-cripsetup.rules

KERNEL!="dm-*", GOTO="device_mapper_end"
ACTION!="add|change", GOTO="device_mapper_end"
IMPORT{program}="/sbin/dmsetup export -j $major -m $minor"<U+FEFF>
LABEL="device_mapper_end"
ENV{DM_NAME}=="temporary-cryptsetup-*", OPTIONS+="ignore_device"

Iremos agregando lentamente la linea del punto 4 con mucho cuidado o terminaremos batiendo todo

-rw-r--r-- 1 root root 3165 2008-10-19 02:58 /etc/udev/rules.d/40-permissions.rules

4.- /etc/udev/rules.d/94-udev-cripsetup.rules

SUBSYSTEMS=="mapper",          GROUP="plugdev"

Este ingrediente va aproximadamente en la linea 16 como se muestra el extracto del archivo con los números de linea iniciales como referencia

 14 SUBSYSTEMS=="mmc",         GROUP="plugdev"
 15 SUBSYSTEMS=="pcmcia",     GROUP="plugdev"
 16 SUBSYSTEMS=="mapper",    GROUP="plugdev"
 17 LABEL="block_end"

Estos números se pueden obtener si utilizamos el cucharón VIM y una ves dentro del archivo podemos  darle.

 :set number

Una vez llegado a este punto se puede proceder a  probar  nuestro platillo pero tendremos que hacer las cosas a mano, para ver que el udev este funcionando bien apague su equipo es pere que este se enfríe y proceda a encenderlo y hacer la prueba del sabor metiendo una USB  y veremos como en el desktop saldrá una ventana preguntandonos si lo queremos decifrar:

En este punto le decimos que decrypt y le damos enter a los que nos preguntara el passwd:

le damso el passwd que nos solicito al dar el luksformat, luego nos preguntara si lo queremso abrir en una nueva ventana y le decimos que si.

Y se abre la ventana con su contendo para que podamos hacer lo que querramos.
para desmontar el dispositivo solo le damos con el botón derecho sobre el icono del USB y le damos extracción segura, lo desmonta es decir le quita la pestañita de montado y ya lo podemos extraer de forma segura, sip así de facil y simple.  nuestro USB esta con toda la información cifrada  y yo puedo dormir más tranquilo.

Saludos y espero que les funcione.

PD: hoy fue un  día pesado no revise la ortografía a fondo por favor ayudenme en eso.

 20 de octubre del 2008   23:11 hrs  UTC -5

----

=== Lineas mágicas ===

Esas lineas que nos han sido tan útiles y que utilizamos poco, pero que sin ellas estaríamos horas apretando teclas y más teclas.

1. Borrar archivos vacíos y sobre todo cunado son muchos, me ayudo a borrar 85670 archivos en segundo
** find -empty  -exec rm {} \;

* Otro consejito
** Consejito

=== Edición en vi ===

1. Este ejemplo substituye todas las coincidencias de "anterior" por "nuevo".

** :g/anterior/s//nuevo/g
 
* Corrección ortográfica y opciones al arrancar vi
 
Esta configuración se guarda en .vimrc en nuestro home, todas las opciones se pueden activar o desactivar con :set no<opción>.

Se pueden escribir linea por linea en una sesión activa de vi o vim pero solo será para esa sesión

La primera vez que se active el diccionario deberán hacerlo en una sesión activa para que el mimo (u,k)ubuntu baje de internet el diccionario y no tengamos que instalarlo a mano las palabras con errores ortográficos se pondrán en rojo o azul si es de semántica podemos incluso darle alt z = (tecla "alt" al mismo tiempo de la "z" y luego el signo igual) y nos desplegara una lista de palabras parecidas, seleccionando el numero de la palabra que aparese a la izquierda, esta es reemplazada. Super útil y se puede pagar y encender a gusto del usuario, sobre todo para mi que escribo articulos y documentación y me parece una perdida de recursos abrir un kword o el pesado openoffice para hacer algo tan sencillo como escribir textos.

** :set number #activa la numeración por linea :set nonumber la desactiva
 
** :set spelllang=es_es,en #Carga el diccionario en o los lenguajes que necesitemos
 
** :set spell #Activa el corrector ortográfico en tiempo real :set nospell desactiva  
 
** :set nobackup #No crea archivos de respaldo

** :set nowritebackup #No graba un archivo de respaldo
 
<pre>
Contenido de .vimrc

set number
set spelllang=es_es,en
set spell
set nobackup
set nowritebackup
</pre>

Resulta ser que en algunos equipos si baja automáticamente el corrector ortográfico y en otros no, por cualquier cosa aquí los pongo, bájenlos descompactenlos y coloquenlos en /usr/share/vim/vim71/spell/ junto a los de ingles que seguramente ya tiene.

sudo tar -zxvf orto-vi.tar.bz2 -C /usr/share/vim/vim71/spell/

<nowiki>[[attachment:orto-vi.tar.bz2]]</nowiki>

----

=== Enlaces de interes ===
==== svn ====
==== Compugraf ====
==== Lurkan 2 ====
<nowiki>[[http://www.e-compugraf.com | COMPUGRAF]]</nowiki>
<nowiki>[[https://wiki.ubuntu.com/Lurkan-SVN| SVN]]</nowiki>
<nowiki>[[https://wiki.ubuntu.com/Lurkan-2| lurkan-2]]</nowiki>
 
------
=== Escríbeme ===

Alejandro G. Sánches Martínez (Lurkan)

Email: 
----
CategoryHomepage
