{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__

* Contact: HeikkiKeränen, DanyCalleri

* Brand: HP Compaq nx7400

* Model: EY305ET#AK8(tested by HeikkiKeränen), EY474ES#ABZ(tested by DanyCalleri)

* Website: http://h10010.www1.hp.com/wwpc/us/en/sm/WF05a/321957-321957-64295-321838-89315-1847094.html

See also another compatibility page for model EY448ET: http://home.no/slazz/nx7400/

See also: http://emisca.altervista.org/nx7400

=== Current Issues ===

==== Hardy ====

Laptop does not come out from the "suspend to RAM" with BIOS version F.06. Beta versions of Hardy did. BIOS version F.0C comes out from Suspend to RAM, but quite often the laptop (apparently BIOS) gives about 6 short beeps and a message box appears on the desktop: "Suspend Problem. Your computer failed to suspend". If a USB hub is connected when suspending, there is a high change (~50%) that the laptop does not recover from suspend (screen stays black). Current kernel version is 2.6.24-19.

==== Edgy ====
Power management works but not out of the box. There is the need to use a more recent kernel to get suspend to ram. 2.6.19-rc5 works well.
Pay attention that enabling Drivelock password on bios makes resume from suspend impossible. The drive is locked by the bios and never unlock it.
Screen backlight after suspend to ram is powered off. If the brightness keys are pressed the light turns on. Don't use vbetool save/post or acpi_sleep
parameter as it causes a machine hang on resume.

==== Dapper ====
* Out of the box the power management does not work correctly: does not come out from the sleep mode and after hibernation the X stays blank (Ctrl+Alt+Backspace helps but the resolution is wrong). 
* 1680x1050 native resolution works with the help of 915resolution (needs manual installing and configuring to start at the boot). 
* Frequency scaling of the processors works but only up to 1.3 GHz of the maximum 1.83GHz (see a workaround below) 
* Enters into a "bad state" if Linux is shut down with a psmouse module loaded (see workaround below).

=== System Info ===
<pre>

bios-version:68YGU Ver. F.02
system-manufacturer:Hewlett-Packard
system-product-name:HP Compaq nx7400 (EY305ET#AK8)
system-version:F.02

bios-version:68YGU Ver. F.06
system-manufacturer:Hewlett-Packard
system-product-name:HP Compaq nx7400 (EY305ET#AK8)
system-version:F.06
</pre>

=== Hardware details ===
{| class="wikitable"
|-
| 
| in Dapper
| in Edgy
| in Hardy 8.04
|-
| Installation works?
| Yes
| Untested
| Yes
|}

{| class="wikitable"
|-
| <-4> '''Hardware Information'''
|-
| <-4> '''Screen & Monitors'''
|-
| <|2> '''Device'''
| <-3> '''Works?'''
| <|2> '''Bug #'''
|-
| in Dapper (current stable LTS)?
| in Edgy (current stable)?
| in Hardy 8.04
|-
| Screen
| Yes (shows 1280x1024 stretched to widescreen)
| Yes (1280x800)
| Yes
|-
| Correct resolution?
| Yes (1680x1050) with help of the 915resolution tool
| Yes
| Yes (1680x1050)
|-
| Correct refresh rate?
| Untested
| Yes
| Yes
|-
| 3D Acceleration
| Yes
| Yes
| Yes, 3D desktop effects out of the box!
|-
| External monitor works?
| Yes
| Yes
| Yes
|-
| External monitor - mirrors
| Yes, but cropped and strecthed (1280x1024 LCD-panel)
| Yes
| Yes
|-
| External monitor - extend desktop
| Yes
| Yes (also using mergedfb, hardware resolution limit 2048x2048)
| Yes, see notes below
|-
| <-4> '''Power Management'''
|-
| Battery detected?
| Yes, see a bug workaround in notes-section
| Yes
| Yes
|-
| Hibernates?
| Yes, but does not initiate X properly (blank) after wake-up
| Yes (ahci mode and ata_piix)
| Not tested
|-
| Sleep
| No, after wake-up the screen is blank and does not respond
| Yes (ahci mode and ata_piix)
| Yes with BIOS version F.0C, does not work with F.06
|-
| Dim monitor on battery
| Yes
| Yes (sometimes the screen backlight is turned on)
| Yes
|-
| Blank monitor on inactivity
| Yes
| Yes
| Yes
|-
| Lid Close
| Yes
| Yes
| 
|-
| Cpu frequency scaling
| Yes, see fix below to get full 1.83 GHz
| Yes (same problem, see below)
| Yes
|-
| <-4> '''Sound'''
|-
| Sound works?
| Yes
| Yes
| Yes
|-
| Correct volume?
| Yes
| Yes
| Yes
|-
| Hardware volume switch
| Yes, mute, up, down
| Yes, mute, up, down
| Yes
|-
| Headphone jack
| Yes
| Yes
| Yes
|-
| Mic jack
| Yes
| Yes
| 
|-
| <-4> '''Networking'''
|-
| Wired NIC
| Yes
| Yes
| Yes
|-
| Wireless NIC
| Yes (built in IPW3945abg, also on/off button and lights work)
| Yes (built in IPW3945abg, also on/off button and lights work)
| Yes
|-
| PCMCIA NIC
| Yes (Orinoco Silver WiFi)
| Untested
| Untested
|-
| Firewire
| Yes
| Untested
| Yes
|-
| Bluetooth
| Yes
| Untested
| Yes, OBEX receive after patching bluez-utils
|-
| Modem
| No (no effort used, not needed)
| sl-modem work with alsa
| not tested
|-
| Infrared
| n/a
| n/a
| n/a
|-
| <-4> '''Touchpad & Mice'''
|-
| Touchpad
| Yes
| Yes
| Yes
|-
| Touchpad - Doubletap = double click
| Yes
| Yes
| Yes
|-
| Touchpad - Scroll down side
| Yes
| Yes
| Yes
|-
| Touchpad - turned off while typing
| Untested
| Untested
| 
|-
| External mouse - USB
| Yes
| Yes
| Yes
|-
| External mouse - Serial
| n/a
| n/a
| n/a
|-
| <-4> '''Docking Station/Port Replicator''' HP Basic Docking Station (EN488UT)
|-
| AC through replicator
| Yes
| Untested
| Untested
|-
| USB
| Yes
| Untested
| Untested
|-
| Serial
| Untested
| Untested
| Untested
|-
| Parallel
| Yes
| Untested
| Untested
|-
| External Monitor - VGA
| Yes
| Untested
| Untested
|-
| External Monitor - DVI
| n/a (see notes below)
| Untested
| n/a
|-
| Modem
| Untested
| Untested
| Untested
|-
| NIC
| Yes
| Untested
| Untested
|-
| PS/2
| Yes (only keyboard tested)
| Untested
| Untested
|-
| Audio Line Out
| Yes (silences laptop speakers when plugged)
| Untested
| Untested
|-
| Audio Line In
| Yes (after selecting docking station capture from alsamixer)
| Untested
| Untested
|-
| TV Out
| Untested
| Untested
| Untested
|-
| S-Video Out
| Untested
| Untested
| Untested
|-
| Power-button
| Yes
| Untested
| Untested
|-
| <-4> '''Additional Hardware'''
|-
| Fingerprint reader
| n/a
| n/a
| n/a
|-
| DVD+-RW DL drive
| Yes (CD-R, DVD-ROM, DVD-RW read and DVD-RW burning tested)
| Yes (CD-R, DVD-ROM, DVD-RW read and DVD-RW burning tested)
| Yes
|-
| PCMCIA cards
| Yes (Orinoco Silver Wifi card)
| Untested
| Untested
|-
| Parallel Ports
| n/a
| n/a
| n/a
|-
| Card reader(s)
| n/a
| n/a
| n/a
|}

{| class="wikitable"
|-
| <-6 tablewidth="75%"> '''Function and other keys'''
|-
| <|2> '''Fn key'''
| <|2> '''Operation'''
| <|2> '''Keycode'''
| <-3> '''Works?'''
| <|2> Bug #
|-
| in Dapper (current stable)?
| in Edgy (current development)?
|-
| + Space
| 
| 
| Untested
| Untested
| 
|-
| + Esc
| 
| 
| Untested
| Untested
| 
|-
| + F1
| 
| 
| Untested
| Untested
| 
|-
| + F2
| 
| 
| Untested
| Untested
| 
|-
| + F3
| Suspend
| 
| Causes suspend when the laptop is not in the "bad state" (see notes below)
| Suspend
| Suspend
|-
| + F4
| Activate external monitor
| 
| Yes
| Yes
| 
|-
| + F5
| 
| 
| Untested
| Untested
| 
|-
| + F6
| 
| 
| Untested
| Untested
| lock screen
|-
| + F7
| 
| 
| Untested
| Untested
| 
|-
| + F8
| Battery info
| 
| Yes, shows battery info tooltip
| Yes
| Yes
|-
| + F9
| Screen brightness down
| 
| Yes
| Yes
| Yes
|-
| + F10
| Screen britheness up
| 
| Yes
| Yes
| Yes
|-
| + F11
| 
| 
| Untested
| Untested
| 
|-
| + F12
| 
| 
| Untested
| Untested
| 
|-
| + ArrowUp
| PageUp
| 
| Yes
| Yes
| 
|-
| + ArrowDown
| PageDn
| 
| Yes
| Yes
| 
|-
| + ArrowRight
| End
| 
| Yes
| Yes
| 
|-
| + ArrowLeft
| Home
| 
| Yes
| Yes
| 
|-
| + PgUp
| Pause
| 
| Untested
| Yes
| 
|-
| + PgDown
| inter
| 
| Untested
| Yes
| 
|-
| <-6> '''Other special keys'''
|-
| <|2> '''Key'''
| <|2> '''Operation'''
| <|2> '''Keycode'''
| <-2> '''Works?'''
| <|2> Bug #
|-
| in Dapper (current stable)?
| in Edgy (current development)?
|-
| Key
| 
| 
| Untested
| Untested
| 
|}

==== Notes ====

=== Hardy installation notes ===

==== Xrandr and Xinerama with Intel GMA 950 ====

Intel GMA 950 does not support DRI with virtual screen size larger than 2048x2048. This limit is exceeded for example by trying to put laptop 1680x1050 display and external 1280x1024 LCD side by side (2960x1050). But without 3D support it does. See http://www.thinkwiki.org/wiki/Intel_Graphics_Media_Accelerator_950 how to modify xorg.conf to support larger than 2048x2048 virtual displays without 3D support. Unfortunately 3D desktop effects are gone. Modify xorg.conf "Screen" section:
<pre>
Section "Screen"
	Identifier	"Default Screen"
	Monitor		"Configured Monitor"
	Device		"Configured Video Device"
	SubSection "Display"
		Modes		"1680x1050"
		Virtual		2960 1050
	EndSubSection
EndSection
</pre>

=== Dapper installation notes ===

==== How to fix the "bad state" problem ====

When the Linux is shut down with a psmouse kernel module installed (needed for the touchpad to work) the laptop goes in to the "bad state". The only way to come out from it is to shutdown the laptop and disconnect both the AC adapter and the battery for at least for 5 seconds or so.

Problems in the bad state:
* Battery status applet shows wrong information: if AC adapter is connected or disconnected, it does not react.
* Laptop does not go into the sleep mode (Fn+F3)
* there is probably also other symptoms

See http://forums1.itrc.hp.com/service/forums/bizsupport/questionanswer.do?threadId=1026460&admit=-682735245+1154898021917+28353475 for more information.

To work around this add line "/sbin/modprobe -r psmouse" into /etc/init.d/halt and /etc/init.d/reboot scripts (right after the PATH variable setting lines). 

These are the patched scripts (Succesfully Test on "Edgy Eft" and "Feisty Fawn"):

/etc/init.d/halt
<pre>

PATH=/usr/sbin:/usr/bin:/sbin:/bin
[ -f /etc/default/halt ] && . /etc/default/halt

. /lib/lsb/init-functions

do_stop () {
	/sbin/modprobe -r psmouse
	if [ "$INIT_HALT" = "" ]
	then
		case "$HALT" in
		  [Pp]*)
			INIT_HALT=POWEROFF
			;;
		  [Hh]*)
			INIT_HALT=HALT
			;;
*** )
			INIT_HALT=POWEROFF
			;;
		esac
	fi

# See if we need to cut the power.
	if [ "$INIT_HALT" = "POWEROFF" ] && [ -x /etc/init.d/ups-monitor ]
	then
		/etc/init.d/ups-monitor poweroff
	fi

# Don't shut down drives if we're using RAID.
	hddown="-h"
	if grep -qs '^md.*active' /proc/mdstat
	then
		hddown=""
	fi

# If INIT_HALT=HALT don't poweroff.
	poweroff="-p"
	if [ "$INIT_HALT" = "HALT" ]
	then
		poweroff=""
	fi

	log_action_msg "Will now halt"
	sleep 1
	halt -d -f -i $poweroff $hddown
}

case "$1" in
  start)
# No-op
	;;
  restart|reload|force-reload)
	echo "Error: argument '$1' not supported" >&2
	exit 3
	;;
  stop)
	do_stop
	;;
** )
	echo "Usage: $0 start|stop" >&2
	exit 3
	;;
esac

:
</pre>

/etc/init.d/reboot
<pre>

PATH=/usr/sbin:/usr/bin:/sbin:/bin

. /lib/lsb/init-functions

do_stop () {
	/sbin/modprobe -r psmouse
# Message should end with a newline since kFreeBSD may
# print more stuff (see #323749)
	log_action_msg "Will now restart"
	reboot -d -f -i
}

case "$1" in
  start)
# No-op
	;;
  restart|reload|force-reload)
	echo "Error: argument '$1' not supported" >&2
	exit 3
	;;
  stop)
	do_stop
	;;
** )
	echo "Usage: $0 start|stop" >&2
	exit 3
	;;
esac
</pre>

==== To get the maximum speed out of the processor ====

"cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq" gives 1333000 when 
"cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_available_frequencies" gives 1833000 1333000 1000000 for my processor.
To set the maximum frequency to 1833000 do following:
<pre>
</pre>

To make settings permanent make a file /etc/init.d/setcpumaxfreq
<pre>
echo 1833000 > /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
echo 1833000 > /sys/devices/system/cpu/cpu1/cpufreq/scaling_max_freq
</pre>

Add execution permissions and add to boot scripts:
<pre>
</pre>

==== Native LCD resolution (1680x1050) ====

I followed this guide to install 915resolution: https://help.ubuntu.com/community/i915Driver
For some reason the 915resolution was not executed at the boot so
I had to add it manually. Here are the complete steps:
<pre>
</pre>

Edit file:
"/etc/init.d/915resolution", add new line according to example below:
<pre>

/usr/sbin/915resolution 50 1680 1050 32

</pre>

And reboot. There was no need to edit xorg.conf.

=== General remarks of the laptop ===

Unfortunately it seems that DVI is not physically connected to docking port pins in the nx7400 series. DVI output of the docking station did not work even in Windows XP. Monitor just displays "Check the cable" although DVI cable is connected. This seems to be a feature of HP nx series: http://forums1.itrc.hp.com/service/forums/bizsupport/questionanswer.do?threadId=1065796

----
CategoryLaptop CategoryLaptop
