{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__


* Created:  by <nowiki>[[Freeflying]]</nowiki>
* Priority: NeedsPriority
* People: NeedsLead, NeedsSecond
* Contributors: <nowiki>[[Freeflying]]</nowiki>, AbelCheung4, <nowiki>[[Atie]]</nowiki>, JunKobayashi, <nowiki>[[Zero0w]]</nowiki>
* Interested:
* Status: UbzSpecification, BrainDump (then DraftSpecification then EditedSpecification then ApprovedSpecification), DistroSpecification
* Branch: 
* Malone bug: 
* Packages affected: 
* Depends: 
* Dependents:
 <<FullSearch>>
* BoF sessions: none yet 

=== Summary ===
This project aims at improving CJK support in Ubuntu.

=== Rationale ===
As of Breezy, since it has no default input method, normal CJK users can't write their native language on Ubuntu desktop environment. Additionally, the default configuration for various applications and the whole desktop is not so suitable for Asian users and users from certain countries. For example, default desktop font size is simply too small for CJK users, especially Chinese. To improve the experience for these users, some packages need to be patched, while others may need additional configuration.

=== Use cases ===
* Chulsu installed Ubuntu onto his laptop and opened Firefox to see his favorite Korean web forum.  Then, he found that first, "why this page looks diffrent than Firefox on Windows of my desktop", second, "how to input Korean to write my reply to the forum" and so on.  He started to search Ubuntu Korean wiki and KLDP, and asked his questions.  Spending several days, he just knew about how to install font packages, how to configure .fonts.conf under his home directory, how to install and use his Korean Input Method and so on.  Now, he is thinking "why Linux is so difficult than Windows, but if all of these installed and configured when I installed Ubuntu that's the way to go."
* Yeonhee loves to listen her favorite CDs when she is working on OpenOffice for her writing.  For her one month trip to Jeju island, she wanted to convert them into MP3, but couldn't find a convert tool from Ubuntu installed on her new laptop.  Anyway, she converted her favorite songs with MP3 music tag from her Windows, then opened Rhythmbox on Ubuntu laptop to listen them in case of testing.  Now, she is looking at the song names aren't correctly shown up with Korean, "how I gonna go to my trip?"
* Miyoung wanted to try Linux for her class, but she never used Linux before. Her classmate gave her Unbuntu CD so she was happy.  But, on the way back to home, she felt some difficulties for installing the CD to her desktop which already had Windows installed, decided that "OK, I am going to search Ubuntu site for installing, what a great if I can find Korean guides are there, I should learn English..., does this CD support Korean?...".  

=== Scope ===
* Suggest that split this spec into several parts to concentrate and achieve one by one from most important one.
** For SCIM as default Input Method for CJK users, suggest that use <nowiki>[[InputMethods/SCIM]]</nowiki> to gather development ideas about improvements and specifications
*** We need to workaround the <nowiki>[[SCIM]]</nowiki> ABI bug before we go ahead with this choice.
* Default Input Method for CJK users, FontConfig and Enabling Embolden with patches are the topics we should focus first, in my opinion.
* Keep this spec as main to see overall scope, progress and implementations, add sub-specifications here.
*** <nowiki>[[BetterCJKSupportSpecification/FontConfig]]</nowiki> : Specify fonts.conf for CJK users to reflect into fontconfig
* Please add your ideas to specify scope of Dapper implementation. If it is too late, we can still use this specification for Dapper+1.

=== For localization sprint ===
* For Korean : (Requested on 2006-3-13, copied to DapperLocalisationKorean on 2006-3-16) 
   i. Korean Keyboard problem (http://launchpad.net/bugs/30848) 
   i. Enable skim module with scim-hangul 0.2.2 (http://launchpad.net/bugs/34472)
   i. Make ttf-unfonts as default font for Korean : as described in <nowiki>[[BetterCJKSupportSpecification/FontConfig]]</nowiki>
      Debian's ttf-unfonts maintainer tried this using alias for sans and serif with unfonts, but had an impact on entire fontconfig.
   i. Set DHCP with mac address (http://launchpad.net/bugs/26949)
   i. language-support-ko failed to install with flight5 (https://launchpad.net/bugs/34784)

=== Design ===
 1. Install a default input method such as scim, and start it automatically when user start X. Besides, users should be allowed to have their own individual setting.
** Useful links here for Korean Input Methods 
          http://wiki.kldp.org/wiki.php/KoreanInputMethod 
** Scim shall be the default input method, there are already many IM engines based on scim, and so far its language support is the best. Even Fedora and Mandriva are using it by default.

 1. Better environment variables tuning for CJK users in language-selector, installer etc.
** <nowiki>[[https://launchpad.net/distros/ubuntu/+source/language-selector/+bug/26536|Bug report on language-selector]]</nowiki>

 1. Tune fontconfig setting to achieve better CJK fonts display (e.g. more solid font outline, bold type, use bitmap for medium font size etc). Surely,to obtain this, we need some font package's support like ttf-arphic-uming/ukai.
** Use ttf-arphic-uming/ukai by default, since these are the only package that contain Hong Kong characters for all sizes.
** Install xfonts-wqy for simplified Chinese installation; ttf-newsung is not needed since it has already been included into uming/ukai.
** Regarding this fontconfig topic, Korean Linux users are discussing about default font for Distro instead of ttf-baekmuk, currently most favorite font is ttf-unfonts then ttf-alee. <nowiki>[[KoreanTeam]]</nowiki> will provide up-to-date <nowiki>[[BeautifyKoreanFonts]]</nowiki> once decision will be made for a font package.
** In Japanese case, there is no completely free and high quality Japanese font. Ubuntu uses Kochi font which is DFSG free, but it is inferior of quality to commercial Japanese fonts. This font issue is barrier to expand use of completely free linux distribution in Japan.
    a. ''Not exactly true''. For Kochi Gothic & Mincho, you can change the fontconfig setting to display embedded bitmap at font size 12-17 & 20-21 (you can install the '''Fontforge''' package to verify this). Once the setting is adjusted, they will look much better at those sizes. Also, OpenOffice.org2 internally recognizes embedded bitmap and will look nice on these two font sets.
***** I think the majority of Japanese users prefer outlines, not bitmaps. In Fact, Fedora and Mandriva don't use embedded bitmaps for Japanese. These developpers choose outlines for Japanese. And Kochi's outline has worse quality than IPA and IPA Mona's.
***** Are you sure the decision not to use outline is an informed one among all three distro developers you mentioned? Because in general, very few people know embeddedbitmap fonts exist at all (even on Windows, because by default Windows uses embeddedbitmap). If as you said many Japanese users prefer outline font, sure go ahead. CJK Users can always switch it on again within /etc/fonts/fonts.conf.

         I do know the situation is quite opposite for Chinese users.

***** In Japan there is no clear tradition to select outlines or bitmaps unlike China and Korea.

         I have distribute Japanese customized Ubuntu CD image for 9 months, and I had some requests to use outlines on legacy(GTK1 etc) applications and OpenOffice.org, but I had no requests to use bitmaps on GTK2 applications. So I think many Japanese users prefer beautiful outlines in the tradition of Mac OS X.

         BTW, I had misconception the default setting on SuSE. The default setting for CJK on SuSE is bitmaps now. I'm removing that from above.
 
***** On OpenOffice.org Kochi Gothick & Mincho look fine with bitmaps as above. But if you print out with these fonts, turn into a nightmare. You'll see poor Japanese charactors on your printed page.
        
    a. There are "IPA Font" and "IPA Mona Font", they are high quality and free-for-use Japanese Font. Unfortunately this font is not completely free. The license but demands redistributing with one of softwares specified by the supplier. At present, Japanese Team supplies IPA Font and IPA Mona Font debian packages for Breezy. Check out this <nowiki>[[http://ukai.org/b/log/debian/legal|blog]]</nowiki> for more detail.  ''Note'': The article of this blog is no more than his guess. IPA Font and IPA Mona font packages distributed by the Japanese Team include one of software specified by the supplier based on the IPA Font license. Additionally, the packages listed in this blog are installer-helper package or installed from the backport repository by their GUI setting helper (like Easy Ubuntu).
        
        ''Interesting find'': Using '''Fontforge''' to open and explore the ttf files from IPA and IPA Mona font collection, it seems that these font sets carry embedded bitmap at various sizes:
        
        For "IPA Font" collection: All the fonts carry embedded bitmap at size 12, 14, 16.

        For "IPA Mona Font" collection:
****** IPAMonaUIGothic (ipagui-mona.ttf) carries embedded bitmap at size 12-16
****** For the rest of IPAMona collection, they all carry embedded bitmap at size 10-16
    
    a. As a result of these findings, it is strongly recommended to turn on embedded bitmap in the fontconfig setting by default. It is now known that Uming, Kochi, IPA and IPAMona will all benefit from this, possibly including some other free CJK fonts. If in suspicion, inspection by '''Fontforge''' is encouraged. (the program '''ftdump''' from freetype2-demos package can also be used to inspect in which size is bitmap available)
***** I'm the author of IPA Mona Fonts. IPA Mona Fonts include bitmap fonts as above. But I think that it's good to use autolines for Japanese by default, because normal users prefer outlines. Small number of Japanese users love bitmaps, so I added bitmaps in some sizes for them. This is not for all Japanese Users.
 1. Enable embolden font by default for CJK users
** Build xft2, fontconfig, pango and cairo2 with embolden enabled 
** A good news with Dapper's libxft2 2.1.8, embolden enabled without rebuilding them
** update fontconfig with 2.3.92+cvs20051129 : Enable embeddedbitmap as default
** See more about this in <nowiki>[[BetterCJKSupportSpecification/FontConfig]]</nowiki>
** cairo-ft patch : http://lists.freedesktop.org/archives/cairo/2005-September/005404.html
** Akito's CJK autofit patches were merged into <nowiki>[[http://lists.gnu.org/archive/html/freetype-devel/2006-02/msg00031.html|freetype 2.2.0 branch]]</nowiki>: so expect more improvement from the new version, to be released after <nowiki>[[http://lists.gnu.org/archive/html/freetype-devel/2006-03/msg00023.html|these last bugs]]</nowiki> are fixed.
** Unfortunately, freetype 2.2.0 would break a lot of things and backward compatibility wrapper has been written to cope with the situation. More details can be found from the links at <nowiki>[[http://freefonts.oaka.org/index.php/Drastic_changes_in_FreeType_2.2|this page]]</nowiki>.

 1. Keyboard support for CJK native languages 
** Korean ( under survey :  http://bbs.kldp.org/viewtopic.php?t=68034 )
** This is not Ubuntu specific issue, but report here too.
** Need to do two steps (setkeycodes and xmodmap) to get Hangul and Hangul_Hanja keys working.
{| class="wikitable"
|-
| 
| Hangul
| Hangul_Hanja
| Keyboard Type
| Exception
|-
| setkeycodes
| 71 122
| 72 123
| ps/2 type 106 keys
| ps/2 type keyboard requires setkeycodes, seems this is a bug with 2.6 kernel.
|-
| xmodmap
| 210
| 209
| ps/2 type 106 keys
| 
|-
| xmodmap
| 209
| 210
| usb 106 keys
| Same MS Natural keyboard Pro(106 keys) tested for ps/2 and usb. In case of usb connection, setkeycodes not required, but xmodmap is in reverse.
|-
| xmodmap
| 113
| 109
| Laptop keyboard
| 
|}
** <nowiki>[[https://wiki.ubuntu.com/handrake|handrake's patch]]</nowiki>, <nowiki>[[https://launchpad.net/distros/ubuntu/+source/linux-source-2.6.15/+bug/30848|30848]]</nowiki>, <nowiki>[[https://lists.ubuntu.com/archives/ubuntu-devel/2006-March/016356.html|a mail posted to ubuntu-devel]]</nowiki>

 1. CJK users should be able to display their mp3 file ID3 tag correctly. Historically these tagging issue is a mess, everybody is using her own legacy encoding for mp3 tag because there is no support for non-western languages until very recent ID3 tag specification.
** For applications which make use of GStreamer, setting GST_ID3_TAG_ENCODING can be an internim solution. There are more discussions on <nowiki>[[UTFEightCurrentProblems]]</nowiki>.

 1. (?) Allow users to read/write CJK under console.
** Or when this is impossible, change $LANGUAGE to C automatically so that users won't see lots of junk on console.

 1. Better support of CJK fonts in OpenOffice.org.
** Firefly has a large patch which makes OOo2 much better for CJK.
          http://opendesktop.org.tw/modules/mydownloads/visit.php?cid=20&lid=18
** Virtual bold and italic style patch on OOo2 in progress  
          http://www.openoffice.org/issues/show_bug.cgi?id=18285

          Status: The bug is officially fixed and verified, with the CWS module '''fakebold''' merged in the Sun's <nowiki>[[http://eis.services.openoffice.org/EIS2/cws.rss.CWSAnnounceNewsFeed/mws?guid=2443|SRC680_m146]]</nowiki> internal development build, to be released in OpenOffice.org 2.0.2 as a maintenance update. Ubuntu Dapper has fixed the issue by packaging version 2.0.2 as mentioned in <nowiki>[[https://launchpad.net/distros/ubuntu/+source/openoffice.org/+bug/23342|Malone #23342]]</nowiki>.
          
          ''Note'' Bug 18285 does ''not'' require freetype 2.1.10, it was a mistake on my part :) . You can install OpenOffice.org 2.0.2 Linux binaries from the official page (by converting RPM to DEB using '''alien''') and experience the effect of virtual style even on Ubuntu Hoary/Breezy right away.

 1. Configure firefox for print CJK correctly
** This can probably be done in per-language basis, in firefox language packs.
** Firefox supports ps output which should be converted to pdf by ps2pdf 

    Status: AbelCheung says that Firefox 1.5 seems to be OK

 1. Not only from Firefox, printing support for CJK users also affects these :
** Should able to convert installation guide to PS/PDF for CJK languages
** printing man pages from X terminals
** printing from xpdf-korean, groff, a2ps and gnome-u2ps : Check hard-coded font names

=== Implementation ===

==== Code ====

==== Data preservation and migration ====

==== Packages affected ====
input methods:
* As of 2005-12-29, nabi (0.15-2) supports im-switch, no extra setup required for Korean Input if you install nabi and im-switch. If you install nabi under en_US locales, you can set nabi with "im-switch -s nabi" which creates ~/.xinput.d/en_US .  For other locales, it should work same.

font packages:
* As of 2005-12-08, ttf-arphic-uming/ukai packages are moved to main, and original Arphic fonts are obsoleted.

freetype:
* As of 2006-01-16, the 6 patches for freetype 2.1.10 are in REVU, http://revu.tauware.de/details.py?upid=1512
* As of 2006-01-19, freetype 2.1.10-1ubuntu1 contains the 6 patches above.

fontconfig:
* add configure file suitable for CJK fonts under /etc/fonts/conf.d/.
* language-selector implemented instead of /etc/fonts/conf.d to sort out font configurations for CJK as mentioned in <nowiki>[[BetterCJKSupportSpecification/FontConfig]]</nowiki>.

firefox:
* For printing issues, it is fixed for Firefox 1.5. (c.f. https://bugzilla.mozilla.org/show_bug.cgi?id=190031)

openoffice.org ('''done'''):
* OOo2.0.1pre (src680-m137) included Firefly's patches - No extra patches required 
          By OOo2.0.0m143-0ubuntu2 : This is done as you see here http://bbs.kldp.org/viewtopic.php?p=335943#335943

im-switch:
* Improve automatic configuration; currently ONLY those who know this package exists and ONLY those who understand the ins and outs can configure input method settings. 
* scim and skim support im-switch with Dapper.

language-selector:
* It should set appropriate environment variables like $LANGUAGE and $LANG according to real life usage, and not just dummy settings. For example, Hong Kong people are using Taiwan translation mostly, but they may have their own; thus the correct setting is <code>LANGUAGE=zh_HK:zh_TW</code>.
* Add a variable, say $CONSOLE_NOT_LOCALIZED, and define it for each language. In particular, set it to "yes" for all CJK languages, so that during bash startup it could redefine $LANGUAGE to C under console. (and console ONLY!)

rhythmbox:

totem-xine:

mplayer:

scim :
* In progress
** scim-hangul : 0.2.2 is on the way <nowiki>[[https://launchpad.net/malone/bugs/34472|34472]]</nowiki>
* Done :
** <nowiki>[[MainInclusionReportscim]]</nowiki>
** scim-hangul : 0.2.1 included in main <nowiki>[[https://launchpad.net/malone/bugs/5534|5534]]</nowiki>
** Enabled Trigger keys with CJK native keys <nowiki>[[https://launchpad.net/malone/bugs/37687|37687]]</nowiki>
skim :
* Done :
** Enabled Trigger keys with CJK native keys <nowiki>[[https://launchpad.net/malone/bugs/37687|37687]]</nowiki>

language-support-?? :
* is used to cover specific requests per language such as different scim module dependency
 
gs-common(?) :  /usr/share/defoma/scripts/gs.defoma's 106 ~ 109 lines
  if ($c eq 'truetype-cjk') {
      '''# FIXME: need to support the sub font id for the collection.'''
       print FFFF '/', $Id->{0}->[$i], ' << /FileType /TrueType /Path (', $f, ') /SubfontID ', '0', ' /CSI [(', $h[6], ') ', $hh{$h[6]}, "] >> ;\n";
  }
  Exprienced that 108 line was complained with "use of uninitialized value ...  /var/lib/defoma/scripts/gs.defoma"
** <nowiki>[[https://launchpad.net/distros/ubuntu/+bug/6614|6614]]</nowiki>

=== Outstanding issues ===

=== BoF agenda and discussion ===
