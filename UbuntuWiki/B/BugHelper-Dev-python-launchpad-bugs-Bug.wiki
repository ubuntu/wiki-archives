{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__


== Bug - tutorial ==

=== General workflow ===
That is the way to use python-launchpad-bugs to get information on a bugreport or to edit a bugreport:

{{{#!python
>>> from launchpadbugs.connector import ConnectBug
>>> Bug = ConnectBug() # using the html mode of launchpad
>>> bug = Bug(120593)
}}}

This will give you read-write access to a bugreport, but if you are looking for a faster but read-only method you can also use:

{{{#!python start=2
>>> Bug = ConnectBug("text") # using the text mode of launchpad
}}}

It is also possible to get a bugreport by its url:

{{{#!python start=4
>>> bug = Bug(url="https://bugs.launchpad.net/buglog-data/+bug/120593")
}}}

If you want to change the bugreport or view private bugs you have to set Bug.authentication:

{{{#!python start=5
>>> Bug.authentication="cookie.txt" #for text-based mozilla cookie files   or
>>> Bug.authentication="cookie.sql" #for sql mozilla cookie files
}}}

It is also possible to do authentication via email-login and password. Note: This takes much longer than using cookie files, therefor python-launchpad-bugs provides a method to save the resulting cookie into a file

{{{#!python start=7
>>> Bug.authentication={"email": "login@email.com", "password": "YourPassword"}
>>> Bug.connection.save_cookie("/home/markus/.lpcookie")
}}}

There are currently different versions of launchpad, the stable bugs.launchpad.net and the testing environment bugs.edge.launchpad.net. Sometimes it makes sense to explicitly choose one of these versions to work with. In python-launchpad-bugs it is possible to define which version to use.

{{{#!python
>>> from launchpadbugs.lpconstants import HTTPCONNECTION
>>> b = Bug(123456)
>>> b.url
'https://bugs.launchpad.net/ubuntu/+source/xine-lib/+bug/123456'
>>> Bug.set_connection_mode(HTTPCONNECTION.MODE.EDGE)
>>> b = Bug(123456)
>>> b.url
'https://bugs.edge.launchpad.net/ubuntu/+source/xine-lib/+bug/123456'
}}} 

=== Attributes of a bugreport ===

==== Overview ====

{| class="wikitable"
|-
| '''Attribute'''
| '''Description'''
| '''Example'''
|-
| .activity
| Activity Log of a bugreport (type: list)
| <nowiki>[[#activity]]</nowiki>
|-
| .assignee
| Person assigned to a bugreport (type: user)
| <nowiki>[[#user]]</nowiki>
|-
| .attachments
| List of attachments
| <nowiki>[[#attachments]]</nowiki>
|-
| .branches
| List of bzr branches (only available in html mode)
| 
|-
| .bugnumber
| Number of a bugreport (type: int)
| 
|-
| .changed
| List of local changes to a bugreport
| <nowiki>[[#changed]]</nowiki>
|-
| .comments
| List of comments
| <nowiki>[[#comments]]</nowiki>
|-
| .date
| 
| 
|-
| .description
| 
| 
|-
| .duplicate_of
| 
| 
|-
| .duplicates
| List of duplicates of a bug
| 
|-
| .get_subscriptions_category
| Subscribers broken into 'directly', 'notified', and 'duplicates'
| 
|-
| .importance
| 
| 
|-
| .info
| 
| 
|-
| .infotable
| 
| <nowiki>[[#tasks]]</nowiki>
|-
| .milestone
| 
| 
|-
| .nickname
| 
| 
|-
| .private
| 
| 
|-
| .reporter
| 
| 
|-
| .security
| 
| 
|-
| .sourcepackage
| 
| 
|-
| .status
| 
| 
|-
| .subscriptions
| All subscribers
| 
|-
| .summary
| 
| 
|-
| .tags
| 
| 
|-
| .target
| 
| 
|-
| .text
| 
| 
|-
| .title
| 
| 
|-
| .url
| 
| 
|}

==== Activity Log ====

 Get the Activity Log:

{{{#!python start=5
>>> print b.activity[:3] #slice the list so it's more readable
[<thekorn 2007-06-15 16:29:00 UTC 'bug'>, <thekorn 2007-06-15 18:41:00 UTC 'description'>, <thekorn 2007-07-18 07:38:00 UTC 'name'>]
}}}

Members of this list have the following attributes:
* .date, datetime object indicating the time of the change
* .user, lphelper.user object
* .what, string saying what changed
* .old_value. of type str
* .new_value, of type str
* .message, of type str

==== Attachments ====

 Get a list of attachments:

{{{#!python start=5
>>> for a in bug.attachments:
...     print a
... 
<Attachment (up: 8554243), (down: <path-to-file>/120593/8554243/79140.patch)>
<Attachment (up: 8558770)>
<Attachment (up: 8554203)>
<Attachment (up: 8541039)>
}}}

As you can see there are four files attached to the bug and the first attachment has already been downloaded.

There are two ways of downloading an attachment:

{{{#!python start=7
>>> bug.attachments[0].text #this will get the content and
############### download the file to
############### ~/.bughelper/attachments-cache/<package>/<bugnumber>/<attachment_id>/<filename>
'content of the file'
>>> bug.attachments[0].download("/tmp/filename.ext") #this will download the file to /tmp/filename.ext
}}}

You can for example filter the list of attachments by the filename:

{{{#!python start=12
>>> def test_filter(a):
...     import re
...     return re.match("assignee.*", a.lp_filename)
... 
>>> [i for i in bug.attachments.filter(test_filter)]
[<Attachment (up: 8541039)>]
>>> bug.attachments[8541039].lp_filename
'assignee.patch'
}}}

These filtered attachments can be easily removed:

{{{#!python start=20
>>> bug.attachments.remove(func=test_filter)
True
}}}

To add an attachment you have to create an new attachment-object:

{{{#!python start=22
>>> attachment = Bug.NewAttachment(localfilename="<path-to-file>/79140.patch")
>>> attachment.description = "example patch"
>>> attachment.is_patch = True
>>> attachment
<Attachment (down: <path-to-file>/79140.patch)>
}}}

Now you have to add this attachment to the bugreport:

{{{#!python start=27
>>> bug.attachments.add(attachment)
>>> for a in bug.attachments:
...     print a
... 
<Attachment (up: 8554243), (down: <path-to-file>/120593/8554243/79140.patch)>
<Attachment (up: 8558770)>
<Attachment (up: 8554203)>
<Attachment (down: <path-to-file>/79140.patch)>
}}}

==== Comments ====

 Get a list of comments:
{{{#!python start=35
>>> [c for c in bug.comments][0:2]
[<Comment 1 by thekorn on 2007-07-20>, <Comment 2 by thekorn on 2007-07-20>]
}}}

Create a new comment and add this comment to the bugreport:
{{{#!python start=37
>>> comment = Bug.NewComment(text="this is a test comment",subject="test comment")
>>> bug.comments.add(comment)
>>> [c for c in bug.comments]
[<Comment 1 by thekorn on 2007-07-20>, <Comment 2 by thekorn on 2007-07-20>, ... , <Comment 'unknown'>]
}}}

==== Tasks ====

 Create a new task:
{{{#!python
>>> import launchpadbugs.connector as con
>>> Bug = con.ConnectBug()
>>> Bug.authentication = "cookies.sqlite"
>>> task = Bug.NewTask("project", "bzr-fs")
>>> b = Bug(214490)
>>> b.infotable.addTask(task)
>>> b.commit()
}}}

==== User ====

 User are String-like objects with an additional attribute `.realname`.<<BR>>
{{{#!python
>>> str(bug.assignee)
'thekorn'
>>> repr(bug.assignee)
'<user thekorn (Markus Korn)>'
>>> bug.assignee.realname
'Markus Korn'
}}}

=== Commit changes ===

==== get a list of changes ====

 {{{#!python start=41
>>> for i in bug.changed:
...     print i
... 
(<Attachmentlist> changed: (<Attachment (up: 8541039)> deleted), (<Attachment (down: <path-to-file>/79140.patch)> added))
(<Commentslist> changed: (<Comment 'unknown'> added))
}}}

==== commit changes ====
{{{#!python start=46
>>> bug.commit()
}}}

There are two possible arguments to `.commit()`:
* `force_changes=<bool>`:
** `False (default)`: 
** `True`: ''Example:'' If a user tries to add a tag `foo` to a bugreport and `foo` s not a tag in this product yet, launchpad will raise an error. If this option is set to `True` `foo` will be added to the list of tags to this project and than added to this bugreport.
* `ignore_lp_errors=<bool>`:
** `True (default)`: ignores launchpad processing errors
** `False`: raises a `ValueError` if launchpad is unable to change a value

=== Filing a bug report ===

{{{#!python
bug = Bug.New(product={"name": "python-launchpad-bugs"},
    summary="RFE: Add function to create a new bugreport",
    description="""It would be nice if a user could create a bugreport via a script using python-launchpad-bugs.

Markus""")
}}}

* product is a dictionary like `{"name": <lpname of the product>, "target": <distribution>}`
** `product={"name": "python-launchpad-bugs"}` creates a bug in https://bugs.launchpad.net/python-launchpad-bugs/
** `product={"name": "python-launchpad-bugs", "target": "ubuntu"}` creates a bug in https://bugs.launchpad.net/ubuntu/+source/python-launchpad-bugs/
** `product={"name": "ubuntu"}` creates a bug in https://bugs.launchpad.net/ubuntu/ (bug in "ubuntu" without a sourcepackage)
* other optional arguments to `.New()`:
** tags: list of tags like `["foo", "bar"]`
** `security_related` (default: `False`)
