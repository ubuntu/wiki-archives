{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__

Below are the test cases that should be run when gnome-settings-daemon is updated to new major releases in the development version of Ubuntu. These should also be run for all gnome-settings-daemon Stable Release Updates. 

The GNOME Settings Daemon is responsible for setting various parameters of a
GNOME Session and the applications that run under it.

All tests are meant to be executed from a GNOME Wayland desktop session (the default Ubuntu Desktop session).

=== Test A11y ===

# Enable the Screen Reader
# Verify that the AT-SPI bus was enabled:
 <pre>
gdbus call --session -d org.a11y.Bus -o /org/a11y/bus -m org.freedesktop.DBus.Properties.Get org.a11y.Status IsEnabled
</pre>

=== Test Color ===

# Open gnome-control-center (Settings app)
# Enable Night Light
# Configure start and end times so that it should enable now
# Verify that Night Light is active:
 <pre>
gdbus call --session -d org.gnome.SettingsDaemon.Color -o /org/gnome/SettingsDaemon/Color -m org.freedesktop.DBus.Properties.Get org.gnome.SettingsDaemon.Color NightLightActive
</pre>

Whether the screen actually changed color depends on other components; in case it did not, that should not count as a failure of this test case.

=== Test Housekeeping - Thumbnails ===

 1. Set the thumbnails cache age to zero:
 <pre>
gsettings set org.gnome.desktop.thumbnail-cache maximum-age 0
</pre>
# Log-out and log-in (or reboot and log-in)
# Wait at least 2 minutes
# Verify that the thumbnails cache is empty:
 <pre>
find ~/.cache/thumbnails -type f
</pre>
 1. Restore the default cache age
 <pre>
gsettings reset org.gnome.desktop.thumbnail-cache maximum-age
</pre>

=== Test Housekeeping - Trash ===

# Move some files to the trash bin
# Run:
 <pre>
gdbus call --session -d org.gnome.SettingsDaemon.Housekeeping -o /org/gnome/SettingsDaemon/Housekeeping -m org.gnome.SettingsDaemon.Housekeeping.EmptyTrash
</pre>
 1. Verify that the trash bin is empty

=== Test Media Keys ===

This test requires a keyboard with media control keys

# Verify that the Volume Up/Down and Mute keys modify the volume
# Start a media player, for example YouTube within Firefox
# Verify that the Play/Pause/Next/etc... keys work as expected.

=== Test Power - Idle Suspend ===

This test requires a machine with suspend support.

# Enable Automatic Suspend
# Configure a low sleep timeout for the test:
 <pre>
gsettings set org.gnome.settings-daemon.plugins.power sleep-inactive-battery-timeout 30
</pre>
# Wait 30 seconds
# Verify that you saw a notification: "Suspending soon because of inactivity."
# Verify that the machine went to sleep
# Reset the default sleep timeout
 <pre>
gsettings reset org.gnome.settings-daemon.plugins.power sleep-inactive-battery-timeout
</pre>

=== Test Power - Lid ===

This test requires a laptop with a sensor detecting when the lid is closed.

 1. Inhibit suspend:
 <pre>
systemd-inhibit --what=handle-lid-switch gnome-session-inhibit --inhibit suspend sleep 60
</pre>
# Close the laptop lid
# Verify that the session was locked.

=== Test Power - Backlight ===

This test requires a laptop with supported screen backlight controls.

# Open the Quick Settings menu at the top-right of GNOME
# Verify that there is a brightness slider
# Verify that moving the slider adjusts the screen brightness

=== Teset Rfkill ===

# Open the Quick Settings menu at the top-right of GNOME
# Enable Airplane Mode
# Verify that Wifi and Bluetooth got turned off

=== Test ScreensaverProxy ===

 1. Run:
 <pre>
gdbus call --session -d org.freedesktop.ScreenSaver -o /org/freedesktop/ScreenSaver -m org.freedesktop.ScreenSaver.Inhibit "foo" "bar"
</pre>
 1. Verify that the command returned a number

 The session will be automatically uninhibited as soon as the gdbus command exits.

=== Test Sharing ===

 This test requires that the `rygel` package is installed

# Connect to a secure network
# Run:
 <pre>
gdbus call --session -d org.gnome.SettingsDaemon.Sharing -o /org/gnome/SettingsDaemon/Sharing -m org.freedesktop.DBus.Properties.Get org.gnome.SettingsDaemon.Sharing CurrentNetwork
</pre>
# Verify that the command returned a non-empty identifier
# Run:
 <pre>
gdbus call --session -d org.gnome.SettingsDaemon.Sharing -o /org/gnome/SettingsDaemon/Sharing -m org.freedesktop.DBus.Properties.Get org.gnome.SettingsDaemon.Sharing SharingStatus
</pre>
# Verify that the command returned the number "3", meaning "sharing is available"
# Disconnect from the network
# Verify that the same command now returns "0"

=== Smartcard ===

This test would require a smartcard and a system configured for log-in with the smartcard.
Instead, we're just going to verify that the service is running and can perform a basic query.

# Log-in without a smartcard.
# Run:
 <pre>
gdbus call --session -d org.gnome.SettingsDaemon.Smartcard -o /org/gnome/SettingsDaemon/Smartcard/Manager -m org.gnome.SettingsDaemon.Smartcard.Manager.GetLoginToken
</pre>
 1. Verify that the command returned:
 <pre>
Error: GDBus.Error:org.gnome.SettingsDaemon.Smartcard.Manager.Error.FindingSmartcard: User was not logged in with smartcard.
</pre>

=== Test XSettings ===

 1. Verify that the a11y bus is available to X11 apps:
 <pre>
xprop -root AT_SPI_BUS
</pre>

----
CategoryDesktopTestPlans
