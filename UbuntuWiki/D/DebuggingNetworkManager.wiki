{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

Available languages: <nowiki>[[https://wiki.ubuntu.com/DebuggingNetworkManager_it| Italiano]]</nowiki>,

== Bug Summary ==

If a network-manager bug report is about not being able to connect the title or summary should be in the format:

"[CHIPSET] cannot connect to (ENCRYPT_METHOD)"

where the CHIPSET is the wireless driver used and ENCRYPT_METHOD is the encryption method used by your wireless network.

== Understanding your bug and getting more information ==

* There is a lot of debugging information available on the GNOME Live wiki: <nowiki>[[https://wiki.gnome.org/Projects/NetworkManager/Debugging|NetworkManager/Debugging]]</nowiki>.
* You can also take a look at <nowiki>[[http://live.gnome.org/DarrenAlbers/NetworkManagerFAQ|Darren Albers' FAQ]]</nowiki>.
* There is additional information on DebuggingNetworkManager/ReasonCodes for disconnection and network changes available.

== Getting debug logs ==

You can then follow developers' intructions on a bug report for the exact command line to use; or run it directly as such.

=== Getting NetworkManager debug logs ===

By default, the NetworkManager log level is set to info. You can use nmcli to modify the logging level:

<pre>
$ sudo nmcli general logging level DEBUG domains ALL
</pre>

You do not need to restart NetworkManager to begin seeing debug messages logged to journalctl. You can watch the NetworkManager logs:

<pre>
$ sudo journalctl -f -u NetworkManager
</pre>

=== Getting ModemManager debug logs ===

Manually run with debug enabled:

<pre>
$ sudo /usr/sbin/ModemManager --debug
$ sudo /usr/sbin/NetworkManager --debug --log-level=DEBUG
</pre>

See also <nowiki>[[https://modemmanager.org/docs/modemmanager/debugging/|DebuggingModemmanager]]</nowiki>.

You do not need to restart ModemManager to begin seeing debug messages logged to journalctl. You can watch the ModemManager logs:

<pre>
$ sudo journalctl -f -u ModemManager
</pre>

=== Getting wpasupplicant debug logs ===

Change the log level:
<pre>
$ sudo wpa_cli log_level debug
</pre>

You do not need to restart wpa_supplicant to begin seeing debug messages logged to journalctl. You can watch the wpa_supplicant logs:

<pre>
$ sudo journalctl -f -u wpa_supplicant
</pre>

=== Getting a capture of syslog ===

Mixing and mashing the above is perfectly acceptable as well if you want to see how NetworkManager and other parts of the stack interact together.

In order to understand whats going on and track down issues, its good to have a full log. To do so, capture the complete test case and submit the whole file (don't cut out what you think is important). Please add markers in the log file so the bug triager can easily see what actions the user takes at what point of time (this isn't essential, but helps a lot).

To capture the syslog, do:
<pre>
$ tail -n0 -f /var/log/syslog > /tmp/syslog
</pre> and to stop capturing do Ctrl-C (you will have to type your other commands in an other window or tab)

Adding markers is just like adding new lines with an editor that show the triager what happened at what point of time. You can also do this on the fly as you test with the command <code>logger "[ clicked on wireless network 'ubuntu']" </code>.

Example marker:
<pre>
Sep  6 08:12:30 ...

[ clicked on wireless network 'ubuntu']

Sep  6 08:12:31 ...
...
</pre>

=== Handling 3G / modem issues ===

Here are a few extra things that are very helpful to add in case of issues with 3G.

The output of udevadm for tty devices, and output of lsusb:

<pre>
$ udevadm info --query=all --path=/sys/class/tty/... --attribute-walk
</pre>

<pre>
$ lsusb
</pre>

=== Captive portal ===

You can check the status from the cli using:
<pre>
$ nmcli networking connectivity check
</pre>

Since 1.38, you can set Environment=NM_LOG_CONCHECK=1 in NetworkManager.service and restart the service to get additional debug logging about connectivity checking.

== A Testcase ==

A good testcase is a step by step instruction to reproduce your bug starting with driver unloaded and NetworkManager stopped.

First, stop NetworkManager and unload your driver:
<pre>
$ sudo systemctl stop NetworkManager
$ sudo modprobe -r DRIVER
</pre>

Next, load the driver and start NetworkManager:
<pre>
$ sudo modprobe DRIVER
$ sudo systemctl start NetworkManager
</pre>

== Netplan ==

A configuration abstraction mechanism has added to NetworkManager as of Ubuntu 23.10, called Netplan. There is a whole <nowiki>[[https://netplan.readthedocs.io/en/stable/|library of netplan documentation]]</nowiki> available. However here is a very basic amount of netplan debugging.

Netplan uses the files in /etc/netplan/*.yaml to generate the running profiles you find at /run/NetworkManager/system-connections/*.nmconnection. If you suspect a feature defined in your /etc/netplan/*.yaml files is not being used, it is a good idea to check that the content matches up. 

If you find a netplan bug, please report it here: https://bugs.launchpad.net/netplan/+filebug
