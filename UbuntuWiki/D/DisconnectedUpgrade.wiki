{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__


* '''Launchpad Entry''': UbuntuSpec:other-foundations-n-disconnected-upgrade
* '''Created''': 24 April 2009
* '''Contributors''': StefanoRivera
* '''Packages affected''': update-manager, msttcorefonts, flashplugin-nonfree

=== Summary ===

Allow users to upgrade Ubuntu releases without necessarily being able to contact http://changelogs.ubuntu.com/. In many environments (offline / firewalled / restricted) that isn't possible, but local mirrors may be available nonetheless.

=== Release Note ===

Todo

=== Rationale ===

At the moment, an Ubuntu system can only be (release) upgraded by using apt (advanced user) or the upgrade-manager (GUI / CLI). The upgrade-manager depends on a file hosted on changelogs.ubuntu.com called meta-release, to determine whether an upgrade is possible and locate the upgrade tool tarball.

This blueprint proposes that these files get moved onto normal mirrors so that a disconnected system with a complete mirror available (quite common in the developing world and corporate environments) can upgrade in a user-friendly manner.

==== tumbleweed's story ====

Sorry, I couldn't be at UDS so here's why I called this:

My University has a nasty firewall and forces all port 80 to go via an 
NTLM-authenticating proxy, so we have to use hacks like cntlm and transparent
proxying + cntlm + University proxies, etc.

This is (unfortunately) not an unusual situation in the corporate world. It's 
just a pity my university is so closed-minded, and I'll be getting out of there
ASAP.

Many users with poor connectivity at home, mirror to a big hard drive at work 
and take thier mirror home.

This is all very nice for an advanced user like me, but we have a fair number 
of !poweruser Ubuntu users on campus. They complain that they can't upgrade
their machines, even though we have a local mirror.

Things we do mitigate this:

1. We mirror (and mangle) the meta-release files from changelogs.ubuntu.com, and <nowiki>[[http://www.leg.uct.ac.za/mirrors/linux/ubuntu | tell users ]]</nowiki> to configure their machines to use them. This is non-optimal.

2. Our mirror has a virtualhost for changelogs.ubuntu.com so that users can do  <code>http_proxy=http://our.mirror/ update-manager</code> Also non-optimal.

3. Similar hacks for flashplugin and core fonts.

=== User stories ===

* Walter is a user on a <nowiki>[[http://www.webafrica.co.za/news/adsl_local.html|Local Only DSL Account]]</nowiki>. He has access to the national Ubuntu mirrors, but not Canonical in the UK. He can only upgrade with a CD or aptitude.
* Thembi is a student at University where http access is firewalled and all students are required to use an NTLM proxy for web access. There is a really fast local mirror, but she can only upgrade with a CD or aptitude as update-manager can't connect to http://changelogs.ubuntu.com/.
* Joe is at a big corporation with heavy firewall rules. As above...

=== Assumptions ===

There are many situations where users can access a mirror, but not http://changelogs.ubuntu.com/ and where access to the mirror is more reliable.

=== Design ===

Can we move meta-release et al. to the mirrors?
What would this require?

Can those meta-release files point at the download tool without an absolute 
URL? (i.e. it can be grabbed from the current mirror)

I suppose update-manager would possibly need to poke archive.ubuntu.com too, if 
we don't trust the mirror to be up to date?

=== Implementation ===

=== Test/Demo Plan ===

This can be tested with update-managers development update mode (-d), before the next Ubuntu version releases.

=== Unresolved issues ===

=== Other concerns ===
flashplugin and corefonts break offline upgrades. tumbleweed will see what can 
be done here.

Possibilities:

* Add a preseedable proxy setting to flashplugin
* Central config file for such packages?
* Use the same http proxy as apt
** Con: this could be some apt-proxy that doesn't like non-debs

=== BoF agenda and discussion ===

Todo

----
CategorySpec CategorySpec
