{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

=== Sommario ===

Se la segnalazione dell'anomalia è pertinente a network-manager che non può connettersi, il titolo deve essere in questo formato:

"[CHIPSET] non si connette a (ENCRYPT_METHOD)"

dove CHIPSET è il driver wireless usato e ENCRYPT_METHOD è il metodo di crittografia usato dalla vostra rete wireless.

=== Capire l'anomalia ed ottenere informazioni ===

* Molte informazioni per il debugging sono reperibili sul wiki GNOME Live: <nowiki>[[http://live.gnome.org/NetworkManager/Debugging|NetworkManager/Debugging]]</nowiki>.
* Potrebbe tornare utile guardare in <nowiki>[[http://live.gnome.org/DarrenAlbers/NetworkManagerFAQ|Darren Albers' FAQ]]</nowiki>.
* Informazioni aggiuntive inerenti disconnessioni o altre anomalie in DebuggingNetworkManager/ReasonCodes .
* Un codice reason/status similare ma valido per wpasupplicant è reperibile su: <nowiki>[[http://hostap.epitest.fi/gitweb/gitweb.cgi?p=hostap.git;a=blob;f=src/common/ieee802_11_defs.h|ieee802_11_defs.h]]</nowiki>

=== Ottenere informazioni per il debug ===

Innanzitutto, assicurarsi di avere lo script debug helper: <nowiki>[[http://cgit.freedesktop.org/NetworkManager/NetworkManager/plain/test/debug-helper.py| debug-helper.py]]</nowiki>.

Scaricabile anche con il comando:

<pre>
wget http://cgit.freedesktop.org/NetworkManager/NetworkManager/plain/test/debug-helper.py
</pre>

Sarà così possibile seguire le istruzioni dello sviluppatore nella segnalazione sull'opportuna linea di comando da usare; oppure eseguirlo direttamente come:

==== Ottenere file di debug da NetworkManager ====

<pre>
sudo python debug-helper.py --nm debug
</pre>

Il file generato sarà scritto in /var/log/syslog. Per disabilitarlo, passare '''info''' invece di '''debug''' nel precedente comando, o riavviare.

==== Ottenere file di debug da ModemManager ====

<pre>
sudo python debug-helper.py --mm debug
</pre>

Il file generato sarà scritto in /var/log/syslog. Per disabilitarlo, passare '''info''' invece di '''debug''' nel precedente comando, o riavviare.

Vedere anche <nowiki>[[DebuggingModemmanager_it]]</nowiki>.

==== Ottenere file di debug da wpasupplicant ====

<pre>
sudo python debug-helper.py --wpa msgdump
</pre>

Il file generato sarà scritto in /var/log/syslog. Per disabilitarlo, passare '''info''' invece di '''debug''' nel precedente comando, o riavviare.

==== Catturare un syslog ====

Mischiando quanto sopra è perfettamente accettabile se si vuole vedere come NetworkManager ed altre parti dello stack interaginscono insieme.

Ma per tracciare ed analizzare una anomalia, si ha la necesssità di avere un file di log completo. Per fare ciò catturare un test case completo ed allegarlo alla segnalazione (per cortesia evitate di tagliare...). Se possibile aggiungere dei marcatori, così il triager potrà vedere quali azioni avete fatto e in quale momento (non è essenziale ma aiuta molto).

Per catturare il syslog:
<pre>
 tail -n0 -f /var/log/syslog > /tmp/syslog
</pre> per fermarlo premere Ctrl-C (sarà necessario aprire un 'altra finestra se si devono eseguire altri comandi).

Aggiungere dei marcatori è come aggiungere nuove linee con un editor di testo che indicano al triager cosa succede ed in quale momento. Potete farlo anche `al volo` mentre testate con il comando <code>logger "[ clicked on wireless network 'ubuntu']" </code>.

Esempio di marcatore:
<pre>
Sep  6 08:12:30 ...

[ clicked on wireless network 'ubuntu']

Sep  6 08:12:31 ...
...
</pre>

==== Gestione problemi 3G / modem ====

Una piccola cosa da aggiungere, ma molto utile, nel caso di problemi con 3G:

L'output di udevadm per tty devices, e l'output di lsusb:

<pre>
$ udevadm info --query=all --path=/sys/class/tty/... --attribute-walk
</pre>

<pre>
$ lsusb
</pre>

=== Un Testcase ===

Un buon testcase è un elenco passo passo di istruzioni per poter riprodure il bug partendo dal driver `scaricato` e NetworkManager `fermato`.

Fermare NetworkManager

<pre>
  sudo stop network-manager
</pre>

Per scaricare il driver <code> sudo modprobe -r DRIVER </code>.

Quindi ricaricare il driver <code> sudo modprobe DRIVER </code> ed avviare NetworkManager:

<pre>
  sudo start network-manager
</pre>

=== Debugging del crash ===

Per installare i simboli di debug, aggiungere le seguenti linee al vostro <code>/etc/apt/sources.list</code>

<pre>
deb http://ddebs.ubuntu.com/ precise main universe
</pre>

o

<pre>
deb http://ddebs.ubuntu.com/ oneiric main universe
</pre>

Quindi installare gli appropriati pacchetti dbgsym:

<pre>
  sudo apt-get update
  sudo apt-get install network-manager-dbgsym libnm-util2-dbgsym libnm-glib4-dbgsym libglib2.0-0-dbgsym
</pre>

Fermare quindi NetworkManager:
<pre>
sudo stop network-manager
</pre>

Eseguire NetworkManager in un debugger
<pre>
sudo gdb /usr/sbin/NetworkManager
...
(gdb) run --no-daemon
</pre>

Quando avviene il crash ottenere la backtrace
<pre>
(gdb) bt
...
(gdb) bt full
...
(gdb) thread apply all bt full
...
</pre>

ed allegare la backtrace insieme a <code>/var/log/syslog</code> alla segnalazione.

=== Bug Tags ===

Qesti tags consentono di isolare i bug in piccoli sottogruppi, fornendo un semplice e veloce metodo per lavorare a specifici problemi.

{| class="wikitable"
|-
| <rowbgcolor="#FFEBBB"> '''Tag'''
| '''caso d'uso'''
|-
| <nowiki>[[https://launchpad.net/ubuntu/+bugs?field.tag=driver-madwifi|`driver-madwifi`]]</nowiki>
| Bugs dove viene usato il driver madwifi
|-
| <nowiki>[[https://launchpad.net/ubuntu/+bugs?field.tag=driver-ndiswrapper|`driver-ndiswrapper`]]</nowiki>
| Bugs dove viene usato il driver ndiswrapper
|-
| <nowiki>[[https://launchpad.net/ubuntu/+bugs?field.tag=vpn|`vpn`]]</nowiki>
| Bug relativi ai moduli vpn di network-manager: openvpn, vpnc o pptp
|-
| <nowiki>[[https://launchpad.net/ubuntu/+bugs?field.tag=encryption-wep|`encryption-wep`]]</nowiki>
| Bug dove viene usata la crittografia WEP
|-
| <nowiki>[[https://launchpad.net/ubuntu/+bugs?field.tag=encryption-wpa|`encryption-wpa`]]</nowiki>
| Bug dove viene usata la crittografia WPA
|-
| <nowiki>[[https://launchpad.net/ubuntu/+bugs?field.tag=encryption-wpa2|`encryption-wpa2`]]</nowiki>
| Bug dove viene usata la crittografia WPA2
|}

I sopradescritti tag sono specifici dell'applicazione <nowiki>[[NetworkManager]]</nowiki>, per dei tag più generici, consultare la pagina <nowiki>[[Bugs-Tags]]</nowiki>.

=== Testare una patch ===

È sempre una buona idea controllare in <nowiki>[[https://edge.launchpad.net/~network-manager/+archive/trunk|NM trunk PPA]]</nowiki> per vedere se una nuova versione di NetworkManager fixa il bug che state sperimentando. Vi preghiamo di essere cauti, dato che questi sono rilasci giornalieri che potrebbero influenzare altre cose e sono da considerarsi instabili.

Talvolta lo sviluppatore potrebbe richiedere di provare una patch. Procedere come segue se il bug riguarda network-manager, altrimenti se riguarda network-manager-applet o qualche altro pacchetto, semplicemente sostituire il nome

Vedere <nowiki>[[DebuggingModemmanager_it]]</nowiki> per le stesse istruzioni per Modemmanager.

<pre>
sudo apt-get install build-essential fakeroot devscripts
sudo apt-get build-dep network-manager

sudo apt-get source network-manager

cd network-manager-*/

patch -p1 < /tmp/yourdownloadedpatch.diff

debuild -b -uc

cd ../

sudo dpkg -i network-manager*.deb libnm-*.deb
</pre>

Nota che non si deve cambiare la versione del pacchetto. Così per ritornare alla versione uff basterà eseguire:
<pre>
  sudo apt-get install --reinstall network-manager libnm-util2 libnm-glib4
</pre>

Se durante il build avete installato altri pacchetti, fate lo stesso anche per questi ultimi.

----
CategoryBugSquad
