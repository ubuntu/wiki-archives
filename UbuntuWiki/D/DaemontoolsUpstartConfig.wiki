{|
  | '''Warning'''
  * This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
  * '''Images''' and '''attachments''' have been removed to conserve space.
  * '''Links''' may not work and there may be formatting issues.
  * A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__


=== Summary ===

For those of you who have installed and attempted to get <nowiki>[[http://cr.yp.to/djb.html|DJB's]]</nowiki> <nowiki>[[http://cr.yp.to/daemontools.html|daemontools]]</nowiki> (as is required for djbdns/dnscache) running on EdgyEft or later, you may have noticed (at least as of 2006-10-28) that despite svscanboot being added to the end of /etc/inittab (<code>SV:123456:respawn:/command/svscanboot</code>) and sending init a SIGHUP, that it's still not running as expected.  The reason is that <code>sysvinit</code> has been replaced with <nowiki>[[http://upstart.ubuntu.com/|Upstart]]</nowiki>.  What follows is a fix which works for many.

=== The Fix - Edgy ===

* create/edit the daemontools startup file:

$ sudo vi /etc/event.d/svscanboot</pre>

* put the contents of the following in <code>svscanboot</code>:

<pre>

start on runlevel-1
start on runlevel-2
start on runlevel-3
start on runlevel-4
start on runlevel-5
start on runlevel-6

stop on shutdown

respawn
exec /command/svscanboot
</pre>

=== The Fix - Feisty ===

The format of upstart event.d files changed between the Edgy and Feisty releases. The following code works on Feisty with an FHS style install. Place it in a new file in `/etc/event.d/`. E.g, `/etc/event.d/local-svscan`.

<pre>

start on runlevel 2
start on runlevel 3
start on runlevel 4
start on runlevel 5

stop on shutdown

respawn
exec /usr/bin/svscanboot
</pre>

DJB style installs (most likely) will use the following `exec` command:
<pre>
exec /command/svscanboot
</pre>

=== Validate ===

* check <code>svscanboot</code>:

<pre>
$ sudo status svscanboot
svscanboot (stop) waiting
</pre>

* start <code>svscanboot</code>:

<pre>
$ sudo start svscanboot
svscanboot (start) waiting
svscanboot (start) starting
svscanboot (start) pre-start
svscanboot (start) spawned, process 663
svscanboot (start) post-start, (main) process 663
svscanboot (start) running, process 663
</pre>

* check the status (this is a bit redundant given the above result) - you should see something like this:

<pre>
$ sudo status svscanboot
svscanboot (start) running, process 663
</pre>

* check with <code>svstat</code>, eg, with dnscache:

<pre>
$ sudo svstat /service/dnscache
/service/dnscache: up (pid 670) 621 seconds
</pre>

=== Caveats ===

* As Upstart is completely new to me, I've discovered that trying to shut down svscanboot with <code>sudo stop svscanboot</code> isn't such a great idea, as it leaves various processes around, such as <code>supervise</code>.  That said, I don't believe that DJB ever intended for this subsystem to be stopped.  There could be a better way of writing the above config file.

* The standard (manual) installation of daemontools (at least in Hardy), when adding the (never called) svscanboot line to <code>/etc/local</code> changes the mode of this file and it  no longer is executable. Standard ubuntu installations don't have anything in <code>/etc/rc.local</code>, but you may have added something in there (as I did) and ubuntu won't run it. In order to fix this, after installing daemontools you should do the following:
<pre>
sudo chmod +x /etc/rc.local
</pre>
