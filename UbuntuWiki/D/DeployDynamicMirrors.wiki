{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__


''Please check the status of this specification in Launchpad before editing it.  If it is Approved, contact the Assignee or another knowledgeable person before making changes.''

* '''Launchpad Entry''': UbuntuSpec:deploy-dynamic-mirrors
* '''Packages affected''': apt, launchpad

=== Summary ===

To spread the mirror load more evenly a new method in apt was
developed. This spec describes what must be done to deploy this new
method as default.

=== Release Note ===

TBD

=== Rationale ===

The mirror configuration is currently pretty static. It can either be
dns based or static in the users sources.list. A more dynamic approach
is needed to be able to deal with mirror changes quicker and to
distribute the mirror load better.

=== Design ===

The new apt mirror method works by asking a server for a set of fast
closeby mirrors. The current location for this is on launchpad is
http://launchpad.net/ubuntu/+countrymirrors-archive

Apt uses one of those mirrors then for fetching files. It will only
update the mirror information if apt-get update is called and it
additinally caches them to avoid hitting the central server too hard.

To enable the new apt mirror methods as default we need to take the
following steps:
# change apt-setup to write mirror:// urls instead of http:// urls it does no longer need to write any mirror info itself
# change the apt mirror methods to only update the mirror information only if apt sends  send IndexFile=True to the  methods (to ensure that Packages information is always in sync with the mirror that is downloaded from) [done]
# Ensure that the cached mirror information is used if the main mirror is not reachable (this should be the case but needs to be tested).

=== Test/Demo Plan ===

TBD

=== Outstanding issues ===

Launchpad needs to be optimized so that the load from the users asking
for mirorr information can be handled. Salgado was confident that this
is possible with server side caching.

----
CategorySpec
