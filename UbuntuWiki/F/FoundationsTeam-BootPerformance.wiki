{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__


~+With this being a feature spanning multiple releases, we thought it best to have a single point of reference for all the work we are doing and plan to do in the future.+~

=== Rationale ===
~-(*pulled from <nowiki>[[..-Specs-BootPerformance|-FoundationsTeam-Specs-BootPerformance]]</nowiki>)-~ <<BR>>
As time has passed, the boot performance of home computers has steadily worsened; it is no longer unusual for a desktop operating system to take well over a minute to be ready from the time the user first presses the power button.

While this has been somewhat acceptable for desktops, where the user at least expects it to take a long time, increased focus on smaller and more mobile devices means that something needs to be done.

For a netbook or mobile device to be truly useful as a convenient, lightweight, computing platform; the boot must take as little time as possible so that the system is immediately useful for the user. Any longer, and they may as well use their desktop or full laptop.

==== Why is This Important? ====
~-(*taken from Scott James Remnant's '''<nowiki>[[attachment:Fast Boot.odp|UDS Karmic Presentation]]</nowiki>''')-~ <<BR>>
The question can still be made, "But why is boot speed so important? That is, why should we invest time and effort in this?" There are multiple reasons for doing so:
# '''Engineering Excellence''' - Fast boot means you have a light and lean OS, which means reduced overheads for the system, better for Live CD, mobile, etc.
# '''Netbooks''' - Boot speed is important to OEMs when choosing which OS to pre-install on their netbooks. Faster boot means more netbook pre-installs, which can then lead us (Ubuntu) to ''laptop'' pre-installs.  In addition, since netbooks require a lighter platform, this allows for an easier transition to Mobile devices, if ever needed in the future.
# '''Competitive Advantage''' - In the past, a certain "other" OS always seemed to require more CPU power for each new release.  This has obviously not been a good thing for users, and thus the maker of this OS has now recently touted improved boot speed as a reason for switching...we must be as fast, if not faster, to support our point of Linux being the better OS.
# '''Suspend/Resume is Not the Answer''' - Yes, a fast suspend/resume cycle is extremely useful, not to mention very cool ;) , but sometimes you can't suspend. For example:
** on airplanes, where your laptop is supposed to be '''OFF''' during takeoff, not asleep...and not with wifi/bluetooth turned off. 
** when testing or developing for the OS, where sometimes you simply have to reboot to recover from a crash, test a new kernel, etc.
# '''Cloud Computing''' - Fast boot is important for the cloud. When you're paying for uptime, you don't want to be waiting for your cloud instance(s) to boot (and paying for it!).  
# '''Data Centers''' - Fast reboots in the data center mean less downtime, even with a backup, that's less time worrying about something else going wrong.

=== Use Cases ===
~-(*pulled from <nowiki>[[..-Specs-BootPerformance|-FoundationsTeam-Specs-BootPerformance]]</nowiki>)-~ <<BR>>
*** It should be possible to power off desktops and work stations over night, to conserve power and energy. Lost time in the morning to switch them back on is undesirable.
*** Laptop users want to use their computer as soon as possible without waiting, even though the hardware is lower powered and slower, it should boot quickly.
*** Netbooks are marketed to be convenient and portable Internet and computing devices. They must not take any significant time to boot, otherwise it becomes more likely the owner will simply use their desktop computer instead.
*** For Ubuntu to be suitable for mobile devices such as cell phones, it must boot quickly to give the "instant on" experience most commonly expected with such commodity devices. 

=== Plans for Jaunty (9.04) ===
Our approach for this release is to look at what we have, profile and chart it, and identify areas for improvement. We will iterate over this process steadily reducing the time it takes for the system to boot. Our goal for this release is to have a fully functional system, i.e. no sneaky backgrounding to make it "appear" booted, up and running in 25sec (or less).  Our reference platform is the <nowiki>[[http://www.dell.com/mini|Dell Mini 9]]</nowiki>, as it has the <nowiki>[[http://www.intel.com/technology/atom/|Intel Atom]]</nowiki> processor and an Solid State Drive (SSD) disk, so makes an excellent benchmark for the Netbook form factor. 

==== 9.04 Detailed Changes ====
~-'''*In No Particular Order'''-~
{| class="wikitable"
|-
| '''DESCRIPTION'''
| '''STATUS'''
|-
| Update the <nowiki>[[http://wiki.ubuntu.com/KernelTeam/Specs/BootPerformance#Kernel Config Changes|kernel config]]</nowiki> to improve performance
| '''Done'''
|-
| Optimize the boot up process by parallelizing events where possible
| '''Done'''
|-
| Fix seahorse agent timeout
| '''Done'''
|-
| Investigate why udevadm is taking too long, and improve where possible
| '''Done'''
|-
| Reduce the startup time for compiz
| '''Done'''. See the associated <nowiki>[[https://bugs.launchpad.net/ubuntu/+source/compiz/+bug/337851|Feature Freeze Exception]]</nowiki>
|-
| Apply Xserver performance patches found in Moblin image, if applicable
| '''Deferred to Karmic'''. By the time we got them, it was too risky to implement in the release, as a lot of the changes were kernel related and rejected by upstream as either being untested on non-Intel graphic chipsets or being too netbook specific. See associated <nowiki>[[https://bugs.edge.launchpad.net/ubuntu/+bug/338811|Feature Freeze Exception]]</nowiki>
|-
| Mode-switches and console changes are known to be expensive, in addition they create the intermediate VTs, so start usplash and X on tty1
| '''Deferred to Karmic'''.
|-
| Figure out why we set the hardware clock several different times from different places and fix where possible
| '''Done'''
|-
| Change the nm-applet connecting animation to something that doesn't adversely affect performance
| '''Deferred to Karmic'''.
|-
| Add new and faster module-init-tools upload that uses binary indexes
| '''Done'''. See the associated <nowiki>[[https://bugs.edge.launchpad.net/ubuntu/+source/module-init-tools/+bug/338804| Feature Freeze Exception]]</nowiki>
|-
| Set console font, keymap and utf-8 mode from udev while usplash is running
| '''Deferred to Karmic'''. See associated <nowiki>[[https://bugs.launchpad.net/ubuntu/+bug/338808|Feature Freeze Exception]]</nowiki>
|-
| ''Update X to save the results of xkbcomp rather than regenerating every single time the server is started''
| '''Didn't improve performance...or work.''' ;) See associated <nowiki>[[https://bugs.edge.launchpad.net/ubuntu/+source/xorg-server/+bug/338813|Feature Freeze Exception]]</nowiki>
|-
| Eliminate various calls to modprobe in initramfs and initscripts where they're not needed
| '''Done'''. See associated <nowiki>[[https://bugs.launchpad.net/ubuntu/+source/initramfs-tools/+bug/338806|Feature Freeze Exception]]</nowiki>
|-
| Move some scripts out of rcS and into rc1-5 so they can run while X is up
| '''Done'''. See associated <nowiki>[[https://bugs.edge.launchpad.net/ubuntu/+bug/338815|Feature Freeze Exception]]</nowiki>
|-
| Eliminate some unnecessary init scripts (ie. wacom, powernowd)
| '''Done'''. See associated <nowiki>[[https://bugs.edge.launchpad.net/ubuntu/+bug/338818|Feature Freeze Exception]]</nowiki>
|-
| Fix the hostname tool so an init script is not needed
| '''Deferred to Karmic'''. See associated <nowiki>[[https://bugs.edge.launchpad.net/ubuntu/+source/util-linux/+bug/338820|Feature Freeze Exception ]]</nowiki>
|-
| Move from readahead-list to sreadahead
| '''Done''' See associated <nowiki>[[https://bugs.edge.launchpad.net/ubuntu/+source/readahead-list/+bug/338823|Feature Freeze Exception]]</nowiki>. We need resolve an outstanding issue with sreadhead '''''reducing''''' performance on machines with rotary disks (See associated <nowiki>[[https://bugs.edge.launchpad.net/ubuntu/+source/sreadahead/+bug/338822|Feature Freeze Exception]]</nowiki>.  Until this is resolved, we '''will not''' use sreadahead by default.
|-
| Identify any bottlenecks in the gnome login that we can fix
| '''Done'''. See associated <nowiki>[[https://bugs.edge.launchpad.net/ubuntu/+bug/338816|Feature Freeze Exception]]</nowiki>
|-
| Look at some patches from SuSE that speed up gconf and gnome-settings-daemon
| '''Deferred to Karmic'''.
|}
==== 9.04 Bootcharts ====
This section will be updated to show our progress towards our goal of 25sec (or less) for Jaunty on a Dell Mini 9. For reference, we will compare our results to the performance of the latest Moblin v2 development release on a Dell Mini 9.  It should be noted that while the boot time is much faster, the current Moblin development image is much more hardware specific than a standard Ubuntu Desktop image, and does not provide certain functionality needed for a Dell Mini 9 netbook, e.g. the wireless adapter is not supported, keyboard mapping not fully functional, etc. <<BR>>
<<BR>>

===== Jaunty =====
* ~+<nowiki>[[attachment:black-jaunty-20090310-4.png|25sec]]</nowiki>+~ (using compiz)<<BR>>
* <nowiki>[[attachment:06-jaunty-20090218_25s.png|25sec]]</nowiki>: Includes previous changes with additional improvements, '''using metacity'''.
* <nowiki>[[attachment:05-jaunty+mit+seahorse+metacity_30s.png|30 sec]]</nowiki>: Includes previous with seahorse fix, and metacity
* <nowiki>[[attachment:04-jaunty+mit_45s.png|40 sec]]</nowiki>: Includes previous with new module-init-tools
* <nowiki>[[attachment:03-jaunty_56s.png|56 sec]]</nowiki>: Jaunty
* <nowiki>[[attachment:02-intrepid+jaunty_61s.png|61 sec]]</nowiki>: Intrepid with Jaunty Kernel
* <nowiki>[[attachment:01-intrepid_65s.png|65 sec]]</nowiki>: Intrepid

===== Additional Charts =====
* <nowiki>[[attachment:command-jaunty-20090311-2.png|30 sec]]</nowiki>: HP Mini 1000, SSD, jaunty alpha 6
* <nowiki>[[attachment:conquer-jaunty-20090311-1.png|46 sec]]</nowiki>: HP Mini 1000, HDD, jaunty alpha 6
* <nowiki>[[http://moblin.org/|MoblinV2]]</nowiki>: <nowiki>[[attachment:moblin_12s.png|12sec]]</nowiki> - Alpha2
* <nowiki>[[attachment:moblin_08s.png|8sec]]</nowiki> - Alpha

=== Plans for Karmic (9.10) ===
==== 9.10 Detailed Changes ====
{| class="wikitable"
|-
| '''DESCRIPTION'''
| Status
|-
| Switch to rsyslogd as possible alternative to using syslogd and klogd
| '''Done''': Alpha 3
|-
| Convert to Upstart where possible to allow for easier customization around boot performance for UNR and OEMs
| '''Done''': Alpha 6
|-
| Leverage Kernel Mode Switching (KMS) as a way to improve the performance of graphics bring up
| '''Done'''
|-
| Move to .30+ kernel for fastboot improvements
| '''Done'''
|-
| Goto compiling kernel for i586/i686 arch support
| '''Done'''. No improvement over current compilation options used.
|-
| Apply Xserver performance patches found in Moblin image, if applicable
| Deferred from Jaunty. See associated <nowiki>[[https://bugs.edge.launchpad.net/ubuntu/+bug/338811|Feature Freeze Exception]]</nowiki>
|-
| Set console font, keymap and utf-8 mode from udev while usplash is running
| Deferred from Jaunty. See associated <nowiki>[[https://bugs.launchpad.net/ubuntu/+bug/338808|Feature Freeze Exception]]</nowiki>
|-
| Fix the hostname tool so an init script is not needed
| Deferred from Jaunty. See associated <nowiki>[[https://bugs.edge.launchpad.net/ubuntu/+source/util-linux/+bug/338820|Feature Freeze Exception ]]</nowiki>
|-
| Mode-switches and console changes are known to be expensive, in addition they create the intermediate VTs, so start usplash and X on tty1
| '''Done'''. We switched to <nowiki>[[https://launchpad.net/xsplash|xsplash]]</nowiki>
|-
| Change the nm-applet connecting animation to something that doesn't adversely affect performance
| Not Needed
|-
| Look at some patches from SuSE that speed up gconf and gnome-settings-daemon
| Not needed
|}

==== 9.10 Bootcharts ====
This section will be updated to show our progress towards maximizing our performance for Karmic on a Dell Mini 9.<<BR>>
<<BR>>
===== Proof of Concept =====
<nowiki>[[attachment:Upstart-based Ubuntu_08.5s.png|8.5 secs]]</nowiki>
* This is a pure Upstart-based boot of Xubuntu, and not intended to represent a standard Ubuntu Desktop

===== Dell Mini 10v with HDD =====
* <nowiki>[[attachment:sam-karmic-20090727-5.png]]</nowiki> '''38s''' without Ubuntu One
* <nowiki>[[attachment:sam-karmic-20090727-4.png]]</nowiki> '''45s''' Karmic 2009-07-27
* <nowiki>[[attachment:sam-karmic-20090727-3.png]]</nowiki> '''43s''' Karmic Alpha 3 with sreadahead instead
** Even though it's not HDD-optimised, it's still a win!
* <nowiki>[[attachment:sam-karmic-20090727-2.png]]</nowiki> '''48s''' Karmic Alpha 3 after readahead profiling
* <nowiki>[[attachment:sam-karmic-20090727-1.png]]</nowiki> '''47.5s''' Karmic Alpha 3
** UbuntuOne adds lots of time :-(
* <nowiki>[[attachment:sam-karmic-20090717-2.png]]</nowiki> '''40s''' Karmic Alpha 2 after readahead profiling
** readahead always makes a small difference
* <nowiki>[[attachment:sam-karmic-20090717-1.png]]</nowiki> '''41s''' Karmic Alpha 2
** Karmic already showing a bit of improvement
* <nowiki>[[attachment:sam-jaunty-20090717-4.png]]</nowiki> '''45s''' Jaunty with updates after readahead profiling
* <nowiki>[[attachment:sam-jaunty-20090717-3.png]]</nowiki> '''45s''' Jaunty with updates
* <nowiki>[[attachment:sam-jaunty-20090717-2.png]]</nowiki> '''43s''' Jaunty release after readahead profiling
** so even our release readahead wasn't as good as re-profiling
* <nowiki>[[attachment:sam-jaunty-20090717-1.png]]</nowiki> '''45s''' Jaunty release

===== Dell Mini 10v with SDD =====
* <nowiki>[[attachment:max-karmic-20090727-5.png]]</nowiki> '''27.5s''' without Ubuntu One
* <nowiki>[[attachment:max-karmic-20090727-4.png]]</nowiki> '''31s''' Karmic 2009-07-27
* <nowiki>[[attachment:max-karmic-20090727-3.png]]</nowiki> '''31.5s''' Karmic Alpha 3 with sreadahead instead
* <nowiki>[[attachment:max-karmic-20090727-2.png]]</nowiki> '''32.5s''' Karmic Alpha 3 after readahead profiling
* <nowiki>[[attachment:max-karmic-20090727-1.png]]</nowiki> '''32.5s''' Karmic Alpha 3
** UbuntuOne adds lots of time :-(
* <nowiki>[[attachment:max-karmic-20090724-3.png]]</nowiki> '''29s''' Karmic Alpha 2 with sreadahead
** not quite a real test, since it involved updating the kernel and upstart, but...
* <nowiki>[[attachment:max-karmic-20090724-2.png]]</nowiki> '''30.5s''' Karmic Alpha 2 after readahead profiling
** actually makes it slower
* <nowiki>[[attachment:max-karmic-20090724-1.png]]</nowiki> '''29.5s''' Karmic Alpha 2
* <nowiki>[[attachment:max-jaunty-20090724-6.png]]</nowiki> '''31.5s''' Jaunty with updates and sreadahead
* <nowiki>[[attachment:max-jaunty-20090724-5.png]]</nowiki> '''31.5s''' Jaunty with updates after readahead profiling
* <nowiki>[[attachment:max-jaunty-20090724-4.png]]</nowiki> '''31.5s''' Jaunty with updates
* <nowiki>[[attachment:max-jaunty-20090724-3.png]]</nowiki> '''30s''' Jaunty release with sreadahead
** sreadahead makes a slight improvement again
* <nowiki>[[attachment:max-jaunty-20090724-2.png]]</nowiki> '''31s''' Jaunty release after readahead profiling
* <nowiki>[[attachment:max-jaunty-20090724-1.png]]</nowiki> '''32.5s''' Jaunty release

===== Dell Mini 9 =====
* 2009-09-18
** <nowiki>[[attachment:dellmini9-karmic-20090918-1.png]]</nowiki> '''28s''' to fully functional desktop
** Ignore the red line as this is '''not''' when xsplash terminates...only pauses here.
** system is usable and considered "booted" when 'xsplash' terminates.
* Karmic Beta+ (has additional updates post Beta release)
** <nowiki>[[attachment:login-karmic-20091016.png]]</nowiki> '''19s''' to login
** <nowiki>[[attachment:autologin-karmic-20091016.png]]</nowiki> '''28s''' to fully functional desktop
  
=== Plans for Lucid (10.04) ===
With our goal of switching to <nowiki>[[upstart]]</nowiki> in 9.10 met, we can now focus on achieving the '''10sec boot''' milestone we set for Lucid.  We will switch to a '''Dell Mini 10v with SSD''' as our reference platform and regularly report results on a daily basis. Time and bootchart results for both SSD and HDD storage will be posted.  If the kernel slips past it's 2 second allotment, a kernel bootgraph (example:<nowiki>[[attachment:bootgraph.pdf]]</nowiki>) will be included in the results.
==== Lucid Blueprints ====
* UbuntuSpec:kernel-lucid-boot-performance
* UbuntuSpec:foundations-lucid-pre-desktop-lucid-startup-speed
* UbuntuSpec:dx-karmic-gdm-greeter
* UbuntuSpec:desktop-lucid-startup-speed
* UbuntuSpec:dx-lucid-netbook-launcher-startup-speed

==== 10.04 Boot Budget ====
A target like 10s means we need a budget for each major component of the boot sequence:
{| class="wikitable"
|-
| '''Boot Component'''
| '''Budgeted Time'''
| '''Comments'''
|-
| <nowiki>[[Lucid-Kernel|Kernel]]</nowiki>
| 2s
| including initramfs
|-
| <nowiki>[[Lucid-Plumbing|Plumbing]]</nowiki>
| 2s
| driver loading, filesystem mounting, core services
|-
| <nowiki>[[Lucid-X|X]]</nowiki>
| 2s
| including gdm
|-
| <nowiki>[[Lucid-Desktop|Desktop]]</nowiki>
| 4s
| everything else
|}

==== Daily Boot Performance Data ====
http://people.canonical.com/~scott/daily-bootcharts/

=== Work with Debian ===
<nowiki>[[DebianUbuntuSprint|DebianUbuntuSprint]]</nowiki> - As usual, we are committed to working with the Debian community to provide patches across all the packages in main that would benefit from our work in this arena.  With this in mind we will investigate creating a joint Ubuntu-Debian team to look into what can be done.

