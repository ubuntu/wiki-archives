{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__


=== Introduction ===
AppArmor is a Mandatory Access Control (MAC) system which is a kernel (LSM) enhancement to confine programs to a limited set of resources. AppArmor's security model is to bind access control attributes to programs rather than to users. AppArmor confinement is provided via profiles loaded into the kernel, typically on boot. AppArmor profiles can be in one of two modes: enforcement and complain. Profiles loaded in enforcement mode will result in enforcement of the policy defined in the profile as well as reporting policy violation attempts (either via syslog or auditd). Profiles in complain mode will not enforce policy but instead report policy violation attempts.

AppArmor differs from some other MAC systems on Linux: it is path-based, it allows mixing of enforcement and complain mode profiles, it uses include files to ease development, and it has a far lower barrier to entry than other popular MAC systems.

AppArmor is an established technology first seen in Immunix and later integrated into Ubuntu, Novell/SUSE, and Mandriva. Core AppArmor functionality is in the mainline Linux kernel from 2.6.36 onwards; work is ongoing by AppArmor, Ubuntu and other developers to merge additional AppArmor functionality into the mainline kernel.

==== Example profile ====

From <code>/etc/apparmor.d/usr.sbin.tcpdump</code> on Ubuntu 9.04:

<pre>

/usr/sbin/tcpdump {
## include <abstractions/base>
## include <abstractions/nameservice>
## include <abstractions/user-tmp>

  capability net_raw,
  capability setuid,
  capability setgid,
  capability dac_override,
  network raw,
  network packet,

## for -D
  capability sys_module,
  @{PROC}/bus/usb/ r,
  @{PROC}/bus/usb/** r,

## for -F and -w
  audit deny @{HOME}/.* mrwkl,
  audit deny @{HOME}/.*/ rw,
  audit deny @{HOME}/.*/** mrwkl,
  audit deny @{HOME}/bin/ rw,
  audit deny @{HOME}/bin/** mrwkl,
  @{HOME}/ r,
  @{HOME}/** rw,

  /usr/sbin/tcpdump r,
}
</pre>

The above profile for tcpdump demonstrates several properties of AppArmor:

** profiles are simple text files
** comments are supported in the profile
** absolute paths as well as file globbing can be used when specifying file access
** various access controls for files are present. From the profile we see 'r' (read), 'w' (write), 'm' (memory map as executable), 'k' (file locking), and 'l' (creation hard links). There are others not demonstrated in this profile, including (but not limited to) 'ix' (execute and inherit this profile), 'Px' (execute under another profile, after cleaning the environment), and 'Ux' (execute unconfined, after cleaning the environment)
** access controls for capabilities are present
** access controls for networking are present
** specificity in rule matching, ie the most specific rule matches (eg access to `@{HOME}/bin/bad.sh` is denied with auditing due to '`audit deny @{HOME}/bin/** mrwkl,`' even though general access to `@{HOME}` is permitted with '`@{HOME}/** rw,`')
** include files are supported to ease development and simplify profiles (ie `#include <abstractions/base>`, `#include <abstractions/nameservice>`, `#include <abstractions/user-tmp>`)
** variables can be defined and manipulated outside the profile (`#include <tunables/global>` with `@{PROC}` and `@{HOME}`)
** AppArmor profiles are easy to read and audit 

Please see <nowiki>[[AppArmor#More%20information|More information]]</nowiki> below for full details on updating and developing profiles as well as instructions using AppArmor.

=== AppArmor in Ubuntu ===

AppArmor support was first introduced in Ubuntu 7.04, and is turned on by default in Ubuntu 7.10 and later. AppArmor confinement in Ubuntu is application specific with profiles available for specific binaries. With each release, <nowiki>[[SecurityTeam-KnowledgeBase-AppArmorProfiles|more and more profiles]]</nowiki> are shipped by default, with <nowiki>[[SecurityTeam-Roadmap#AppArmor Confinement|more planned]]</nowiki>.

If a profile is not available for an application, users may create a profile and add it to /etc/apparmor.d. If a profile is not defined for a particular binary, the binary is not confined. See <nowiki>[[AppArmor#More information|More information]]</nowiki> for details.

=== More information ===

** <nowiki>[[https://help.ubuntu.com/community/AppArmor|Ubuntu AppArmor Documentation]]</nowiki>
** <nowiki>[[https://wiki.ubuntu.com/Security/Features#apparmor|AppArmor Features]]</nowiki>
** <nowiki>[[https://ubuntu.com/server/docs/security-apparmor | Ubuntu Server Reference - AppArmor ]]</nowiki>
** Ubuntu 14.04 LTS (Trusty Tahr)
** <nowiki>[[https://manpages.ubuntu.com/manpages/trusty/en/man7/apparmor.7.html|apparmor man page]]</nowiki>
** <nowiki>[[https://manpages.ubuntu.com/manpages/trusty/en/man5/apparmor.d.5.html|apparmor.d man page]]</nowiki>
** Ubuntu 16.04 LTS (Xenial Xerus)
** <nowiki>[[https://manpages.ubuntu.com/manpages/xenial/en/man7/apparmor.7.html|apparmor man page]]</nowiki>
** <nowiki>[[https://manpages.ubuntu.com/manpages/xenial/en/man5/apparmor.d.5.html|apparmor.d man page]]</nowiki>
** Ubuntu 18.04 LTS (Bionic Beaver)
** <nowiki>[[https://manpages.ubuntu.com/manpages/bionic/en/man7/apparmor.7.html|apparmor man page]]</nowiki>
** <nowiki>[[https://manpages.ubuntu.com/manpages/bionic/en/man5/apparmor.d.5.html|apparmor.d man page]]</nowiki>
** Ubuntu 20.04 LTS (Focal Fossa)
** <nowiki>[[https://manpages.ubuntu.com/manpages/focal/en/man7/apparmor.7.html|apparmor man page]]</nowiki>
** <nowiki>[[https://manpages.ubuntu.com/manpages/focal/en/man5/apparmor.d.5.html|apparmor.d man page]]</nowiki>
** Ubuntu 22.04 LTS (Jammy Jellyfish)
** <nowiki>[[https://manpages.ubuntu.com/manpages/jammy/en/man7/apparmor.7.html|apparmor man page]]</nowiki>
** <nowiki>[[https://manpages.ubuntu.com/manpages/jammy/en/man5/apparmor.d.5.html|apparmor.d man page]]</nowiki>
** Ubuntu 24.04 LTS (Noble Numbat)
** <nowiki>[[https://manpages.ubuntu.com/manpages/noble/en/man7/apparmor.7.html|apparmor man page]]</nowiki>
** <nowiki>[[https://manpages.ubuntu.com/manpages/noble/en/man5/apparmor.d.5.html|apparmor.d man page]]</nowiki>
** Ubuntu 24.10 (Oracular Oriole)
** <nowiki>[[https://manpages.ubuntu.com/manpages/oracular/en/man7/apparmor.7.html|apparmor man page]]</nowiki>
** <nowiki>[[https://manpages.ubuntu.com/manpages/oracular/en/man5/apparmor.d.5.html|apparmor.d man page]]</nowiki>
** Ubuntu 25.04 (Plucky Puffin)
** <nowiki>[[https://manpages.ubuntu.com/manpages/plucky/en/man7/apparmor.7.html|apparmor man page]]</nowiki>
** <nowiki>[[https://manpages.ubuntu.com/manpages/plucky/en/man5/apparmor.d.5.html|apparmor.d man page]]</nowiki>
** Ubuntu 25.10 (Questing Quokka)
** <nowiki>[[https://manpages.ubuntu.com/manpages/questing/en/man7/apparmor.7.html|apparmor man page]]</nowiki>
** <nowiki>[[https://manpages.ubuntu.com/manpages/questing/en/man5/apparmor.d.5.html|apparmor.d man page]]</nowiki>
** Technical documentation can be found in <code>/usr/share/doc/apparmor-docs/techdoc.pdf.gz</code> from apparmor-docs package
** <nowiki>[[https://gitlab.com/apparmor/apparmor/-/wikis/Documentation|AppArmor upstream documentation]]</nowiki>
** <nowiki>[[http://wiki.apparmor.net/|AppArmor upstream wiki]]</nowiki>
** <nowiki>[[SecurityTeam-Specifications-AppArmor|AppArmor specification]]</nowiki> for Ubuntu
** See the DebuggingApparmor page for how to troubleshoot AppArmor in Ubuntu
