{|
  | '''Warning'''
  * This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
  * '''Images''' and '''attachments''' have been removed to conserve space.
  * '''Links''' may not work and there may be formatting issues.
  * A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

{| class="wikitable"
|-
| <tablestyle="float:right; width:40%; background:#F1F1ED; margin: 0 0 1em 1em;" style="padding:0.5em;">'''Table of Contents'''<<BR>>
|}

== Raspberry Pi 3 ==

The <nowiki>[[ARM-RaspberryPi|Raspberry Pi]]</nowiki> 3 was released in early March 2016, shortly before the release of Ubuntu 16.04 (Xenial) LTS, but too short to have proper support.  It is possible to run Xenial's kernel and a full Ubuntu installation, but it requires replacing the firmware, bootloader and some other hacks.

=== Fresh installation ===

One-off raspi3 images are available which include the ppa-rpi3 PPA pre-installed.  For installation details, see <nowiki>[[ARM-RaspberryPi]]</nowiki>.

=== Cross-hardware upgrade ===

This procedure assumes a working Ubuntu Xenial Raspberry Pi '''2''' installation.  You will be converting a few things over to work on the RPi3, then doing a hardware swap from an RPi2 to an RPi3.

Be sure you have proper backups!  This is not a foolproof or well-tested procedure; if it breaks, you get to keep both pieces.

Install a PPA which contains updated u-boot-rpi, flash-kernel and linux-firmware-raspi2 packages, and upgrade.
<pre>
add-apt-repository ppa:ubuntu-raspi2/ppa-rpi3
apt-get update
apt-get -u dist-upgrade
</pre>

Install the RPi3 u-boot loader.
<pre>
apt-get install binutils # Required by mkknlimg, may not be installed
wget -O /tmp/mkknlimg https://raw.githubusercontent.com/raspberrypi/tools/master/mkimage/mkknlimg
chmod 0755 /tmp/mkknlimg 
/tmp/mkknlimg --dtok /usr/lib/u-boot/rpi_3_32b/u-boot.bin /boot/firmware/uboot.bin
</pre>

Remove uboot.env, as the updated flash-kernel package switches to using boot.scr on the RPi3.  Run flash-kernel to install the new components.
<pre>
rm -f /boot/firmware/uboot.env
flash-kernel --machine "Raspberry Pi 3 Model B"
</pre>

Check that bcm2710-rpi-3-b.dtb and boot.scr have been created in /boot/firmware by flash-kernel.

Modify /boot/firmware/config.txt with at least the following configs:
<pre>
enable_uart=1
device_tree_address=0x100
device_tree_end=0x8000
kernel=uboot.bin
dtparam=i2c_arm=on
dtparam=spi=on
</pre>

enable_uart is needed by u-boot for all RPi3 modes, even if you have no intention of using a serial console.  The device_tree options are needed to explicitly declare the DTB area, as the DTB is slightly larger than 16,128 bytes, and the bootloader otherwise assumes an address space of 0x100 through 0x4000.

Shut down the system.
<pre>
poweroff
</pre>

Swap out the hardware from the RPi2 to the RPi3 and boot.

=== 64-bit kernel/userland ===
See <nowiki>[[https://wiki.ubuntu.com/ARM/RaspberryPi#Ubuntu_arm64.2FAArch64|ARM/RaspberryPi]]</nowiki>.

Known issues:
* !VideoCore userland utilities are <nowiki>[[https://github.com/raspberrypi/userland/issues/314|not yet available]]</nowiki> for arm64.

=== Bugs filed ===

* <nowiki>[[https://bugs.launchpad.net/ubuntu/+source/flash-kernel/+bug/1578505|LP: #1578505]]</nowiki> - flash-kernel: Raspberry Pi 3 support
* <nowiki>[[https://bugs.launchpad.net/ubuntu/+source/u-boot/+bug/1580323|LP: #1580323]]</nowiki> - u-boot: Pull/merge 2016.05~rc3+dfsg1-1 from Debian experimental
** Upstream Debian: <nowiki>[[https://bugs.debian.org/823524|Debian: #823524]]</nowiki> - u-boot: Add rpi_3_32b target to u-boot-rpi
* <nowiki>[[https://bugs.launchpad.net/ubuntu/+source/linux-firmware-raspi2/+bug/1578745|LP: #1578745]]</nowiki> - linux-firmware-raspi2: Update firmware for Raspberry Pi 3 support
* <nowiki>[[https://bugs.launchpad.net/ubuntu/+source/livecd-rootfs/+bug/1580326|LP: #1580326]]</nowiki> - livecd-rootfs: Add raspi3 subarch
** <nowiki>[[https://code.launchpad.net/~fo0bar/livecd-rootfs/raspi2-rpi3/+merge/293959|MP: #293959]]</nowiki> - livecd-rootfs: Add raspi3 subarch
