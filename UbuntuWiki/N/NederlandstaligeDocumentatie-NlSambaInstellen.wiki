{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

Deze tutorial zal u helpen om beveiligd dingen te delen tussen Linux en Windows.

Deze gids is te volgen met de volgende versies van Ubuntu.

* Dapper Drake (6.06)
* Edgy Eft (6.10)
* Feisty Fawn (7.04)

Hij zou ook moeten werken met deze versies van MS Windows (met een '''werkgroep''' configuratie, ''not'' '''Domain''').

* Windows 2000 Professional
* Windows XP Home
* Windows XP Professional
* Windows XP 64-bit Edition

Hij zover alleen nog getest op "Feisty Fawn" en "Windows XP Home en 64-bit".

In deze gids zullen we een gedeelde map maken op Windows en hem openen via Linux.

(!) '''Samba''' is Linux's versie van het Windows SMB (Server Message Block) protocol.

== Het instellen van SMB op Windows ==
=== Het installeren van het SMB protocol ===
Open een command prompt door naar start te gaan >> Run of Uitvoeren >> en dan '''cmd''' in te typen en druk dan op OK.
In het command prompt tipt u dit ( '''>''' mag niet mee worden gekopieerd):
<pre>
> control netconnections }}}

Klik rechts op de afbeelding van uw netwerk adapter en kies '''Properties'''. Kijk na of ''' Bestanden en Printer delen...''' bij de opties staat en is aangevinkt. Als dit niet zo is kan u '''Installeer''' gebruiken om deze service te installeren.

 <nowiki>[[http://xtknight.atothosting.com/images/ubuntu_wiki/lanprop.jpg]]</nowiki>

<!> Als de XP firewall opstaat moet u er op letten dat '''Bestanden en Printers delen''' bij '''Uitzonderingen''' staat.

=== Het instellen van de werkgroep en de computernaam ===

Klik rechts op het '''Deze Computer''' icoon op uw desktop en klik op '''Eigenschappen'''. Klik op de '''Computernaam''' tab vanboven. Klik dan op '''wijzig...''' en gebruik '''werkgroep'''. In dit voorbeeld gebruiken we '''MSHOME''' omdat dat ook standaard zo is in Ubuntu Samba. Kies ook een computernaam (in dit voorbeeld '''DEVMACHINE'''), werkgroep- en computernamen zijn niet hoofdelettergevoelig. Als uw computer nu vraagt om te herstarten, doe dit dan gewoon. Meld u niet gewoon af.

 <nowiki>[[http://xtknight.atothosting.com/images/ubuntu_wiki/compname.jpg]]</nowiki>

=== Het opzetten van de verbinding ===

We zullen een groep en gebruiker moetten toevoegen om effectief onze gedeelde map in Windows te gebruiken.

Ga terug naar de command prompt en typ deze commando's. Verander '''S''''''hareAccessPassword''' naar een passwoord dat u kiest.
{{{
> net localgroup UbuntuSMB /add
> net user ubuntu ShareAccessPassword /add /passwordchg:no /expires:never
> net localgroup UbuntuSMB ubuntu /add
> net localgroup Users ubuntu /delete }}}

We gaan er ook voor moetten zorgen dat u wachtwoord nooit vervalt. Typ: {{{
> compmgmt.msc }}}

Zoek '''Lokale gebruikers en Groepen''' onder '''Systeem werkkit'''. Klik rechts op de '''ubuntu''' gebruiker en klik op '''Eigenschappen'''. Sta '''passwoord vervalt nooit''' toe en klik op OK.
(Bij mij werkte deze stap niet dus als dat het geval is slaat uw deze stap gewoon over!)

=== Het opzetten van een Gedeelde Map ===

In Verkenner, zoek een map of drive die u wilt delen. In dit voorbeeld zal dat de map '''c:\shares''' zijn. (Dit is ook het gemakkelijkste nadien kunt u nog mappen toevoegen). Als deze map nog niet bestaat maakt u ze aan. Klik rechts op de map >> '''Eigenschappen''' geef de map een "Share"naam en ga naar de '''Sharing of Delen''' tab en sta verwijder de groep '''Iedereen''' als u deze enkel met Ubuntu wilt delen >> voeg dan de groep '''UbuntuSMB''' toe en geeft die naargelang uw wensen de juiste voorkeuren. (Bij XP Home editon kan dit anders zijn naar eigen ondervindingen, u moet eerst erkennen dat u het veiligheidsrisico kent om dan te kunnen delen, het gemakkelijktste daar is ook om met iedereen te delen)

<nowiki>[[http://xtknight.atothosting.com/images/ubuntu_wiki/shareperms.jpg]]</nowiki>

<!> Als u verbind met de gedeelde map met een andere gebruiker dan '''UbuntuSMB''' zal dit lukken alleen zal hij deze niet kunnen mounten,ook niet als Root. U krijgt dan hetvolgende: {{{
?---------  ? ?    ?          ?                ? winshares }}}

(!) U kan de toelatingen van de gedeelde map toestaan terwijl de map verbonden is, u hoeft de computers niet te herstarten [vanaf Feisty Fawn en XP 64 bit]

== Het instellen van Samba op Ubuntu ==

=== Het installeren van Samba ===
Open een terminal door naar Programma's te gaan >> Hulpmiddelen >> Terminal en typ hetvolgende. {{{
$ sudo apt-get install samba smbfs
$ sudo mkdir -p /media/winshares
$ sudo addgroup smb
$ sudo adduser $USER smb }}}

U moet nu afmelden om na te kijken of uw gebruiker in de '''smb''' groep is. Uw hoeft niet te herstarten.

''Is it true that smbfs is depricated? According to [http://joey.ubuntu-rocks.org/blog/2007/04/25/resolution-to-mounting-samba-shares-dont-use-smbfs/ a blog post by Joey Stanford

=== Het testen van de Gedeelde Mappen ===

Nu gaan we proberen te verbinden met de Windows map!
Vergeet niet '''S''''''hareAccessPassword''' te verangen door het wachtwoord dat u daarjuist gekozen heeft. Vergeet ook niet om uw werkgroep- en computernaam aan te passen in deze code. Onze Gedeelde Map noemt "//DEVMACHINE/shares". Dit is een type van UNC waar het format is: //'''COMPUTER_NAME'''/'''SHARE_NAME'''. In Windows worden backslashes gebruikt in plaats van forward slashes om UNC paths te openen. {{{
$ sudo mount -t smbfs -o username=ubuntu,password=ShareAccessPassword,workgroup=MSHOME,gid=smb,uid=$USER,fmask=770,dmask=770,rw //DEVMACHINE/shares /media/winshares }}}

<!> Door het gebruiken van de '''770''' toelating, geven we volledige toelating aan de gebruikers in de '''smb''' groep en geen toelating aan de andere gebruikers.

<!> Als de naam van uw gedeelde map een spatie bevat moet u de naam van de map tussen aanhalingstekens zetten vb: "Share with Spaces":
 {{{
$ sudo mount -t smbfs -o username=ubuntu,password=ShareAccessPassword,workgroup=MSHOME,gid=smb,uid=$USER,fmask=770,dmask=770,rw "//DEVMACHINE/Share with Spaces" /media/winshares }}}

Uitleg hierbij:

* '''sudo mount''' -- this is the command to mount a drive to a target.
* '''-t smbfs''' -- this specifes that we would like to use the "smbfs" (Samba) file system.
* '''-o username=...''' -- these are the parameters we pass to "smbfs" to make a proper connection to a share.
* '''gid=smb''' -- this specifies that we would like the "smb" group to have ownership of the mount point.
* '''fmask=777,dmask=777''' -- these are the permissions we are giving to the owner, all users of the "smb" group.
* '''rw''' -- this specifies that we would like read/write access to the share.  '''ro''' will do read-only.

Als na deze bewerking uw terminal geen opmerkingen gaf heeft u de share hoogstwaarchijnlijk goed gemount. Kijk na met:{{{
$ stat -c %a /media/winshares }}}

<!> '''Belangrijk:''' u kan niet een hele computer mounten.

=== Automatisch de Gedeelde Mappen mounten bij het opstarten ===

==== Het beveiligen van u wachtwoord ====

 Laten we we eerst de Gedeelde Mappen unmounten die we net hebben getest. {{{
$ sudo umount -a -t smbfs }}}

We willen niet dat onze gebruikersnaam en wachtwoord door iedereen kunnen gezien worden in de map /etc/fstab. Dus we maken een onzichtbare tekst die alleen door de root kan worden verandert. Typ hetvolgende: {{{
$ sudo touch /etc/smbcredentials
$ sudo chmod 600 /etc/smbcredentials }}}

Open '''/etc/smbcredentials''' met uw favoriete tekst-editor

 '''Ubuntu/Gnome/XFCE:''' {{{
$ gksudo gedit /etc/smbcredentials }}}

 '''Kubuntu/KDE:'''  {{{
$ kdesu kate /etc/smbcredentials }}}

 Typ hetvolgende in het '''/etc/smbcredentials''' bestand:
  {{{
username = ubuntu
password = ShareAccessPassword  }}}

<!>Vergeet niet het passwoord te veranderen door uw eigen gekozen passwoord!!!

 Sla het bestand op. Sommige teks-editors maken een back-up van het bestand door een '''~''' toe te voegen. We zorgen ervoor dat dat bestan wordt verwijdert zodat niemand het kan lezen (Veiligheid!!!){{{
 $ sudo rm /etc/smbcredentials~
</pre>

==== Het registreren van de Gedeelde Mappen ====

Open '''/etc/fstab''' op dezelfde manier als hierboven. Voor elke gedeelde map die u wilt mounten bij het opstarten, voegt u een lijn toe met iets dat lijk op hetvolgende: {{{
//DEVMACHINE/shares     /media/winshares        smbfs   auto,credentials=/etc/smbcredentials,workgroup=MSHOME,gid=smb,uid=1000,fmask=770,dmask=770,rw       0       0}}}

'''uid=''1000''''' moet vervangen worden door de gebruikersnaam die u nu gebruikt.
Dit moet allemaal in 1 lijn komen in uw tekst-editor, soms moet u bij de instellingen woord automatisch afkappen naar volgende regel uitzetten.

<!> Als uw gedeelde map een spatie bevat moet u alle spaties vervangen door '''\040''', vb: "Share with Spaces": {{{
//DEVMACHINE/Share\040with\040Spaces     /media/winshares        smbfs   auto,credentials=/etc/smbcredentials,workgroup=MSHOME,gid=smb,uid=1000,fmask=770,dmask=770,rw       0       0}}}

==== Het testen van fstab ====

Typ hetvolgende in een terminal om de automatische Samba mounts te testen. {{{
$ sudo mount -a -t smbfs
$ mount | grep smbfs }}}

Uw Samba gedeelde map  zou moeten verschijnen. Ze zou ook moeten geopend kunnen worden en de juiste toelatingen hebben, als dit niet zo is herneem de stappen eens.

== Omgekeerd ==
Om bestanden van Ubuntu naar Windows in te voegen zet u deze gewoon in de '''winshares''' map en u kan ze nadien via Windows er af halen.

== Proficiat!! ==

Uw Gedeelde Mappen werken nu perfect en zijn beveiligd. De Mappen zouden nu automatisch moeten verschijnen met het opstarten (dit kan nu iets trager gaan)

== Troubleshooting ==

For now this section is empty.  Please add any errors and solutions to them that you may find.
Op dit moment is deze sectie leeg, voeg errors en oplossingen toe als u ze zou vinden.

''This document seems to do a good job documenting how to access files on a Windows machine from a Ubuntu machine. So ... How do I read and write files on a Ubuntu fileserver from a Windows machine? Does some other wiki.ubuntu page that describes that? Please link to it here. -- Davidcary ''

Vrij naar Engelse versie <nowiki>[[https://wiki.ubuntu.com/ComprehensiveSambaGuide?action=show]]</nowiki>
