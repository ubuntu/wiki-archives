{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

GRUB, het eerste wat je ziet!

De menulijst van Grub is het eerste wat je ziet, als je Linux hebt geïnstalleerd
en je start je computer opnieuw op. Maar hoe zit Grub eigenlijk in elkaar, en
hoe kun je hem nog meer naar je hand zetten? Een paar van de belangrijkste
vragen behandel ik hier.

Grub is een afkorting van Grand Unified Bootloader, oftewel Grootse Verenigde
Opstarter. Een toepasselijke naam, want het ding start werkelijk alles op. Je
kunt het zo gek niet bedenken, of Grub start het probleemloos: alle soorten
Linux, alle soorten Windows, DOS, Solaris, BSD, en ga zo maar door. Er zijn ook
andere opstarters, zoals LILO, maar Grub is de meest populaire. En niet voor
niets!

De kracht van Grub zit mede in zijn eenvoud. Dat zie je bijvoorbeeld al aan de
prehistorische naam van de menulijst: menu.lst ; drie letters als extensie,
terwijl vier letters (list) natuurlijk veel logischer is. Lang, lang geleden
konden computers alleen omgaan met bestandsextensies van maximaal drie
tekens.....

Twee delen
Grub bestaat uit twee delen. Het eerste deel is het eigenlijke programma, dat
zit in de eerste sector van de harde schijf: de MBR oftewel de Master Boot
Record. Het tweede deel is de menulijst met daarin de verschillende
opstart-opties: die staat op de Linuxpartitie. 

Als je meerdere Linuxsoorten op je harde schijf hebt staan, heb je dus ook meerdere menulijsten. Grub moet
natuurlijk wel weten welke lijst hij moet gebruiken. En als je al je
Linuxpartities hebt gewist, heeft hij überhaupt geen lijst meer, en geeft hij
dus een foutmelding.

Grub herstellen
Als je Windows hebt geïnstalleerd nadat je Linux hebt geïnstalleerd, dan is het
eerste deel van Grub, het eigenlijke programma in de MBR, overschreven door de
opstarter van Windows. Je ziet Linux dan ineens niet meer. Lastig. Maar zo
herstel je Grub weer:

* Start de computer vanaf de Ubuntu LiveCD.
* Open een terminalschermpje.
* Typ "sudo grub" (zonder aanhalingstekens uiteraard....) en druk op Enter. Dit
  start Grub zelf op.
* Typ "root (hd0,1)" en druk op Enter (als je Linux rootpartitie op sda2 staat.
  Staat die bijvoorbeeld op sda6, dan is de terminaltoverspreuk "root (hd0,5)".
  Hiermee vertel je Grub waar de actieve Linuxpartitie zit. Grub telt vanaf
  0, vandaar.
* Typ "setup (hd0)" en druk op Enter. Hiermee installeer je Grub (opnieuw) in de
  MBR.
* Verlaat Grub door "quit" in te tikken en op Enter te drukken.
* Herstart de computer.

Let op: hoewel Ubuntu de partities op een SATA-schijf "sda" noemt, gebruikt Grub
gewoon de aanduiding "hd0". Net zoals bij een oudere IDE-schijf. Grub is de
eenvoud zelve....

Je kunt bovenstaande instructie ook gebruiken wanneer je meerdere Linuxsoorten
op je schijf hebt staan, en je wil niet dat Grub de nieuwste menulijst gebruikt.

Windows bovenaan
Wat veel mensen in het begin van hun Linuxavontuur willen, is Windows bovenaan
in de menulijst van Grub. Zodat die automatisch wordt gestart, wanneer je geen
keuze maakt. Daarvoor hoef je alleen maar de menulijst te bewerken. 

Voordat je dat doet, maak eerst even een kopietje van de menulijst. Ga daarvoor even met je
bestandsbeheerder naar /boot/grub/menu.lst, dubbelklik erop, kies Weergeven, en
daarna Opslaan als. Noem de kopie bijvoorbeeld menu.lstbkp en sla hem op in je gebruikersmap.

Bewerken van de menulijst gaat als volgt, met behulp van het kladblokje Gedit:
In de terminal:
sudo gedit /boot/grub/menu.lst
(Bij Kubuntu is het tekstverwerkertje niet gedit, maar kate. En bij Xubuntu is
het mousepad).

Let op: het Automagic deel van de menulijst wordt automatisch volledig
herschreven bij een kernel update van Linux. Dus je Windowsregels moeten niet
daarin terecht komen.

De Windowsregels moeten dus of onder het Automagic deel van de menulijst staan
(wordt dan laatste menu-optie), of erboven (wordt dan eerste menu-optie).

Voor XP zijn de regels gewoonlijk als volgt:

title           Microsoft Windows XP Professional
root            (hd0,0)
savedefault
makeactive
chainloader    +1

Het Automagic deel begint hier:

Zoals je ziet, staat de waarschuwing er al in: statische opstartregels (die dus
niet moeten meeveranderen met kernel updates), moeten voor of na het Automagic
deel....

Terug naar alleen Windows
Af en toe wil iemand helemaal van Linux af, en weer alleen Windows op z'n
schijf. Meestal maar tijdelijk, want Linux is verslavend.....
Hoe krijg je Grub weer weg? Heel makkelijk:
* start de computer op met een willekeurige Windows XP installatie-CD 
* kies herstelconsole (recovery)
* tik in: "fixmbr" (zonder de aanhalingstekens)
* herstelconsole afsluiten en computer opnieuw opstarten
Windows XP start nu weer als vanouds op met zijn eigen ntldr; Grub is verdwenen.

In de menulijst staan nog veel meer opties. Experimenteer er maar eens mee! 

Bijvoorbeeld: een regel in de menulijst wordt actief respectievelijk zichtbaar
in het menu, wanneer je het hekje ervoor weghaalt (#). Het kan handig zijn om
oude Linuxkernels onzichtbaar te maken in de menulijst, want met elke kernel
update komen er weer een paar regels bij..... 

Uitcommentariëren met een # is beter dan wissen, want je weet maar nooit..... Je
computer is niet altijd even blij met de nieuwste kernel, en wil misschien
alleen maar opstarten met de oude. Dan is het wel handig als je de bijbehorende
opstartregels nog in je menulijst hebt staan. 

Voor de veiligheid kun je daarom het beste de nieuwste en de op één na nieuwste
kernel zichtbaar laten in de menulijst. De oudere kun je onzichtbaar maken. Of
zelfs helemaal van je schijf verwijderen, maar dat valt buiten de strekking van
dit artikel.

                    ---- ... ----
