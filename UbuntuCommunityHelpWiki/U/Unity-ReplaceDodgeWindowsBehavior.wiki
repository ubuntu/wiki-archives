{|
  | '''Warning'''
  * This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
  * '''Images''' and '''attachments''' have been removed to conserve space.
  * '''Links''' may not work and there may be formatting issues.
  * A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

Discussion of this wiki can be found <nowiki>[[http://ubuntuforums.org/showthread.php?t=2012412 | here ]]</nowiki>

== Replace Dodge Windows Behavior in Unity ==

So, I've been running Ubuntu 12.04 since around Beta 1, and one thing that really bothered me was the missing ''Dodge Windows'' behavior. I had gotten so used to the behavior that it completely disrupted my workflow when I migrated over to Ubuntu 12.04.

There has been a valiant effort to recreate this behavior <nowiki>[[http://ubuntuforums.org/showthread.php?t=1936037 |here]]</nowiki>. For the most part, the script works pretty well, but I wanted the "real" option back. In this bug report, <nowiki>[[https://bugs.launchpad.net/unity/+bug/930148|#930148]]</nowiki>, one user, '''''damianatorrpm''''' (around comment #141), has created a couple patches that will revert the Canonical changes and re-add the behavior back to the source. I applied the patch to latest release of Unity (at this time of this writing, it's 5.12.0) and it works! Not only the behavior work as expected, the option is back in the Compiz Config Settings Manager (CCSM) and has no nasty side-effects.

Another feature I really like is the ability to be able to click a program's icon on the Launcher and minimize/unminimize that window. '''''Jonathan French (ojno)''''', the developer behind this patch, has not only made this a reality, but also got this to work in conjunction with the 'Spread Windows' functionality. He's even set up a PPA which contains the latest Unity and his patch to make it easier for end-users to get it.

'''NOTE''': There are currently 2 methods to installing a custom Unity build. You can either use my PPA, which is easier, or you can build the patched Unity from source. Since the PPA method is much easier, it is currently the recommended method. You can choose either one, but '''NOT''' both.

So, without further ado, let's get started. Open up a terminal window and follow the steps below.

=== PPA Method (Recommended) ===

'''NOTE''': If you used the alternative method originally, please remove ~/.compiz-1 and the 'staging' folder before using the PPA method.

==== Add the PPA ====

First, we'll need to add my PPA repository:

Code:

<pre>
sudo apt-add-repository ppa:ikarosdev/unity-revamped
</pre>

...after that, all we need to do is update our system:

Code:

<pre>
sudo apt-get update && sudo apt-get dist-upgrade
</pre>

...you're done! You'll need to log out and back in to see any effect. Ensure that Compiz Config Settings Manager (CCSM) is installed and go into the Unity plugin configuration. Turn on the Dodge Windows effect and it should work. Minimize an application to the launcher and click its icon again to unminimize it. If multiple windows of the same program are opened, the spread function should work as usual.

==== Removal ====

If you'd like to revert back to the official Unity packages, simply use ''PPA-purge'' to revert back. First, let's ensure that it's installed:

Code:

<pre>
sudo apt-get install ppa-purge
</pre>

...then, we'll remove my PPA:

<pre>
sudo ppa-purge ppa:ikarosdev/unity-revamped
</pre>

=== Alternative Method (Compiling Unity from Source): ===

'''NOTE''': I tried this on a fresh installation of Ubuntu 12.04 32-bit. I can't say for sure if it'll work on older or other versions.

==== Install the Dependencies ====

The first thing to do is to install all the dependencies needed to grab the source (from my Launchpad) and build Unity:

Code:

<pre>
sudo apt-get install bzr
</pre>

Code:

<pre>
sudo apt-get build-dep unity
</pre>

==== Getting the Modified Source ====

Now, we'll need a place to compile Unity. I usually like to create a folder called ''staging'' and dump everything in there. You're welcome to put the source wherever you like, but remember to change the path accordingly:

Code:

<pre>
mkdir ~/staging
</pre>

...Now, we move into the directory:

Code:

<pre>
cd ~/staging
</pre>

Okay, the next step is to grab the modified source from my Launchpad branch. While still in the ''staging'' directory, run this command:

Code:

<pre>
bzr branch lp:~ikarosdev/unity/5.0_unity-revamped
</pre>

==== Preparing Our Environment ====

Once it's done pulling the source, we'll need to prepare our environment to build. We'll create a simple bash script and make it executable:

Code:

<pre>
gedit unity.sh
</pre>

...When the blank gedit window opens, copy and paste the following text into the file:

Code:

<pre>

PREFIX=/home/YOURUSERNAMEHERE/staging

export XDG_DATA_DIRS="$PREFIX/share:$XDG_DATA_DIRS"
export LD_LIBRARY_PATH="$PREFIX/lib/"
export PKG_CONFIG_PATH="$PREFIX/lib/pkgconfig/"
</pre>

You'll need to change ''YOURUSERNAMEHERE'' to your username. Once you've done that, save the file and close the window. Make the file executable and run it:

Code:

<pre>
chmod +x unity.sh
</pre>

Code:

<pre>
./unity.sh
</pre>

==== Build Unity ====

Okay, now let's build Unity! We'll need to create a build folder for the compile. Let's move into the Unity source directory and create that folder and move into it:
Code:

<pre>
cd 5.0_unity-revamped
</pre>

Code:

<pre>
mkdir build && cd build
</pre>

Now, we'll prepare the build, compile and install:

Code:

<pre>
cmake .. -DCMAKE_INSTALL_PREFIX=/home/YOURUSERNAMEHERE/staging/ -DCMAKE_BUILD_TYPE=Debug -DCOMPIZ_PLUGIN_INSTALL_TYPE=local -DGSETTINGS_LOCALINSTALL=ON
</pre>

(Once again, remember to change ''YOURUSERNAMEHERE'' to your username!)

Code:

<pre>
make -j4
</pre>

Code:

<pre>
make install
</pre>

Once that's finished, log out and back in. Ensure that Compiz Config Settings Manager (CCSM) is installed and go into the Unity plugin configuration. Turn on the ''Dodge Windows'' effect and it should work. Minimize an application to the launcher and click its icon again to unminimize it. If multiple windows of the same program are opened, the spread function should work as usual.

===== Warning! =====

When using this, do '''NOT''' delete anything in the ''staging'' folder. More specifically, do '''NOT''' delete the ''bin'', ''include'', ''lib'', and ''share'' folders. You will have unwanted side-effects (i.e. Compiz/Unity will keep crashing)!

==== Removal ====

If you'd like to revert back to "stock" Unity, simply remove the ~/.compiz-1 folder and you should be back to normal.

Code:
<pre>
rm -r ~/.compiz-1
</pre>

'''Credits''': Dodge Windows patch by '''''damianatorrpm''''' and '''''Jonathan French (ojno)''''' for the wonderful minimize behavior code.
