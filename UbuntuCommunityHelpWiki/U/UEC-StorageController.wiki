{|
  | '''Warning'''
  * This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
  * '''Images''' and '''attachments''' have been removed to conserve space.
  * '''Links''' may not work and there may be formatting issues.
  * A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__


{| class="wikitable"
|-
| <tablestyle="float:right; font-size: 0.9em; width:40%; background:#F1F1ED; margin: 0 0 1em 1em;" style="padding:0.5em;"><<BR>>
|}

=== Objectives ===
This page describes how you can use the Eucalyptus Storage Controller (SC) functionality within the UEC after it is installed. The Storage Controller provides functionality which is similar to Amazon's EBS (Elastic Block Storage), allowing you to mount block devices (virtual hard disks) to your images that persist when the images are terminated.

=== Update default configuration (if needed) ===
If you installed UEC from CD and you have a separate physical interface to connect your front-end to your Eucalyptus Node Controllers (NCs), in order to use the SC functionality you must be sure that your SC is registered to use your private interface. 

You can do this via the web interface under '''Configuration -> Clusters -> Storage Controller'''. Make sure the IP address listed under '''Host''' is the IP address for your private interface, and the Interface listed is the physical interface to the private network. 

To do this from the command line, do 
<pre>
sudo euca_conf --deregister-sc <public IP>
sudo euca_conf --register-sc <your cluster name> <private IP>
</pre>

Please note that any volumes you have created before doing this will need to be removed using euca-delete-volume because they will not work and will just take up space on your front-end.

=== Using the Storage Controller ===

In order to use a virtual volume, you need to:
1. create the volume
2. use it

==== Creating Volumes ====

To create a Eucalyptus SC volume,  
<pre>
euca-create-volume -s 1 -z myzone
</pre>
where -s specifies size in GB, and -z specifies the name of your UEC availability zone as shown
when you do a: 
<pre>
euca-describe-availability-zones
</pre>
This will return the word VOLUME and the name of your UEC SC volume:
<pre> 
VOLUME	vol-xxxxxxxx
</pre>

==== Using Volumes ====

To attach a volume to a running instance:
<pre>
euca-attach-volume -i i-xxxxxxxx -d /dev/sdb vol-xxxxxxxx
</pre>
where -i is the instance identifier, -d is the device name you are requesting to be assigned to your SC volume.

After you have done this, when you do a 
<pre>
euca-describe-volumes 
</pre>

you should see something like this:
<pre>
VOLUME	vol-xxxxxxxx	 1		myzone	in-use	2009-10-23T14:41:47.375Z
ATTACHMENT	vol-xxxxxxxx	i-xxxxxxxx	/dev/sdb	2009-10-23T14:42:10.274Z
</pre>

You should then be able to ssh into your instance, look in the /dev directory to make sure your device is there (it is possible it may have been assigned a different name - i.e. you may request /dev/sdh and it may assign it as /dev/sdb), and you can
<pre>
sudo fdisk /dev/sdb
</pre>

You will be able to partition, format, mount and use the volume just like a physically attached device.
