{|
  | '''Warning'''
  * This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
  * '''Images''' and '''attachments''' have been removed to conserve space.
  * '''Links''' may not work and there may be formatting issues.
  * A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

{| class="wikitable"
|-
| <tablestyle="float:right; font-size: 0.9em; width:40%; background:#F1F1ED; margin: 0 0 1em 1em;" style="padding:0.5em;"><<BR>>
|}

=== Overview ===
This tutorial covers UEC installation by adding the Eucalyptus packages to previously installed Ubuntu 10.04 servers where you want to have separate servers for the following services:
* 1 Cloud Controller (CLC - eucalyptus-cloud) server
* 1 Walrus Controller (WS3 - eucalyptus-walrus) server
* N Cluster Controller (CC - eucalyptus-cc) + Storage Controller (EBS - eucalyptus-sc) servers
* N Node Controller (NC - eucalyptus-nc) servers on a dedicated network connected to on of the CC+EBS server

=== Objective ===

From this tutorial, you will learn how to install, configure, register and perform several operations on a advanced UEC setup that results in a cloud as described in the above section. This topology is recommended if you would like to build a generic purpose scalable cloud.  Our current testing indicate that a given cluster should limit itself to the management of up to 250 instances.

=== Tutorial ===
==== STEP 1: Prerequisites ====

To deploy a minimal cloud infrastructure, youâ€™ll need at least 4 dedicated systems:
* 1 CLC
* 1 WS3
* 1 CC + EBS
* 1 NC

==== STEP 2a: Install the Cloud Controller Server ====

1. Install the eucalyptus-cloud package on the server
<pre>
sudo apt-get install eucalyptus-cloud
</pre>
 Answer debconf's questions as follow:
** Configure postfix for ''internet'' delivery
1. Make sure process eucalyptus-cloud is running
<pre>
ps -ef | grep eucalyptus-cloud
</pre>

==== STEP 2b: Install the Cluster Controller Server(s) ====

1. Install the eucalyptus-cc and eucalyptus-sc packages on the server
<pre>
sudo apt-get install eucalyptus-cc eucalyptus-sc
</pre>
 Answer debconf's questions as follow:
** Configure postfix for ''internet'' delivery

** Name your cluster
*** e.g. cluster1
** Add a list of available IP addresses on your external (public) network
*** e.g. 192.168.1.200-192.168.1.249
1. Configure the second network interface
<pre>
sudo apt-get install bridge-utils vtun
interface=eth1
bridge=br1
sudo sed -i "s/^iface $interface inet \(.*\)$/iface $interface inet manual\n\nauto $bridge\niface $bridge inet \1/" /etc/network/interfaces
sudo tee -a /etc/network/interfaces <<EOF
        bridge_ports $interface
        bridge_fd 9
        bridge_hello 2
        bridge_maxage 12
        bridge_stp off
EOF
sudo /etc/init.d/networking restart
</pre>

1. Edit ''/etc/eucalyptus/eucalyptus.conf'' so that 
** br1 is the internal (private) interface and the bridge interface
** eth0 the external (public) interface
** you provide the correct address of the cloud controller (CLC) that you just installed in place of <CLC_ipaddress>
 by editing the following 3 variables, the third one (VNET_CLOUDIP) needing to be added manually:
<pre>
VNET_PUBINTERFACE="eth0"
VNET_PRIVINTERFACE="br1"
VNET_CLOUDIP="<CLC_ipaddress>"
</pre>

1. Edit ''/etc/eucalyptus/eucalyptus-ipaddr.conf'' so that the following variable are set to the internal (private) ip address of the server
<pre>
CC_IP_ADDR="<CC_ipaddress>"
SC_IP_ADDR="<CC_ipaddress>"
</pre>
 
1. Restart the service with a config reinitialisation
<pre>
sudo restart eucalyptus-cc CLEAN=1
sudo restart eucalyptus-sc
</pre>

1. Make sure processes eucalyptus-cc and eucalyptus-sc are running
<pre>
ps -ef | grep eucalyptus-
</pre>

==== STEP 2c: Install the Walrus Controller Server ====

1. Install the eucalyptus-walrus package on the server
<pre>
sudo apt-get install eucalyptus-walrus
</pre>

==== STEP 3: Install and Configure the Node Controller(s) ====
Installing the Eucalyptus Node Service on a running Ubuntu system consists of doing the following on one or more systems:

==== STEP 4: Register the Cluster, Storage, and Walrus Servers ====

The cloud controller must be aware the storage (SC, WS3) and of the clusters controllers, so you will need to allow password-less authentication between the CLC and the other server and then register them. 

===== SSH Key Authentication Setup =====

===== Registration =====
To register the controllers on the CLC:
1. Register the WS3 server:
<pre>
sudo euca_conf --no-rsync --register-walrus <WS3_ipaddresss>
</pre>
1. Then for each of your CC:
<pre>
sudo euca_conf --no-rsync --register-cluster <CC_name> <CC_ipaddress>
sudo euca_conf --no-rsync --register-sc <CC_name> <CC_ipaddress>
</pre>
 ''Note: If you get prompted for passwords, or receive errors from scp, you may need to revisit the key synchronization instructions at <nowiki>[[UEC-SSHKeyAuthSetup|SSH Key Authentication Setup]]</nowiki>''
1. Then edit the ''/etc/eucalyptus/eucalyptus-ipaddr.conf'' to fill the 3 following variables appropriately with the ip address of the respective service, replacing the "$addr" value.  If you have multiple CC and SC, you can specify multiple IP addresses separating them with a space.
<pre>
CC_IP_ADDR="$addr"
WALRUS_IP_ADDR="$addr"
SC_IP_ADDR="$addr"
</pre>
1. Finally restart the eucalyptus service on the CLC
<pre>
 sudo service eucalyptus restart
</pre>

===== Verify Registration =====
Verify that the registration process was successful by running the following commands
<pre>
sudo euca_conf --list-walruses
sudo euca_conf --list-scs
sudo euca_conf --list-clusters
</pre>

==== STEP 5: Register the Node(s) ====

==== STEP 6: Obtain Credentials ====

==== STEP 7: Install an image from the store ====

==== STEP 8: Run an Image ====

=== More Information ===

=== Glossary ===
