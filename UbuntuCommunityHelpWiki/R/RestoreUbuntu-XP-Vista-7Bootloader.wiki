{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

Discussion of this wiki can be found <nowiki>[[ http:--ubuntuforums.org-showthread.php?t=2012409 | here ]]</nowiki>

 This wiki is for Windows dual booters who reinstall an operating system only to find that it has taken away access to their other operating system. 
 Whether you want to restore the XP, Vista, 7 or Ubuntu (Grub) bootloader, this guide will walk you through it. <<BR>>

 All four parts of this tutorial require that you boot from a CD or DVD. If you don't know how to do this, check <nowiki>[[http://www.hiren.info/pages/bios-boot-cdrom| here.]]</nowiki> <<BR>> <<BR>>
 
 If you have made a mistake and want to revert the changes, simply follow the instructions for reinstalling the previous bootloader. For example, if you have installed vista over ubuntu, try to get the ubuntu bootloader back, but want to get the vista bootloader back, simply follow the instructions for installing the vista bootloader.

== How to fix the Ubuntu GRUB bootloader ==

 See <nowiki>[[Grub2-Installing#Fixing_a_Broken_System|this paragraph]]</nowiki>.

== How to fully fix the Windows bootloader using a Windows disk ==

=== XP ===

 Boot on your Windows XP installation CD or <nowiki>[[http://www.bleepingcomputer.com/forums/topic270018.html|XP Recovery console]]</nowiki>.

 You will get to a part where it asks if you want to repair or recover. To do so, press "r".

 If prompted, enter your Windows XP administrator password. This will leave you at at a command line, so type in the following two commands:

<pre>
fixboot
</pre>

<pre>
fixmbr
</pre>

 Then type

<pre>
exit
</pre>

 Then remove your XP cd. If everything has gone well, you should come to your XP bootloader.

=== Windows Vista or 7 or 8 ===

 First boot on your Windows Vista/7/8 installation DVD.
 If you have one of the many OEM computers that didn't come with a Windows installation disk, you can get the same effect with a Windows repair disk, which you can '''download''' (eg <nowiki>[[http://freakshare.com/files/o2db6v0s/CyberNetNews.com_Windows_7_32-bit_Repair_Disc.iso.html|Win7-32bit]]</nowiki>, <nowiki>[[http://freakshare.com/files/56apzmkl/CyberNetNews.com_Windows_7_64-bit_Repair_Disc.iso.html|Win7 64bit]]</nowiki>) '''or create''' from another Windows Vista/7/8 computer (see <nowiki>[[http://windows.microsoft.com/is-IS/windows7/Create-a-system-repair-disc|this page for Win7]]</nowiki> and <nowiki>[[http://forums.techarena.in/guides-tutorials/1114725.htm|Make your own Windows repairCD]]</nowiki>, and <nowiki>[[http://social.msdn.microsoft.com/Forums/en-US/samsungpcgeneral/thread/e7ed293e-b565-44ee-a536-166dddf32205|Windows 8 UEFI repair USB must be FAT32]]</nowiki>, <nowiki>[[http://www.eightforums.com/tutorials/2855-system-repair-disc-create-windows-8-a.html|other Win8 guide]]</nowiki>).
 When you get to the Regional settings, select your Location/Keyboard setting then click next. On the next page, click on "Repair your computer."

 On the next page, if it finds your Windows installation, make sure it is UNSELECTED before clicking next.
 Then click on "Command prompt". From there, type in the following 2 commands:

<pre>
bootrec.exe /fixboot
</pre>

<pre>
bootrec.exe /fixmbr
</pre>

 Now close the two windows and click "Restart."

 Take out your Windows DVD and hopefully, you will be left with your Windows bootloader.

== How to partially fix the Windows bootloader using an Ubuntu CD ==

 ''' Note:''' these methods will work on Legacy firmwares (not UEFI), if Windows boot files are not broken, and if the boot sector of the Windows boot partition is healthy. In other cases, you will need a Windows installation or repair disc as described above.

=== Via the Boot-Repair graphical tool ===

Run <nowiki>[[Boot-Repair]]</nowiki> from a liveCD, click "Advanced options", tick "Restore MBR", click "Apply".

{{http://pix.toile-libre.org/upload/original/1353333605.png}}

This will automatically restore a generic syslinux MBR, and set the boot flag on the Windows boot partition. This will also tell you if the Windows bootsector needs repair (see <nowiki>[[https://help.ubuntu.com/community/BootSectorFix|this tutorial]]</nowiki>).

=== Via command lines ===

1. Boot from the live CD (or live USB) of any recent version of Ubuntu and choose “Try Ubuntu” to get to the live desktop

2. Check that the partition from which Windows boots has the 'boot' flag. For XP and Vista, this is normally the main C: partition. Windows 7 usually (but not always) has a separate boot partition of 100-200 MB in size with the partition label “SYSTEM”. There are also more exotic configurations where two versions of Windows have been installed to the same hard drive, or where the main Windows partition is a logical one. In these cases there will be a single primary partition with the Windows boot files which needs to be marked as active, and you will need to identify which this is. Once you have done so, open Gparted and see if  “boot” is listed under the flags column for that partition. If not, highlight the partition and go to Partition menu → Manage Flags, tick the tick-box for “boot” and then close that window and close Gparted. <<BR>> <<BR>>

3. Both methods below assume that the boot drive is designated /dev/sda in Ubuntu. This is almost always so, but with some unusual BIOS configurations where there is more than one hard drive, the boot drive may be other than /dev/sda. In such cases you will need to adjust the command appropriately.

'''If internet connectivity available''', open a terminal and run these commands:

<pre>
sudo apt-get install lilo
</pre>

<pre>
sudo lilo -M /dev/sda mbr
</pre>

'''If no Internet connection''': recent versions of Ubuntu include the file /usr/lib/syslinux/mbr.bin which is 440 bytes in length and simply needs to be written to the beginning of the mbr with this terminal command.  WARNING! Be very careful with this command and check for typos before running it. 

<pre>
sudo dd if=/usr/lib/syslinux/mbr.bin of=/dev/sda
</pre>

4. Now reboot, remove the Ubuntu CD and you should reboot straight into Windows.<<BR>>

== See also ==

<nowiki>[[http://ubuntuforums.org/showthread.php?t=2012409|Thread for discussion about this wiki page]]</nowiki>
