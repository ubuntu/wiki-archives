{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__


General information: <nowiki>[[Repositories-Ubuntu|Repositories in Ubuntu]]</nowiki>

== Introduction ==

There are often a few packages that you want to install that don't exist in the Ubuntu repositories. If they have any dependencies on other packages, trying to use '''dpkg''' can drop you into "dpkg hell", and having '''apt''' resolve those dependencies for you would really help.

There are full blown methods of creating your own local repository, such as <nowiki>[[Debarchiver]]</nowiki> or <nowiki>[[Dak]]</nowiki>. These are overkill, when all you want is a means of resolving dependencies of the handful of packages you've downloaded from the web (not for an entire repository that you want to use without Internet connection; for this use <nowiki>[[AptGet-Offline-Repository]]</nowiki>). A simple solution is to use '''dpkg-scanpackages''', which will build a repository you can add to your sources.list or <nowiki>[[http://wiki.debian.org/AptMedium|apt-medium]]</nowiki>.

== Creating a Personal Repository ==

There are 4 steps to setting up a simple repository for yourself
# <nowiki>[[InstallingSoftware|Install]]</nowiki> dpkg-dev
# Put the packages in a directory
# Create a script that will scan the packages and create a file '''apt-get update''' can read
# Add a line to your sources.list pointing at your repository

=== Install dpkg-dev ===

Type in a terminal
<pre>
sudo apt-get install dpkg-dev
</pre>

=== The Directory ===
Create a directory where you will keep your packages. For this example, we'll use /usr/local/mydebs.
<pre>
sudo mkdir -p /usr/local/mydebs
</pre>
Now move your packages into the directory you've just created.

Previously downloaded Packages are generally stored on your system in the /var/cache/apt/archives directory.
If you have installed apt-cacher you will have additional packages stored in its /packages directory.

=== The Script update-mydebs ===

It's a simple three liner:
<pre>
# ! /bin/bash
 cd /usr/local/mydebs
 dpkg-scanpackages . /dev/null | gzip -9c > Packages.gz
</pre>

Cut and paste the above into gedit, and save it as '''update-mydebs''' in ~/bin. (the tilde '~' means your home directory. If ~/bin does not exist, create it: Ubuntu will put that directory in your PATH. It's a good place to put personal scripts). Next, make the script executable:
<pre>
chmod u+x ~/bin/update-mydebs
</pre>

'''How the script works:'''

'''dpkg-scanpackages''' looks at all the packages in mydebs, and the output is compressed and written to a file (Packages.gz) that '''apt-get update''' can read (see below for a reference that explains this in excruciating detail). /dev/null is an empty file; it is a substitute for an override file which holds some additional information about the packages, which in this case is not really needed. See deb-override(5) if you want to know about it.

=== Sources.list ===
add the line
<pre>
deb file:/usr/local/mydebs ./
</pre>
to your /etc/apt/sources.list, and you're done.

==== CD Option ====
You can burn the directory containing the debs to a CD and use that as a repository as well (good for sharing between computers).  To use the CD as a repository, simply run
<pre>
sudo apt-cdrom add
</pre>

== Using the Repository ==
Whenever you put a new deb in the mydebs directory, run
<pre>
sudo update-mydebs
sudo apt-get update
</pre>
Now your local packages can be manipulated with '''<nowiki>[[Synaptic]]</nowiki>''', '''aptitude''' and the apt commands: '''apt-get''', '''apt-cache''', etc. When you attempt to '''apt-get install''', any dependencies will be resolved for you, as long as they can be met. 

Badly made packages will probably fail, but you won't have endured dpkg hell.

== See Also ==
* AptGetHowto
* <nowiki>[[http://www.debian.org/doc/manuals/maint-guide/index.en.html|Debian New Maintainers Guide]]</nowiki> (this is the excruciating one)
* <nowiki>[[Repositories-Ubuntu]]</nowiki>
* <nowiki>[[AptCdrom]]</nowiki>
* <nowiki>[[AptGet-Offline-Repository]]</nowiki>
----
CategoryOffline CategoryPackageManagement
