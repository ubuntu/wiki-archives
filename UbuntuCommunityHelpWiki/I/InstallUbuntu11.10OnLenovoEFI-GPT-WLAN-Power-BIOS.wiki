{|
  | '''Warning'''
  * This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
  * '''Images''' and '''attachments''' have been removed to conserve space.
  * '''Links''' may not work and there may be formatting issues.
  * A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__



Discussion of this wiki can be found <nowiki>[[http://ubuntuforums.org/showthread.php?p=12062090#post12062090 | here ]]</nowiki>

== Introduction ==

 Lenovo's EFI implimentation seems not to be perfect on some newer Lenovo notebooks. After successfully installing Ubuntu the notebook is not able to load the bootloader by default. It seems to be a problem with GPT partition tables and non windows bootloaders.
 
  

== Installation ==

* Simply boot from your Live CD or a USB Stick(tested on S205, B570).
 
 I prefer the USB Stick because everything will go faster.

* (optional) - Fixing WLAN temporary for the live session (I would like to recommend that you plug a cable into your router instead of using a wireless connection it is more stable for installations and upgrades):
 
Once the system is loaded I was trying to fix my WLAN connection because Ubuntu was not able to start it by default.
 
Be sure that your hardware switch (if any) is activated.

 The following commands will make it possible that your wlan adapter will work temporary on your live session, but since we have no acer wlan adapter the connection can get unstable, especially on N networks.

 We will fix the wlan adapter after the installation, this workaround is still useful if you want to access a wifi network over a live session quickly.

 Open a terminal and type in the following:

<pre>
sudo modprobe acer_wmi
sudo modprobe -r acer_wmi
</pre>

Your WLAN adapter should now be ready to connect. 

== Installing Ubuntu with GPT partition table ==

** Launch the Ubuntu installer:
 You can let the installer load updates during the installation if you are connected to the internet.

 When it comes to the partition you have to use the "manual mode" so that you can select the partition layout. Don't use any predefined partition layouts.

 The first partition has to be the EFI partition, it will be formatted as fat16 afterwards.
 I gave the EFI partition 50 MB.

 Then I created a ext4 partition for "/" and a swap partition.

 That's all! No need to downgrade grub anymore.
* Lets permanently fix WLAN
 After we booted into our installed Ubuntu system, it is time to fix WLAN the right way.

 There are restricted drivers available for most of our wlan adapters.
 So we can install them with the restricted driver installer.

 Check after a reboot if you are able to connect.
 If you still cannot connect you might have to blacklist some modules.

<pre>
lsmod | grep "b43\|ssb\|bcma\|wl"
</pre>

Your output should be something like this:

<pre>
wl                   2568210  0
lib80211               14991  2 lib80211_crypt_tkip,wl
</pre>

If b43, ssb, bcma is loaded you have to blacklist them in:

{| class="wikitable"
|-
| <tablestyle="width:100%" class="ubuntu_quotebackground"> /etc/modprobe.d/blacklist.conf
|}

I also had to blacklist acer_wmi in order to get network-manager working.

 After editing the file, save it and reboot.
 You should finally see the wireless networks.

 If you need further assistance with wireless issues visit the networking section of the ubuntu forums <nowiki>[[http://ubuntuforums.org/forumdisplay.php?f=336 |here]]</nowiki> .

 Enjoy Ubuntu on your Lenovo! 

== Tweaks and Fixes ==

* Fix "Fn brightness keys 

After successfully installing Ubuntu you might come to the point that your "Fn brightness keys" are not working.
 
I found a simple solution using "xbacklight" for it.

 Be sure xbacklight is installed:

<pre>
sudo apt-get install xbacklight
</pre>

Now you can start a terminal window and type in:

<pre>
xbacklight - 20
</pre>

Your screen should dim by 20%.

 If you want to make it brighter again just type:

<pre>
xbacklight + 20
</pre>

This way you can easily change your brightness through the terminal.
 If you want to use your hardware "Fn" keys simply set the xbacklight commands as hotkeys in the keyboard settings.

* Fix battery drain (tested on Intel Sandy Bridge systems like B570)
 
When you switch from Windows based systems you might detect a faster battery drain on your Linux system.
 
The problem is that some kernel parameters are disabled by default which put the VGA into a energy saving mode.
 
Some people had random system freezes with this great Sandy Bridge feature enabled, however there are a lot of people like me who don't have problems at all. I will recommend you the tweaks which fixed the main battery drain for me.

 You have to add the following boot parameters to the grub2 configuration section GRUB_CMDLINE_LINUX_DEFAULT located here /boot/grub/grub.cfg:

1.) Activates the RC6 mode of the Intel GPU

<pre>
i915.i915_enable_rc6=1
</pre>

2.) Activates PCIe Active State Power Management

<pre>
pcie_aspm=force
</pre>

Don't forget to:

<pre>
sudo update-grub
</pre>

'''TLP:'''

 If you don't use the "laptop-mode-tools" package or other energy scripts, you can also have a look on TLP.
 
TLP will extend the energy modes on your laptop and power save features.

 There is a PPA available for TLP <nowiki>[[https://launchpad.net/~linrunner/+archive/tlp/+packages |here]]</nowiki>

<pre>
sudo add-apt-repository ppa:linrunner/tlp
sudo apt-get update
</pre>

Now you can install TLP and some usefull tools:

 smartmontools (main) - show SMART data with tlp-stat.
 ethtool (main) - allows to disable Wake On LAN
 powertop (main) - helps monitoring power consumption

<pre>
sudo apt-get install --no-install-recommends tlp smartmontools ethtool powertop
</pre>

* Update BIOS without windows

 There was a new BIOS available for my Lenovo B570 and I wanted to update it(Please be aware that upgrading the bio's can be dangerous and should not be done unless there is a problem that will be fixed or better support for new hardware). Lenovo only provides the WinFlash tool to do the updates directly in Windows, but I found a workaround to do it with a bootable USB Stick.

* Download your BIOS on the <nowiki>[[http://consumersupport.lenovo.com| Lenovo Consumer site]]</nowiki>. 

* Open the *.exe file with your archive manager and extract the containing *.zip file.
 In my case inside the 44CN43WW.exe update file, was the 44CN43WW.zip.
 Extract now the content of the *.zip to a folder e.g. "lenovo-bios".

* Now build yourself a bootable USB stick with FreeDos. I used the image of the Ultimate BootCD as source for my USB Stick because FreeDos is already built in.
 Copy the extracted "lenovo-bios" folder to the usb stick.
 Now boot into FreeDos.

* cd into your "lenovo-"bios" folder.
 Before running the update be sure that your battery is full or better you are on A/C.

 To start the update we need to run Pflash.exe with the BIOS filename, which is the *.rom file.
 
E.g.: Pflash.exe 44CN43WW.ROM

* After flashing the image do a reboot. If the tool is not able to reboot your Lenovo you might have to hold the power button for 10sek. to shut it down manually. Do this only when the flashing process finished succesfully!

* Go into the bios and load the default settings, to clear the CMOS. Save and Reboot.

Originally posted <nowiki>[[http://ubuntuforums.org/showthread.php?t=1867367|The Ubuntu Forums (ubuntuforums.org)]]</nowiki>	
