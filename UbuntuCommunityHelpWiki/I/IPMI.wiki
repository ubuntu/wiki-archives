{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

This page is about setting up IPMI on ubuntu.

=== Ubuntu Packages ===
The information about Ubuntu packages applies to all manufacturers. 

Two packages offer IPMI support in Ubuntu:
* '''openipmi''' - officially supported starting with ubuntu 8.04
* '''ipmitools''' - not officially supported

Once installed, the following files may help you configure and personalize your '''ipmitools''' package install:
# /usr/share/ipmitool/ipmi.init.basic
# /usr/share/doc/ipmitool/README.gz

To uncompress the .gz file and view it:
<pre>
zcat /usr/share/doc/ipmitool/README.gz|less
</pre>

=== Specific manufacturer information ===
==== Dell ====
See above information about Ubuntu packages.

As a general rule, always take notes on current settings and backup any files being modified.

Read through the following bug report for important information:
https://bugs.launchpad.net/ubuntu/+source/ipmitool/+bug/110992

Once installed the IPMI tools package provides several commands. Some examples:

'''Local IPMI access verification'''

<pre>
 ipmitool -I open channel info 
</pre>

'''System Events Log (SEL)'''

<pre>
 ipmitool -I open sel list
</pre>

Example:
<pre>
 8b | 07/15/2007 | 20:50:22 | Power Supply #0x42 | Power Supply AC lost
 8c | 07/15/2007 | 20:50:22 | Power Supply #0x53 | Redundancy Lost
 8d | 07/15/2007 | 21:16:58 | Physical Security #0x52 | General Chassis intrusion
 8e | 07/15/2007 | 21:17:03 | Power Supply #0x42 | Failure detected
 8f | 07/15/2007 | 21:17:03 | Power Supply #0x42 | Power Supply AC lost
 90 | 07/15/2007 | 21:17:03 | Power Supply #0x53 | Redundancy Lost}}}

RAID problem example:
<pre>
 b5 | 11/05/2007 | 03:09:27 | Slot/Connector #0x55 | Fault Status Asserted
 b5 | 12/24/2007 | 03:32:52 | Slot/Connector #0x55 | Fault Status Asserted}}}

'''Power off''' (simulates a "critical high temperature event")

<pre>
 ipmitool -vI lan -H 192.168.5.250 -U root -a chassis power soft
</pre>

'''Hard reset'''

<pre>
 ipmitool -vI lan -H 192.168.5.250 -U root -a chassis power reset
</pre>

'''Full Dell documentation'''

* http://www.dell.com/downloads/global/power/ps4q04-20040204-Murphy.pdf

==== SuperMicro P8SCi ====

See above information about Ubuntu packages.

As a general rule, always take notes on current settings and backup any files being modified.

In your BIOS settings:
# Enable "Console Redirection" in BIOS Setup. For example, COM2 / 19.2Kbps / 8N1
# Disable "Enable Console Redirection after POST" in BIOS setup.

'''Editing your boot options in GRUB '''

1) Add the following two lines to /boot/grub/menu.lst (carefully check that the double hyphen is not converted to a single one if using copy & paste):

<pre>
serial --unit=1 --speed=19200 --word=8 --parity=no --stop=1
terminal --timeout=10 serial console}}}

If using XEN, also find and modify the following line to read as:

<pre>

2) Change the following line (while KEEPING the hash at its beginning):

<code># defoptions=quiet splash</code>

to

<code># defoptions=nosplash console=tty0 serial console=ttyS1,19200n8</code>

3) Change the following line (while KEEPING the hash at its beginning) to:

<code># altoptions=(recovery mode) single console=tty0 serial console=ttyS1,19200n8</code>

4) Save the file, then run this command to commit your changes:

<code>sudo update-grub</code>

5) Then:

<pre>
cd /etc/event.d
sudo cp tty1 ttyS0
sudo nano ttyS0 </pre>

This last command uses nano but you can use any editor.

Edit the /etc/event.d file so at the end the line invoking getty reads as:

<code>exec /sbin/getty 19200 ttyS0</code>

6) Do the same for ttyS1:

<pre>
sudo cp tty1 ttyS1
sudo nano ttyS1</pre>

Edit that file so at the end the line invoking getty reads as:

<code>exec /sbin/getty 19200 ttyS1</code>

7) Now, edit /etc/securetty to add ttyS1 (near the beginning) after the following line:
<pre>
ttyS0
ttyS1 
</pre>

===== SuperMicro update =====
Above instructions work nicely with some very minor changes with Ubuntu 9.04 on a new (April '09) !SuperMicro X8 (Xeon 5500) motherboard with built-in WinBond WPCM450 BMC controller:
* AMI BIOS defaults to 115200 baud.
* `/etc/securetty` has `ttyS1` defined already, and is now labelled 'Standard serial ports'
The network setup for the BMC is done in `Advanced` -> `IPMI Configuration` -> `Set LAN Configuration` in the BIOS. It defaults to DHCP, so generally it will just work. Once it's set up you can point a web browser at it (HTTP or HTTPS) or an ssh terminal. The default login is `ADMIN` / `ADMIN`.

== References ==
* http://wiki.adamsweet.org/doku.php?id=ipmi_on_linux
* http://www.ecst.csuchico.edu/~dranch/LINUX/IPMI/ipmi-on-linux.html - Howto Supermicro
