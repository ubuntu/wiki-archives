{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__


''Aquest document també està en Català : <nowiki>[[WifiDocs-Acer5021WLMi_Amd64-Catala]]</nowiki>''

''También hay este documento en Castellano : <nowiki>[[WifiDocs-Acer5021WLMi_Amd64-Castellano]]</nowiki>''

== Configuring the ACER 5021WLMi / Aspire 5020 wireless Broadcom card in Ubuntu 64 bits ==

  This can be a little bit difficult if you are new on Linux, but everyone is capable of making this card work. I encourage you to go through all these steps, and repeat them until they work and you understand every command perfectly. 

{i} I installed the network card just after install Ubuntu, if it doesn't work maybe is because you have another configuration over this one, just be sure that your system is clean.

=== Be the root user ===

  Open a terminal from 'Applications > Accessories > Terminal' and type:
  {{{
  sudo -s
  }}}
  Then enter your normal user password. If you do not get a root prompt then you need to ask someone to add you to the admin  group. Running this command will save you from entering sudo before each command.
  

=== Install the headers and the essentials ===

  First of all you have to install the Linux headers, and the build-essential packages. You need them because you will have to execute the 'make' and 'make install' commands. 
  To do this :

## Go to 'System > Administration > Synaptic'
## Search : build-essential, and install this package
## Search : Linux headers, and install all the results similar to : 
*** linux-headers-..., linux-kernel-headers, linux-source-... 
{i} you understand -... is some variable text. I'm not sure if the last one is really necessary

=== Install GCC-3.4 ===

  Install GCC-3.4, necessary to compile the 'acer_acpi' source.

  1. Download these packages from Ubuntu :
*** gcc-3.4-base_3.4.4-6ubuntu8_amd64.deb
*** gcc-4.4-base_3.4.4-6ubuntu8_amd64.deb
*** cpp-3.4_3.4.4-6ubuntu8_amd64.deb
*** gcc-3.4_3.4.4-6ubuntu8_amd64.deb

	You can find these files searching a little bit in : http://packages.ubuntu.com/breezy/devel/

<!> To install these packages use the next commands in the directory where you downloaded them :

  {{{
  dpkg -i gcc-3.4-base_3.4.4-6ubuntu8_amd64.deb
  dpkg -i gcc-4.4-base_3.4.4-6ubuntu8_amd64.deb
  dpkg -i cpp-3.4_3.4.4-6ubuntu8_amd64.deb
  dpkg -i gcc-3.4_3.4.4-6ubuntu8_amd64.deb
  }}}

=== Install 'ndiswrapper' ===

  Install 'ndiswrapper', this application will let you to use Windows 64 bits drivers for Broadcom wireless card in Ubuntu

{i} I recommend to install from Ubuntu repository directly because the official 'ndiswrapper' release doesn't work for me

## Go to: 'System>Administration>Synaptic'
## Search : ndiswraper, and install the package ndiswrapper-utils'
   {i} (This document has been tested with the version 'ndiswrapper 1.1-4ubuntu2')
  1. Download the drivers from Acer, use these links :
*** ftp://ftp.support.acer-euro.com/notebook/aspire_3020_5020/driver/winxp64bit/80211g.zip  
*** ftp://ftp.support.acer-euro.com/notebook/aspire_3020_5020/driver/winxp64bit/
## In one terminal go to the unzipped directory where the files are
## Execute the next commands into the terminal to install the drivers :
  {{{
  ndiswrapper -i bcmwl5.inf
  }}}
  
  Check if driver loaded ok with this command:
  {{{
  ndiswrapper -l
  }}}

<nowiki>[[File:IconsPage/example.png]]</nowiki>
  If everything is ok you should see output like this
  {{{
  Installed ndis drivers:
  {name of driver}  driver present, hardware present
  }}}
  
  (Dapper users! Before running the next command run rmmod bcm43xx! This should be done to remove the kernel Broadcom driver from loaded modules!)
  Now we need to insert the module into the kernel with this command:
  {{{
  modprobe ndiswrapper
  }}}

  Check if load went ok with this command:
  {{{
  dmesg | tail -n 6
  }}}

  Now you should be able to scan for your access point:
  {{{
  iwlist wlan0 scan
  }}}
{i} If you have the Acer 5021WLMi the result now will be :	<code>wlan0     No scan results</code>

=== Install 'acer_acpi' ===

  If you did get no scan results, the following will solve that for you.

  Install 'acer_acpi' module, this must be done because the acer button in front of the computer doesn't work for Linux, the next steps will make the wireless card work by software like if you activate the card by pressing the button.

  1. Download acer_acpi from : http://www.archernar.co.uk/acer_acpi/acer_acpi_main.html
   {i} My version is acer_acpi-0.3 and is working perfectly
## Untar the files like you always do with Ubuntu and in the terminal go to these files directory
## Execute the next commands :
  {{{
  make
  make install
  }}}
{i} You won't see any error if GCC-3.4 and Linux headers are installed properly

  then to activate the acer_acpi module run this command:
  {{{
  modprobe acer_acpi
  }}}

  Next we want to go to the acpi directory"
  {{{
  cd /proc/acpi/acer/
  }}}

  We are changing  permission of a file so any user can change wireless state:
  {{{
  chmod 777 ./wireless
  }}}

  Now run this command:
  {{{
  echo "enabled: 1" >/proc/acpi/acer/wireless
  }}}
  {i} ''If response is : <code>bash: /proc/acpi/acer/wireless: Permission denied</code>, the permissions of the files are not all wright, repeat the chmod step. You may have to repeat this line a couple of times to make it work, you know acer things are crazy :)

  Check dmesg:
  {{{
  dmesg
  }}}
{i} If you see this line: <code>[ 2211.470445] acer_acpi: Wireless value 1</code>, then every thing is all right.

  Now let's try to scan again:
  {{{
  iwlist wlan0 scan
  }}}
{i} This time you will see the wireless information of local ap's, and your card is working ! 

=== Make your wireless work ===

  To make your wireless connection work every time you open your computer, execute these commands in a terminal:

  {{{
  modprobe acer_acpi
  chmod 777 /proc/acpi/acer/wireless
  echo "enabled: 1" >/proc/acpi/acer/wireless
  }}}
  
## Go to 'System>Administration>Networking' and 'deactivate' all the interfaces:
## Choose your wireless connection with these properties:
*** Enable option must be activated
*** ESSID must have the name of your wireless network
*** Key type (for me only works in hexadecimal mode with the hexadecimal value)
*** WEP key (in my case the hexadecimal value of the key, I got it from my router)
*** Configuration : DHCP (Maybe you don't use DHCP, who knows?)
## Push OK
## Activate the 'Wireless connection'
## Set 'Default gateway device' to 'wlan0'
## Check your connection
  {{{
  ping -c 3 www.ubuntulinux.org
  }}}
{i} You must receive packets in return.

<nowiki>[[File:IconsPage/example.png]]</nowiki>
  Example of good output:
  {{{
  PING www.ubuntulinux.org (82.211.81.166) 56(84) bytes of data.
  64 bytes from signey.ubuntu.com (82.211.81.166): icmp_seq=1 ttl=46 time=139 ms
  64 bytes from signey.ubuntu.com (82.211.81.166): icmp_seq=2 ttl=46 time=106 ms
  64 bytes from signey.ubuntu.com (82.211.81.166): icmp_seq=3 ttl=46 time=95.4 ms
  --- www.ubuntulinux.org ping statistics ---
  3 packets transmitted, 3 received, 0% packet loss, time 2000ms
  rtt min/avg/max/mdev = 95.463/113.655/139.475/18.761 ms
  }}}

=== Create one init script ===

  If you don't want to activate the acer_acpi module every time you turn on your computer, you can create one script :

  {{{
  cd /etc/init.d
  gedit wirelessAcerAcpi
  }}}

  Add the following text into the file, save it in /etc/init.d/ and close gedit :

  {{{
## !/bin/sh

  case "$1" in

	start|"")

		modprobe ndiswrapper

		modprobe acer_acpi

		chmod 777 /proc/acpi/acer/wireless

		echo "enabled: 1" >/proc/acpi/acer/wireless

		;;

	stop)

		echo "enabled: 0" >/proc/acpi/acer/wireless

		;;

  esac
  }}}

  Execute the next commands :
  {{{
  chmod 755 /etc/init.d/wirelessAcpi
  cd /etc/rc2.d
  }}}
{i} This is the default starting commands in Ubuntu Breezy

  This command will create a link to the acer_acpi starting script:
  {{{
  ln -s ../init.d/wirelessAcerAcpi S99wirelessAcerAcpi
  }}}
{i} In the wiki <code>S99wirelessAcerAcpi</code> text is a link, I don't know why, just write the line in the terminal

=== Every time you want to connect to one network ===

  Next time you turn on your computer, you only have to set the data in 'System>Administration>Networking'

{i} I suggest you create different profiles for every network you are going to use, this way it will be easier to turn on the wireless network.

=== Sop being Root ===

  At the begininng we set up the terminal to be root user, it's a good idea to exit this and become a normal user again if you don't close down the terminal. You can exit root user by this command;
  {{{
  exit
  }}}

If you want to contact the author : 
----
CategoryNetworking
