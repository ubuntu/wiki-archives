{|
  | '''Warning'''
  * This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
  * '''Images''' and '''attachments''' have been removed to conserve space.
  * '''Links''' may not work and there may be formatting issues.
  * A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__


This page explains how to enable use of <nowiki>[[http://en.wikipedia.org/wiki/Wake-on-LAN|Wake-on-LAN]]</nowiki> (WoL) in systems that have Ubuntu installed.
== Introduction ==
{| class="wikitable"
|-
| <tablestyle="float:right; font-size: 0.9em; width:40%; background:#F1F1ED; margin: 0 0 1em 1em;" style="padding:0.5em;"><<BR>>
|}

Wake-on-LAN enables users to turn on a computer across a network from another network device. It can be very useful in situations where computers are not all next to each other or there are a lot of machines. WoL works by sending a packet of data called a Magic Packet™ to the target machine. When the packet is received, the target machine's network device (Network Interface Controller or NIC) wakes-up the rest of the machine.

== Setting Up Wake-on-LAN ==
In order to use WoL it must be supported and enabled as necessary in the BIOS, NIC and other network hardware (routers, switches etc). You may also need to configure some software if things don't work out-of-the-box.

=== Enabling WoL in the BIOS ===
This section may differ depending on whether or not you have a NIC integrated into your motherboard.

==== Using an Integrated NIC ====
To enable WoL in the BIOS, enter the BIOS setup and look for something called "Wake up on PCI event", "Wake up on LAN" or similar. Change it so that it is enabled. Save your settings and reboot.

==== Using a Non-Integrated NIC ====
If your NIC is not integrated into your motherboard, you will still have to configure your BIOS to allow devices to wake up your computer. Boot your computer and enter the BIOS settings menu. In one of the sub-menus there will hopefully be the option to allow USB and/or PCI devices to wake-up the computer. Enable the setting that is appropriate for your NIC. Save your settings and reboot.

PCI NICs sometimes require a cable connection to the power supply in order to stay awake when the computer is off/asleep. Check your manual to see if yours does and install if necessary.

=== Enabling WoL in the NIC ===

==== Determining whether the NIC supports WoL ====
First, determine which NIC will be used, and then check whether it supports the Magic Packet™ using

<pre>
sudo ethtool <NIC>
</pre>

where <NIC> is the device name of your NIC, e.g. <code>eth0</code>. This command will output some information about your the capabilities of your NIC. If this output contains a line similar to the following:

<pre>
Supports Wake-on: <letters>
</pre>

where <code><letters></code> contains the letter <code>g</code>, the NIC should support the WoL Magic Packet™ method (for the other letters look at `man ethtool`).

==== Enabling WoL in the NIC ====
To check whether WoL is enabled in the NIC, one could use

<pre>
sudo ethtool <NIC>
</pre>

and look for
<pre>
Wake-on: <letters>
</pre>

If <code><letters></code> contains <code>g</code> and not <code>d</code>, then Magic Packet™ is enabled. However, if <code><letters></code> does contain <code>d</code>, WoL needs to be enabled by running the following command:

<pre>
sudo ethtool -s <NIC> wol g
</pre>

On most systems, issuing this command is required after each boot. If the system's networking is configured via ifupdown, then it is easy to add the line <code>up ethtool -s <NIC> wol g</code> below the interface's configuration stanza in <code>/etc/network/interfaces</code>. For example:

<pre>
shahar@shahar-backup:~$ cat /etc/network/interfaces

auto lo
iface lo inet loopback

auto eth0
iface eth0 inet static
        address 10.0.0.1
        netmask 255.255.255.0
        gateway 10.0.0.138
        up ethtool -s eth0 wol g
</pre>

This will ensure that WoL is enabled in the NIC on each boot. Fore more information see the <code>interfaces</code> manual.

== Testing Wake-On-LAN ==
Test WoL by powering off the system and trying to send it the magic packet using:

=== Command-line tools ===
* <nowiki>[[https://launchpad.net/ubuntu/+source/etherwake|etherwake]]</nowiki>
* <nowiki>[[https://launchpad.net/ubuntu/+source/wakeonlan|Wakeonlan]]</nowiki>
* <nowiki>[[https://launchpad.net/ubuntu/+source/powernap|powerwake]]</nowiki>

=== GTK+ tool ===
* <nowiki>[[https://launchpad.net/ubuntu/+source/gwakeonlan|gWakeOnLan]]</nowiki>

== Configure other operating systems ==
If the system dual-boots with other operating systems, they should be configured to also enable or, at least, not disable WoL in the NIC. This is beyond the scope of this document but here's a <nowiki>[[http://social.technet.microsoft.com/Search/en-US?query=wake%20on%20lan&ac=8|starting point for Microsoft's OS's]]</nowiki>.

== Troubleshooting ==
If WoL is not working as expected, there are a number of lines of investigation to follow:

* Check that the power management options for your BIOS and NIC support WoL and are enabled as described above.
* Verify that the packets sent to wake the target computer are indeed reaching their intended desination.
** You may be able to verify the presence of packets by watching the network activity indicator LED on your switch or router. This is easier to see if you send multiple packets as you can count them.
* Ensure that no other network configuration software is interfering with WoL activity. <code>network-manager</code> may interfere with WoL activity in certain situations; removing it and configuring your network manually may solve some issues.
* Read and follow steps in <nowiki>[[https://bugs.launchpad.net/ubuntu/+source/ifupdown/+bug/981461 | Launchpad Bug 981461]]</nowiki>

== External Links ==
* <nowiki>[[http://support.amd.com/TechDocs/20213.pdf| Magic Packet Technology]]</nowiki> - A white paper describing the specification and implemenation of Magic Packet™ technology from AMD, one of its two co-developers.
----
CategoryNetworking CategoryPowerManagement
