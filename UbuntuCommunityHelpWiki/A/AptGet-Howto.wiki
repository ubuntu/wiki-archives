{|
  | '''Warning'''
  * This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
  * '''Images''' and '''attachments''' have been removed to conserve space.
  * '''Links''' may not work and there may be formatting issues.
  * A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__



{i} This article applies to all supported versions of Ubuntu
== Package management with APT ==
<nowiki>[[File:IconsPage/apt.png]]</nowiki>
Package management via apt-get runs hand-in-hand with the ''/etc/apt/sources.list'' file.  For information on editing or updating your sources list see <nowiki>[[SourcesList]]</nowiki>.

=== Introduction ===
This page describes how to handle the packages on your system using apt-get and related commands. For example, you can install a new package, remove an installed package, or update all installed packages to the latest versions.

=== Commands ===
{| class="wikitable"
|-
| <rowbgcolor="#FFFCC"> <nowiki>[[File:IconsPage/info.png]]</nowiki> All these commands except the search commands must be run as root or with superuser privileges, see <nowiki>[[RootSudo|sudo]]</nowiki> for more information.
|}
  <nowiki>[[File:IconsPage/example.png]]</nowiki> Example:
<pre>
sudo apt-get install ubuntu-desktop </pre>

==== Installation commands ====
* <pre>
apt-get install <package_name> </pre> This command installs a new package.
* <pre>
apt-get build-dep <package_name> </pre> This command searches the repositories and installs the build dependencies for <package_name>. If the package is not in the repositories it will return an error.
* <pre>
aptitude install <package_name></pre> Aptitude is an <nowiki>[[http://en.wikipedia.org/wiki/Ncurses| Ncurses]]</nowiki> viewer of packages installed or available. Aptitude can be used from the command line in a similar way to apt-get. Enter <code>man aptitude</code> for more information.
* APT and aptitude will accept multiple package names as a space delimited list. For example:
 <pre>
apt-get install <package1_name> <package2_name> <package3_name></pre>
{| class="wikitable"
|-
| <nowiki>[[File:IconsPage/note.png]]</nowiki> Use the -s flag to simulate an action. For example: "apt-get -s install <package_name>" will simulate installing the package, showing you what packages will be installed and configured.
|}

===== auto-apt =====
* <pre>
auto-apt run <command_string></pre> This command runs <command_string> under the control of auto-apt. If a program tries to access a file known to belong in an uninstalled package, auto-apt will install that package using apt-get.  This feature requires ''apt'' and ''sudo'' to work.
* Auto-apt keeps databases which need to be kept up-to-date in order for it to be effective. This is achieved by calling the commands auto-apt update, auto-apt updatedb and auto-apt update-local.
* Usage example
        <nowiki>[[File:IconsPage/example.png]]</nowiki> You're compiling a program and, all of a sudden, there's an  error because it needs a file you don't have. The program auto-apt asks you to install packages if they're needed, stopping the relevant process and continuing once the package is installed. <pre>
### auto-apt run ./configure
</pre>It will then ask to install the needed packages and call apt-get automatically. If you're running X, a graphical interface will replace the default text interface.

==== Maintenance commands ====
* <pre>
apt-get update</pre> Run this command after changing ''/etc/apt/sources.list'' or ''/etc/apt/preferences'' . For information regarding ''/etc/apt/preferences'', see PinningHowto. Run this command periodically to make sure your source list is up-to-date.  This is the equivalent of "Reload" in Synaptic or "Fetch updates" in Adept.
* <pre>
apt-get upgrade</pre> This command upgrades all installed packages.  This is the equivalent of "Mark all upgrades" in Synaptic.
* <pre>
apt-get dist-upgrade</pre> The same as the above, except add the "smart upgrade" checkbox. It tells APT to use "smart" conflict resolution system, and it will attempt to upgrade the most important packages at the expense of less important ones if necessary. 
{| class="wikitable"
|-
| <nowiki>[[File:IconsPage/note.png]]</nowiki> "apt-get dist-upgrade" does not upgrade from a previous version of Ubuntu. For more information of upgrading from a previous version of Ubuntu see http://www.ubuntu.com/getubuntu/upgrading .
|}
* <pre>
apt-get check</pre> This command is a diagnostic tool. It does an update of the package lists and checks for broken dependencies.
* <pre>
apt-get -f install</pre> This command does the same thing as '''Edit->Fix Broken Packages''' in Synaptic. Do this if you get complaints about packages with "unmet dependencies".
* <pre>
apt-get autoclean</pre>  This command removes .deb files for packages that are no longer installed on your system.  Depending on your installation habits, removing these files from ''/var/cache/apt/archives'' may regain a significant amount of diskspace.
* <pre>
apt-get clean</pre> The same as above, except it removes '''''all''''' packages from the package cache.  This may not be desirable if you have a slow Internet connection, since it will cause you to redownload any packages you need to install a program.
** The package cache is in ''/var/cache/apt/archives'' .  The command <pre>
du -sh /var/cache/apt/archives</pre> will tell you how much space cached packages are consuming.
* <pre>
dpkg-reconfigure <package_name></pre> Reconfigure the named package. With many packages, youâ€™ll be prompted with some configuration questions you may not have known were there.
  <nowiki>[[File:IconsPage/example.png]]</nowiki> For example: <pre>
dpkg-reconfigure fontconfig-config</pre> will present you with a "wizard" on configuring fonts in Ubuntu.
* <pre>
echo "<package_name> hold" | dpkg --set-selections</pre> This command places the desired package on hold.  /* TODO: Bug #42178: This is the same as Synaptic's '''Package->Lock Version'''. */

{| class="wikitable"
|-
| <rowbgcolor="#FFFCC"> <nowiki>[[File:IconsPage/info.png]]</nowiki> This command may have the unintended side effect of preventing upgrades to packages that depend on updated versions of the pinned package. <code>apt-get dist-upgrade</code> will override this, but will warn you first. If you want to use this command with sudo, you need to use  <code>echo "<package_name> hold" | sudo dpkg --set-selections</code>  ''not'' <code>sudo echo "<package_name> hold" | dpkg --set-selections</code>.
|}
* <pre>
echo "<package_name> install" | dpkg --set-selections</pre> This command removes the "hold" or "locked package" state set by the above command. The note above about sudo usage applies to this command.
==== Removal commands ====
* <pre>
apt-get remove <package_name></pre> This command removes an installed package, leaving configuration files intact.
* <pre>
apt-get purge <package_name></pre> This command completely removes a package and the associated configuration files. Configuration files residing in ~ are not usually affected by this command.
** + operator
    <nowiki>[[File:IconsPage/example.png]]</nowiki> If you want to remove package1 and install package2 in one step: <pre>
apt-get remove <package1> <package2>+</pre>.
* <pre>
apt-get autoremove</pre> This command removes packages that were installed by other packages and are no longer needed.
** <pre>
apt-get autoremove <package_name></pre> This command removes an installed package and dependencies.
* While there is no built in way to remove all of your configuration information from your removed packages you can remove all configuration data from every removed package with the following command.<pre>
dpkg -l | grep '^rc' | awk '{print $2}' | xargs dpkg --purge</pre>

==== Search commands ====
* <pre>
apt-cache search <search_term></pre> Each package has a name and a description. This command lists packages whose name or description contains <search_term>.

* <pre>
dpkg -l *<search_term>*</pre> This will find packages whose names contain <search_term>.  Similar to <code>apt-cache search</code>, but also shows whether a package is installed on your system by marking it with '''ii''' (installed) and '''un''' (not installed).
* <pre>
apt-cache show <package_name></pre> This command shows the description of package <package_name> and other relevant information including version, size, dependencies and conflicts.
* <pre>
dpkg --print-avail <package_name></pre> This command is similar to "apt-cache show".
* <pre>
dpkg -L <package_name></pre> This command will  list files in package <package_name>.
* <pre>
dpkg -c foo.deb</pre>  This command lists files in the package  "foo.deb". Note that ''foo.deb'' is a '''pathname'''.  Use this command on .deb packages that you have manually downloaded.
* <pre>
dlocate <package_name></pre> This command determines which installed package owns <package_name>.  It shows files from installed packages that match <package_name>, with the name of the package they came from. Consider this to be a "reverse lookup" utility.
{| class="wikitable"
|-
| <nowiki>[[File:IconsPage/info.png]]</nowiki> In order to use this command, the package '''dlocate''' must be installed on your system.
|}
* <pre>
dpkg -S <filename_search_pattern></pre> This command does the same as <code>dlocate</code>, but does not require the installation of any additional packages. It is slower than <code>dlocate</code> but has the advantage of being installed by default on all Debian and Ubuntu systems.
* <pre>
apt-file search <filename_search_pattern></pre> This command acts like <code>dlocate</code> and <code>dpkg -S</code>, but searches all available packages. It answers the question, "what package provides this file?".
** apt-file needs to be updated regularly like apt-get. Use the command: <pre>
apt-file update</pre>
{| class="wikitable"
|-
| <nowiki>[[File:IconsPage/info.png]]</nowiki>  In order to use this command, the package '''apt-file''' must be installed on your system.
|}
* <pre>
apt-cache pkgnames</pre> This command provides a listing of every package in the system
* A general note on searching: If searching generates a list that is too long, you can filter your results by piping them through the command <code>grep</code>.  Examples:
** <pre>
apt-cache search <filename> | grep -w <filename></pre>  will show only the files that contain <filename> as a whole word
** <pre>
dpkg -L package | grep /usr/bin </pre> will list files located in the directory /usr/bin, useful if you're looking for a particular executable.

For more information on apt-get, apt-cache and dpkg consult their manual pages by using the <code>man</code> command.  These manuals will provide a wider scope of information in addition to all of the options that you can use with each program.
 <nowiki>[[File:IconsPage/example.png]]</nowiki> Example: <pre>
man apt-get</pre>.

=== Typical usage example ===
I want to feel the wind in my hair, I want the adrenaline of speed. So let's install a racing game.  But what racing games are available?
<pre>
apt-cache search racing game</pre>
It gives me a lot of answers. I see a game named "torcs".  Let's get some more information on this game.
<pre>
apt-cache show torcs</pre>
Hmmm... it seems interesting. But is this game not already installed on my computer? And what is the available version? Which repository is it from (Universe or Main)?
<pre>
apt-cache policy torcs</pre>
Ok, so now, let's install it!
<pre>
apt-get install torcs</pre>
What is the command I must type in the console to launch this game? In this example, it's straightforward ("torcs"), but that's not always the case. One way of finding the name of the binary is to look at what files the package has installed in "/usr/bin".  For games, the binary will be in "/usr/games". For administrative programs, it's in "/usr/sbin".
<pre>
dpkg -L torcs | grep /usr/games/</pre>
The first part of the command display all files installed by the package "torcs" (try it). With the second part, we ask to only display lines containing "/usr/games/".

Hmmm, that game is cool. Maybe there are some extra tracks?
<pre>
apt-cache search torcs</pre>
But I'm running out of space. I will delete the apt cache!
<pre>
apt-get clean</pre>
Oh no, my mother asked me to remove all games from this computer. But I want to keep the configuration files so I can simply re-install it later.
<pre>
apt-get remove torcs</pre>
If I want to also remove config files :
<pre>
apt-get purge torcs</pre>

=== Setting up apt-get to use a http-proxy ===
These are three methods of using apt-get with a http-proxy.

==== Temporary proxy session ====
This is a temporary method that you can manually use each time you want to use apt-get through a http-proxy. This method is useful if you only want to temporarily use a http-proxy.

Enter this line in the terminal prior to using apt-get (substitute your details for yourproxyaddress and proxyport).

<pre>
export http_proxy=http://yourproxyaddress:proxyport</pre>

If you normally use sudo to run apt-get you will need to login as root first for this to work unless you also add some explicit environment settings to /etc/sudoers, e.g.

<pre>
Defaults env_keep = "http_proxy https_proxy ftp_proxy"</pre>

==== APT configuration file method ====
This method uses the apt.conf file which is found in your '''/etc/apt/''' directory. This method is useful if you only want apt-get (and not other applications) to use a http-proxy permanently.

{| class="wikitable"
|-
| <nowiki>[[File:IconsPage/info.png]]</nowiki> On some installations there will be no apt-conf file set up.  This procedure will either edit an existing apt-conf file or create a new apt-conf file.
|}

<pre>
gksudo gedit /etc/apt/apt.conf</pre>

Add this line to your ''/etc/apt/apt.conf'' file (substitute your details for yourproxyaddress and proxyport).

<pre>
Acquire::http::Proxy "http://yourproxyaddress:proxyport";</pre>

Save the apt.conf file.

==== BASH rc method ====
This method adds a two lines to your .bashrc file in your $HOME directory. This method is useful if you would like apt-get and other applications for instance wget, to use a http-proxy.

<pre>
gedit ~/.bashrc</pre>
Add these lines to the bottom of your ''~/.bashrc'' file (substitute your details for yourproxyaddress and proxyport)

<pre>
http_proxy=http://yourproxyaddress:proxyport
export http_proxy</pre>

Save the file. Close your terminal window and then open another terminal window or source the ''~/.bashrc'' file:
<pre>
source ~/.bashrc</pre>
Test your proxy with sudo apt-get update and whatever networking tool you desire.  You can use firestarter or conky to see active connections.

If you make a mistake and go back to edit the file again, you can close the terminal and reopen it or you can source '' ~/.bashrc'' as shown above.
<pre>
source ~/.bashrc</pre>

==== How to login a proxy user ====
If you need to login to the Proxy server this can be achieved in most cases by using the following layout in specifying the proxy address in http-proxy.
(substitute your details for username, password, yourproxyaddress and proxyport)

<pre>
http_proxy=http://username:password@yourproxyaddress:proxyport</pre>

=== Useful additional packages ===
* <nowiki>[[http://packages.ubuntu.com/search?keywords=deborphan|Deborphan]]</nowiki>
* <nowiki>[[http://packages.ubuntu.com/search?keywords=debfoster|Debfoster]]</nowiki>

=== Additional links ===
* <nowiki>[[Repositories-CommandLine]]</nowiki>
* <nowiki>[[PinningHowto]]</nowiki>
* <nowiki>[[https://wiki.ubuntu.com/AutoDeb|AutoDeb]]</nowiki>
* <nowiki>[[SynapticHowto|Synaptic Package Manager]]</nowiki>
* <nowiki>[[http://ubuntuforums.org/forumdisplay.php?f=333|Ubuntu Community Forums: Installations and Upgrades]]</nowiki>
* <nowiki>[[https://askubuntu.com/questions/52243/what-is-apt-fast-and-should-i-use-it|What is apt-fast and should I use it?]]</nowiki>

=== Troubleshooting ===
 https://help.ubuntu.com/community/PackageManagerTroubleshootingProcedure

----
CategoryPackageManagement CategoryCommandLine
