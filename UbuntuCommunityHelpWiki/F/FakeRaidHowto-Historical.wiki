{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__



This guide is for older, unsupported version of Ubuntu and is being kept for historical reference only.

== Ubuntu 9.04 (Jaunty Jackalope) ==
=== Alternate CD Installation ===
/!\ '''MAKE SURE YOU BACK UP ANYTHING OF IMPORTANCE!!!'''

Intrepid users and up can now install directly to SATA RAID with no additional setup or configuration required. The installer will prompt you to activate the RAID partitions, which will make them available to the partitioner and allow you to continue with the installation as normal.<<BR>>

After defragmenting your existing fakeRAID system and resizing the volume to free space, load the Alternate CD.

==== Install Options ====
When Ubuntu splash screen loads, choose the default choice ''Install Ubuntu''.
==== Language ====
Choose the default language for your installation.
==== Keyboard Layout ====
Select your keyboard layout.
==== Hardware ====
* -|Detecting Hardware|- watch the screen
* -|Scanning CD - ROM|-  or not
* -|Loading additional components|-
* -|Detecting network|-
* -|configuring the network with DHCP|-
==== Network ====
Enter a host name.
==== Time Zone ====
Select your time zone.
==== Disk Detection ====
* -| Detecting disks and all other hardware |-
* -| [!] Detect Disks |-

/!\ '''If the following doesn't appear this method will likely fail to load the Linux fakeRAID support and this method is not for you!'''

"One or more drives containing Serial ATA RAID configurations have been found.  Do you wish to activate these RAID devices?"
Select ''yes''.

==== Partition ====
* -| [!!] Partition Disks |- 
{| class="wikitable"
|-
| <#FF0000>Guided - resize serial ATA RAID isw_chihadihib_ARRAY3 (partition
|}
 The following assumes you picked Manual
* -| [!!] Partition Disks |- 
{| class="wikitable"
|-
| <#FF0000>Guided partitioning
|}
<pre>
serial ATA RAID isw_chihadihib_ARRAY3 () - 640.1 GB Linux device-m
# 1 primary 74.0 MB fat 16
# 2 primary 16.1 GB ntfs
# 3 primary 334.4 GN B ntfs
 pri/log 289.5 GB FREE SPACE
</pre>
 the following assumes you pick the free space you emptied in Windows pri/log 289.5 GB FREE SPACE
* -| [!!] Partition Disks |- 
{| class="wikitable"
|-
| <#FF0000>Create a new partition
|}
* -| [!!] Partition Disks |- New partition size 
 the total free space will be selected BUT change it to allow for a swap partition at least the size of your RAM. In this example 277.7 GB to allow for a 11G swap partition
* -| [!!] Partition Disks |- 
{| class="wikitable"
|-
| <#FF0000> Logical
|}
* -| [!!] Partition Disks |- 
{| class="wikitable"
|-
| <#FF0000>Beginning
|}
* -| [!!] Partition Disks |- 
 strangely you chose "use as Ext3 journalling file system" if you want to change that option
* -| [!!] Partition Disks |- Ext3 journalling file system 
 chose Ext4 journalling file system if you prefer use as Ext4 journalling file system
* -| [!!] Partition Disks |- 
  leave the mount point / chose Done setting up the partition
* -| [!!] Partition Disks |- Guided partitioning
<pre>
serial ATA RAID isw_chihadihib_ARRAY3 () - 640.1 GB Linux device-m
logical 11.8 GB FREE SPACE
</pre>
 Choose logical 11.8 GB FREE SPACE
* -| [!!] Partition Disks |- 
{| class="wikitable"
|-
| <#FF0000>Create a new partition
|}
* -| [!!] Partition Disks |- New partition size 
{| class="wikitable"
|-
| <#FF0000>11.8 GB
|}
* -| [!!] Partition Disks |- 
 again select use as Ext3 journalling file system to change it
* -| [!!] Partition Disks |- tab to choose swap area
* -| [!!] Partition Disks |- tab to chose done setting up the partition
* -| [!!] Partition Disks |- Guided partitioning
<pre>
 serial ATA RAID isw_chihadihib_ARRAY3 () - 640.1 GB Linux device-m
# 1 primary 74.0 MB fat 16
# 2 primary 16.1 GB ntfs
# 3 primary 334.4 GN B ntfs
# 4 logical 277.7 GB f ext4 /
# 5 logical 11.8 GB f swap swap 
</pre>
/!\  '''Remember the partition that has Windows on it. In this case the third one on the first disk, which would be (hd0,2) as disks and partition numbers start at 0.'''

 Choose ''Finish Partitioning'' to write changes to disk.
* -| [!!] Partition Disks |- Write the changes to disk? tab to choose <Yes>
* -| Partitions formatting |- 

==== Finish the Install ====
39. -| Installing the base system |- watch the screen or not
40. -| [!!} Setup users and passwords|-  Full name of the new user  
 enter your name
41. -| [!} Setup users and passwords|- Username 
42. -| [!} Setup users and passwords|- Choose a password for the new user:
43. -| [!} Setup users and passwords|- Reenter password to verify:
44. -| [!} Setup users and passwords|- Encrypt home directory? 
{| class="wikitable"
|-
| <#FF0000> <No>
|}
45. -| Configuring apt |-
46. -| [!] Configure the package manager |- HTTP proxy 
 adjust or just hit enter
47. -| Configuring apt |-
48. -| Select and install software |- Retrieving file n of 863 Preparing x Configuring x ...
49. -| Configuring Grub |-
 '''If everything is to plan you will get a message such as:'''
 The following other operating systems have been detected
 Windows Vista (loader)
 Install the GRUB boot loader to the master boot record  
{| class="wikitable"
|-
| <#FF0000><Yes>
|}
* . -| Finishing the installation |- Ejecting CD ROM
* . -| [!!] Finish the installation |- Installation complete 
{| class="wikitable"
|-
| <#FF0000><Continue>
|}

At this point on boot Grub will either give you an option to boot into Windows or Ubuntu or just Ubuntu. If the installer fails (it did on two occasions for me) to provide a Windows boot option you have to add it manually to `/boot/grub/menu.lst`. Before making changes, backup the current version. Recall the Windows partition from above, in this case (hd0,2).
<pre>
sudo gedit /boot/grub/menu.lst
</pre>
Add the following menu option.
<pre>
title           Windows
rootnoverify (hd0,2)
makeactive
chainloader +1
</pre>

If you donâ€™t remember which partition has Windows find the mounted partitions.
<pre>
$ cd /dev/mapper/
$ ls
</pre>
Note the name of the RAID volume or array. For example, something like <code>isw_chihadihib_ARRAY</code>.
<pre>
$ sudo fdisk isw_chihadihib_ARRAY
Command (m for help): p

Disk isw_chihadihib_ARRAY: 640.1 GB, 640132714496 bytes
255 heads, 63 sectors/track, 77825 cylinders
Units = cylinders of 16065 * 512 = 8225280 bytes
Disk identifier: 0xb0000000

               Device Boot      Start         End      Blocks   Id  System
isw_chihadihib_ARRAY1               1           9       72261   de  Dell Utility
isw_chihadihib_ARRAY2              10        1968    15728640    7  HPFS/NTFS
isw_chihadihib_ARRAY3   *        1968       42628   326606844    7  HPFS/NTFS
isw_chihadihib_ARRAY4           42629       77825   282719902+   5  Extended
isw_chihadihib_ARRAY5           42629       76390   271193233+  83  Linux
isw_chihadihib_ARRAY6           76391       77825    11526606   82  Linux swap / Solaris

</pre>
In this case Windows is on the third partition, (hd0,2).

=== Live CD Installation (Ubiquity graphical installer) ===
/!\ '''MAKE SURE YOU BACK UP ANYTHING OF IMPORTANCE!!!'''

This Section shows you how to install Ubuntu using the Ubiquity graphical installer found on the Live CD.
# If you need more information about any given read any of the additional information below 
# Boot the Live CD
# Open a terminal
# Enter the following commands
    (skip the first one if you are doing RAID 0 or 1)
  a. <code>$ sudo modprobe dm-raid4-5</code>
  a. <code>$ sudo apt-get install -y dmraid</code>
  a. <code>$ sudo swapoff -a</code>  
     disables erroneous use of the backing swap partitions if you are reinstalling
  a. <code>$ sudo dmraid -ay</code>
1. Now check that you can view the partitions in the raid array with this command
  a. <code>$ ls -l /dev/mapper/</code> 
      OUTPUT: 
      <pre> 
control             isw_beeaakeeaa_five
      </pre>
      we will be using the array ''/dev/mapper/isw_beeaakeeaa_five'' in this example.
1. Create partitions on your raid array with your preferred partition manager, or do so using the partitioning tool provided in ubiquity (partitioning with ubiquity installer have not been tested)
  a. <code>$ sudo cfdisk /dev/mapper/isw_beeaakeeaa_five</code>
# We used ''/dev/mapper/isw_beeaakeeaa_five5'' partition as Ubuntu root partition in this example.
# Begin the install process
  a. If doing a guided install make sure you select the raid partition. if you are going to do a manual install make sure you do not create a partition on any of the disks that make up the raid partition. 
  a. On the last step before installing, click the ''Advanced options'' and uncheck the install boot loader option. We will install grub (the boot loader later).
  a. After installer finishes, close ubiquity installer without rebooting the machine.
1. Install dmraid and grub in your new Ubuntu installation:
  a. <code>$ sudo mount /dev/mapper/isw_beeaakeeaa_five5 /target/</code>
    '''if this fails maybe the /target directory is already mounted'''
    if not then some debuging will be required. If any more information can be provided related to this issue place add your knowledge to this document  
  a. <code>$ sudo mount --bind /dev /target/dev/</code>
  a. <code>$ sudo mount -t proc proc /target/proc/</code>
  a. <code>$ sudo mount -t sysfs sys /target/sys/</code>
  a. <code>$ sudo cp /etc/resolv.conf /target/etc/resolv.conf </code>
  a. <code>$ sudo chroot /target/</code>
  a. <code># apt-get update </code>
  a. <code># apt-get install -y dmraid</code>
  a. <code># apt-get install -y grub</code>
  a. <code># mkdir /boot/grub</code>
  a. <code># cp /usr/lib/grub/x86_64-pc/* /boot/grub/</code>
  a. <code># grub --no-curses</code>
  you will now be at the grub prompt ''grub>''
   i. <code> grub> device (hd0) /dev/mapper/isw_beeaakeeaa_five</code>
   i. <code> grub> find /boot/grub/stage1 </code>
     OUTPUT:

<pre>
find /boot/grub/stage1
(hd0,4)
     </pre>
    '''make a note of the output from this command it will be needed later.'''
    in my case I have my linux partition as the first extended partition you most likely will have different results (remember that grub starts partition numbers in zero, so partition 5 for linux is partition 4 for grub).
   i. <code> grub> root (hd'x','x')</code>
      '''replace 'x' with the partition number from the previous step '''
   i. Install grub on your disk (or partition if you prefer boot your computer with another boot manager)
1. <code> grub> setup (hd'x') </code>
      '''replace 'x' with the values gathered in the previous step ''' 
    or
       <code>grub> setup (hd'x','x')</code> to install grub on the partition. 

       '''YOU WILL NEED ANOTHER BOOT MANAGER TO START YOUR COMPUTER'''
   i. <code> grub> quit</code>
  a. <code># update-grub</code>
     say yes to creating a menu.lst
  a. now open the newly created menu list and make the following changes. Any editor can be used it is not required that you use nano <code># nano /boot/grub/menu.lst</code>
   i. Change
      <code># groot=(hd0,0)</code> TO <code># groot=(hd0,'x')</code>

      <code>root</code> option in the boot entries  to <code>root (hd0,'x')</code>
      
      Replace the 'x' with the partition that was found earlier
   i. Add the Windows boot entry if need be. <pre>
  title 		Windows
  rootnoverify (hd0,0)   # use the correct partition for Windows, of course
  makeactive
  chainloader +1</pre>
   i. For all Ubuntu-related boot entries, such as <pre>
   title	 Ubuntu ...
   root          (hd0,0)
   ...</pre>
   change <code>(hd0,0)</code> to <code>(hd'x','x')</code> (in my case, Linux partition was not the first one, and without these changes I would get grub "Error 17" after reboot). You can use the uuid of the mapped raid partition in a grub menu.lst uuid field instead of the root (hd'x','x') field; look in /dev/disk/by-uuid with 'ls -l'.
   i. Save and exit nano. or what ever text editor you are using.
  a. <code># update-grub</code>
1. make sure the new install of Ubuntu loads the raid module kernel 
  a. <code># echo dm-raid4-5 >> /etc/initramfs-tools/modules</code>
  a. <code># update-initramfs -u</code>
  a. <code># nano /etc/modules</code>
     and add 'dm-raid4-5' if not exists
1. Reboot and verify both Ubuntu and the existing Windows partition boot if Windows is installed. 

== Ubuntu 8.10 (Intrepid Ibex) ==
=== Alternate CD Installation ===
/!\ '''MAKE SURE YOU BACK UP ANYTHING OF IMPORTANCE!!!'''

{*} According to <nowiki>[[https://wiki.ubuntu.com/DmraidSupport|the latest FakeRAID spec]]</nowiki>, Intrepid users can now install directly to SATA RAID with no additional setup or configuration required. This is is not yet supported in the Ubiquity graphical installer so ''you must use the Alternate Install CD.'' The installer will prompt you to activate the RAID partitions, which will make them available to the partitioner and allow you to continue with the installation as normal.

=== Live CD Installation (Ubiquity graphical installer) ===
/!\ '''MAKE SURE YOU BACK UP ANYTHING OF IMPORTANCE!!!'''

'''In Short'''
* Boot the Ubuntu Live CD and select <code>Start Ubuntu without changes to the computer</code>
* From a terminal, run <code>sudo apt-get install dmraid</code>
* Check /dev/mapper to ensure the raid was correctly detected
* Run the installer (ubiquity), install as normal. Deselect installing grub - it will just fail anyway (but it makes no real difference if you don't)
* From a terminal, run <code>sudo chroot /target</code>
* Install dmraid to the new installation by running <code>sudo apt-get install dmraid</code> from the chroot environment.
* Install grub.

'''the following process has been successful on Nvidia and Intel fakeraid.'''
# Boot the Live CD
# Open a terminal
# Enter the following commands
## <code>ubuntu@ubuntu:~$ sudo apt-get install -y dmraid</code>
## <code>ubuntu@ubuntu:~$ sudo modprobe dm-raid4-5</code>
## <code>ubuntu@ubuntu:~$ sudo dmraid -ay</code>
       NOTE: If an "ERROR" is reported at this stage due to RAID failure. From the system menu, select administration, then load the Synaptics Package Manager. In the search/locate field type dmraid. When it finds the three entries, mark all for complete removal, And Apply. When it is done, simply select them again, and re-install. Problem Solved!
## <code>ubuntu@ubuntu:~$ cd /dev/mapper/</code>
## <code>ubuntu@ubuntu:/dev/mapper$ ls</code>
     OUTPUT:
     <pre>
control           isw_cdccfaedhh_Vol
     </pre>
     Make a note of the raid partition for use later. in this example the raid partitions name is isw_cdccfaedhh_Vol
# begin the install process
## if doing a guided install make sure you select the raid partition. if you are going to do a manual install make sure you do not create a partition on any of the disks that make up the raid partition. 
## on the last step before installing click the advanced options and uncheck the install boot loader option. we will install grub(the boot loader later)
# once the install has finished check to see what order you partition tables came out to be. By doing the following
## <code>ubuntu@ubuntu:/dev/mapper$ sudo fdisk isw_cdccfaedhh_Vol</code>
      you will now be taken to a prompt for fdisk. (the prompt will be "Command (m for help):")

1. <code>Command (m for help): p</code>
     OUTPUT:
  <pre>
Disk isw_cdccfaedhh_Vol: 1500.3 GB, 1500315648000 bytes
255 heads, 63 sectors/track, 182402 cylinders
Units = cylinders of 16065 * 512 = 8225280 bytes
Disk identifier: 0x000f28d8

             Device Boot      Start         End      Blocks   Id  System
isw_cdccfaedhh_Vol1               1        2490    20000893+   b  W95 FAT32
isw_cdccfaedhh_Vol2            2491      182402  1445143140    5  Extended
isw_cdccfaedhh_Vol5            2491        3735    10000431   83  Linux
isw_cdccfaedhh_Vol6            3736        4482     6000246   82  Linux swap / Solaris
isw_cdccfaedhh_Vol7            4483      182402  1429142368+  83  Linux

  </pre>
isw_cdccfaedhh_Vol1 Root partition
isw_cdccfaedhh_Vol5 Storage partition
isw_cdccfaedhh_Vol6 will be my windows partition
isw_cdccfaedhh_Vol7 Linux swap partition

1.#7 <code>ubuntu@ubuntu:/dev/mapper$ sudo mount isw_cdccfaedhh_Vol1 /target/</code>
  '''if this fails because the /target directory is busy reboot to the live cd and repeat all parts of step 4 until this command works.  Once you have access to /target then continue on'''

# <code>ubuntu@ubuntu:/dev/mapper$ sudo mount --bind /dev /target/dev/</code>
# <code>ubuntu@ubuntu:/dev/mapper$ sudo mount -t proc proc /target/proc/</code>
# <code>ubuntu@ubuntu:/dev/mapper$ sudo mount -t sysfs sys /target/sys/</code>
# <code>ubuntu@ubuntu:/dev/mapper$ sudo cp /etc/resolv.conf /target/etc/resolv.conf</code>
# <code>ubuntu@ubuntu:/dev/mapper$ sudo chroot /target/</code>
# <code>root@ubuntu:/# apt-get update</code>
# <code>root@ubuntu:/# apt-get install -y dmraid</code>
# <code>root@ubuntu:/# apt-get install -y grub</code>
# <code>root@ubuntu:/# mkdir /boot/grub</code>
# <code>root@ubuntu:/# cp /usr/lib/grub/x86_64-pc/* /boot/grub/</code>
# <code>root@ubuntu:/# grub --no-curses</code>
    this command will present you with the grub prompt.
    '''if you get an error then check your syntax.'''  Odds are you have typed something a little wrong so re-type or edit.
1. <code>grub> device (hd0) /dev/mapper/isw_cdccfaedhh_Vol</code>
  OUTPUT:
  <pre>
device (hd0) /dev/mapper/isw_cdccfaedhh_Vol
  </pre>
1. <code>grub> find /boot/grub/stage1</code>
  OUTPUT:
  <pre>
find /boot/grub/stage1
(hd0,0)
  </pre>
** make a note of this line you will need it later.
** in my case I have my Linux partition as the first partition you most likely will have different results 
1. <code>grub> root (hdx,x)</code>
** replace the x value with the values gathered in the previous step
1. <code>grub> setup (hdx)</code>
** replace x with the values gathered in the previous step
  OUTPUT:
  <pre>
setup (hd0)
Checking if "/boot/grub/stage1" exists... yes
Checking if "/boot/grub/stage2" exists... yes
Checking if "/boot/grub/e2fs_stage1_5" exists... yes
Running "embed /boot/grub/e2fs_stage1_5 (hd0)"...  16 sectors are embedded. succeeded
Running "install /boot/grub/stage1 (hd0) (hd0)1+16 p (hd0,0)/boot/grub/stage2/boot/grub/menu.lst"... succeeded

Done.
  </pre>
## <code>grub> quit</code>
# <code>root@ubuntu:/# update-grub</code>
    say yes to creating a munu.lst
   <pre>
Searching for GRUB installation directory ... found: /boot/grub
Searching for default file ... Generating /boot/grub/default file and setting the default boot   entry to 0
Searching for GRUB installation directory ... found: /boot/grub
Testing for an existing GRUB menu.lst file ... 

Could not find /boot/grub/menu.lst file. Would you like /boot/grub/menu.lst generated for you? (y/N) y
Searching for splash image ... none found, skipping ...
Found kernel: /boot/memtest86+.bin
Found kernel: /boot/vmlinuz-2.6.27-7-generic
Found kernel: /boot/memtest86+.bin
Updating /boot/grub/menu.lst ... done
    </pre>
# <code>root@ubuntu:/# nano /boot/grub/menu.lst</code>
# Changed 
    <pre>
    </pre>
 to 
    <pre>
    </pre>
  replace the x with the partition you found earlier.
# Changed this in the boot entries also.
# Add the Windows boot entry. If needed use the correct drive and partition for your Windows install. Replace the x's with the correct values
   <pre>
title 		Windows
rootnoverify (hdx,x)
makeactive
chainloader +1
</pre>
1. Changed the delay to a value that makes since for you and comment the 'hiddenmenu' option.
  Noted that savedefault was set to false.
# Save and exit nano.
# '''update-grub''' and kept the local file.
# Reboot and verify all operating system installations 

== Ubuntu 7.04 (Feisty Fawn) ==

{*} This procedure has been tested with Ubuntu 7.04 (Feisty Fawn). Your results may vary with other versions.
=== Install dmraid ===
==== GUI ====
* Boot the Ubuntu CD and select '''Start or Install Ubuntu'''
* Go to '''System > Administration > Software Sources''' and add the '''universe''' software repository (not required for 8.10 Intrepid or later).
* Go to '''System > Administration > Synaptic Package Manager''' and install the '''dmraid''' package.
* Go to '''Applications > Accessories > Terminal''' and run
<pre>
sudo dmraid -ay
</pre>
==== Command Line ====
Install from command line: <pre>
sudo apt-get install dmraid
</pre>
and run <pre>
sudo dmraid -ay
</pre>

/!\ If you get errors or <nowiki>[[FakeRaidDebug|"No RAID disks"]]</nowiki>, '''you need to repair these before you continue.'''
==== Optional: Resize your Windows partition ====
If you want to dual-boot windows, you may need to <nowiki>[[http://gentoo-wiki.com/HARDWARE_Dell_Precision_690#Repartition_RAID0_Storage_Array|resize your Windows partition]]</nowiki> to make space for Ubuntu. Most linux-based GUI tools won't properly work with fakeRAID devices, but the unix command-line combination of <code>ntfsresize</code> and <code>fdisk</code> is extremely reliable. Windows Vista users should use the <nowiki>[[http://vistarewired.com/2007/02/16/how-to-resize-a-partition-in-windows-vista|Vista Partition Manager]]</nowiki>. 
==== Partition the RAID Array ====

Before we can create file-systems (what Window users call "formatting"), we must slice the disk up into the partitions that hold those file-systems.

You can use GPartEd to create and delete partitions and file-systems if you like, but we do not recommend this because:
 a. at this time, it can not refresh the partition table after it modifies it, so you will need to change the partitions, then quit GPartEd, then run '''dmraid -ay''' from the command prompt to detect the new partitions, and then restart GPartEd before you can format the partitions.
 a. it generates a number of erroneous error messages that cause confusion and make it difficult to tell if the process was successful
 a. several people have become stuck at this point because of (a) and (b).

While it IS possible to use GPartEd (from the old releases) for this we recommend command-line utilities for partitioning (or a more recent GPartEd) and the creation of file-systems:

* fdisk: partitioning (and creation of file-systems on some platforms)
* parted: partitioning and creation of file-systems
* mkfs: creation of file-systems

At a minimum, this should include a root partition and a swap partition (this configuration is recommended for new users).  For a multi-user desktop, you may want root, swap, and home.
In my case, I wanted to isolate my Windows and Linux files at the primary partition level, so I created an extended partition to hold several logical linux partitions.  Also, I wanted a separate /boot partition as a security measure, so I created logical partitions for root, boot, and swap.  Also, since you can only have four primary partitions on a DOS-labelled disk, using an extended partition gives me the flexibility to add more linux partitions later if I want them.  If I decide to serve web apps or something, I might want logical partitions for boot, root, swap, tmp, var, usr, and home.

{| class="wikitable"
|-
| Partition
| File-system
| Size
| Description
|-
| /dev/hda1
| ext2
| 32M
| Boot partition
|-
| /dev/hda2
| (swap)
| 512M
| Swap partition
|-
| /dev/hda3
| ext3
| Rest of the disk
| Root partition
|}

or

{| class="wikitable"
|-
| Partition
| File-system
| Size
| Description
|-
| /dev/hda1
| ext2
| 32M
| Boot partition
|-
| /dev/hda2
| (swap)
| 512M
| Swap partition
|-
| /dev/hda3
| ext3
| 5G
| tmp
|-
| /dev/hda4
| ext3
| 5G
| var
|-
| /dev/hda5
| ext3
| 2G
| usr
|-
| /dev/hda6
| ext3
| 2G
| home
|-
| /dev/hda7
| ext3
| Rest of the disk
| Root partition
|}

Familiarize yourself with the tools by using the man pages (i.e., "man fdisk", "man parted", "man mkfs").  Work with partitions and file-systems as root (sudo) or the kernel may not be able to re-read the partition table until you reboot.
Create the partitions (the actual commands will vary depending on your choice of tool(s)).

A good source of information: http://www.linuxplanet.com/linuxplanet/tutorials/3174/1/

=== View Raid disk ===
<pre>
sudo dmraid -ay
</pre>
The result of my configuration
<pre>
RAID set "sil_aiaedgdcafah" already active
</pre>
{| class="wikitable"
|-
| <tablestyle="width:100%; text-align:center;background-color:#FFFFE0;">NOTE: In the following examples change '''/dev/mapper/via_hfciifae''' to your device e.g. '''/dev/mapper/sil_aiaedgdcafah'''
|}
=== Viewing the Current Partition Layout ===
Type p to display your disk's current partition configuration
<pre>
sudo fdisk /dev/mapper/via_hfciifae
Command (m for help): p
</pre>
=== Removing Partitions ===
{| class="wikitable"
|-
| <tablestyle="width:100%; text-align:center;background-color:#FFFFE0;">WARNING: Only remove partitions you don't want kept!
|}
We will first remove all existing partitions from the disk. Type d to delete a partition. For instance, to delete an existing /dev/mapper/via_hfciifae
<pre>
Command (m for help): d
Partition number (1-4): 1
</pre>
The partition has been scheduled for deletion. It will no longer show up if you type p, but it will not be erased until your changes have been saved. If you made a mistake and want to abort without saving your changes, type q immediately and hit enter and your partition will not be deleted.

Now, assuming that you do indeed want to wipe out all the partitions on your system, repeatedly type p to print out a partition listing and then type d and the number of the partition to delete it. Eventually, you'll end up with a partition table with nothing in it:
<pre>
Disk /dev/mapper/via_hfciifae: 30.0 GB, 30005821440 bytes
240 heads, 63 sectors/track, 3876 cylinders
Units = cylinders of 15120 * 512 = 7741440 bytes

Device Boot    Start       End    Blocks   Id  System

Command (m for help):
</pre>
Now that the in-memory partition table is empty, we're ready to create the partitions. We will use a default partitioning scheme as discussed previously. Of course, don't follow these instructions to the letter if you don't want the same partitioning scheme!
=== Creating the Boot Partition ===
We first create a small boot partition. Type n to create a new partition, then p to select a primary partition, followed by 1 to select the first primary partition. When prompted for the first cylinder, hit enter. When prompted for the last cylinder, type +32M to create a partition 32 Mbyte in size:
<pre>
Command (m for help): n
Command action
  e   extended
  p   primary partition (1-4)
p
Partition number (1-4): 1
First cylinder (1-3876, default 1): (Hit Enter)
Using default value 1
Last cylinder or +size or +sizeM or +sizeK (1-3876, default 3876): +32M
</pre>
Now, when you type p, you should see the following partition printout:

<pre>
Command (m for help): p

Disk /dev/mapper/via_hfciifae: 30.0 GB, 30005821440 bytes
240 heads, 63 sectors/track, 3876 cylinders
Units = cylinders of 15120 * 512 = 7741440 bytes

Device Boot    Start       End    Blocks   Id  System
/dev/?          1        14    105808+  83  Linux
</pre>
We need to make this partition bootable. Type a to toggle the bootable flag on a partition and select 1. If you press p again, you will notice that an * is placed in the "Boot" column.
=== Creating the Swap Partition ===
Let's now create the swap partition. To do this, type n to create a new partition, then p to tell fdisk that you want a primary partition. Then type 2 to create the second primary partition, /dev/hda2 in our case. When prompted for the first cylinder, hit enter. When prompted for the last cylinder, type +512M to create a partition 512MB in size. After you've done this, type t to set the partition type, 2 to select the partition you just created and then type in 82 to set the partition type to "Linux Swap". After completing these steps, typing p should display a partition table that looks similar to this:
<pre>
Command (m for help): p

Disk /dev/mapper/via_hfciifae: 30.0 GB, 30005821440 bytes
240 heads, 63 sectors/track, 3876 cylinders
Units = cylinders of 15120 * 512 = 7741440 bytes

Device Boot    Start       End    Blocks   Id  System
/dev/? *           1        14    105808+  83  Linux
/dev/?            15        81    506520   82  Linux swap
</pre>
=== Creating the Root Partition ===
Finally, let's create the root partition. To do this, type n to create a new partition, then p to tell fdisk that you want a primary partition. Then type 3 to create the third primary partition, /dev/hda3 in our case. When prompted for the first cylinder, hit enter. When prompted for the last cylinder, hit enter to create a partition that takes up the rest of the remaining space on your disk. After completing these steps, typing p should display a partition table that looks similar to this:
<pre>
Command (m for help): p

Disk /dev/mapper/via_hfciifae: 30.0 GB, 30005821440 bytes
240 heads, 63 sectors/track, 3876 cylinders
Units = cylinders of 15120 * 512 = 7741440 bytes

Device Boot    Start       End    Blocks   Id  System
/dev/?    *        1        14    105808+  83  Linux
/dev/?            15        81    506520   82  Linux swap
/dev/?            82      3876  28690200   83  Linux
</pre>
=== Saving the Partition Layout ===
To save the partition layout and exit fdisk, type w.

Now that your partitions are created, you can now continue with Creating File-systems.

=== Creating File-systems ===
==== File-systems? ====
The Linux kernel supports various file-systems. We'll explain ext2, ext3, ReiserFS, XFS and JFS as these are the most commonly used file-systems on Linux systems.

ext2 is the tried and true Linux file-system but doesn't have metadata journaling, which means that routine ext2 file-system checks at startup time can be quite time-consuming. There is now quite a selection of newer-generation journaled file-systems that can be checked for consistency very quickly and are thus generally preferred over their non-journaled counterparts. Journaled file-systems prevent long delays when you boot your system and your file-system happens to be in an inconsistent state.

ext3 is the journaled version of the ext2 file-system, providing metadata journaling for fast recovery in addition to other enhanced journaling modes like full data and ordered data journaling. ext3 is a very good and reliable file-system. It has an additional hashed b-tree indexing option that enables high performance in almost all situations. You can enable this indexing by adding -O dir_index to the mke2fs command. In short, ext3 is an excellent file-system.

ReiserFS is a B*-tree based file-system that has very good overall performance and greatly out-performs both ext2 and ext3 when dealing with small files (files less than 4k), often by a factor of 10x-15x. ReiserFS also scales extremely well and has metadata journaling. As of kernel 2.4.18+, ReiserFS is solid and usable as both general-purpose file-system and for extreme cases such as the creation of large file-systems, the use of many small files, very large files and directories containing tens of thousands of files.

XFS is a file-system with metadata journaling which comes with a robust feature-set and is optimized for scalability. We only recommend using this file-system on Linux systems with high-end SCSI and/or fibre channel storage and an uninterruptible power supply. Because XFS aggressively caches in-transit data in Ram, improperly designed programs (those that don't take proper precautions when writing files to disk and there are quite a few of them) can lose a good deal of data if the system goes down unexpectedly.

JFS is IBM's high-performance journaling file-system. It has recently become production-ready and there hasn't been a sufficient track record to comment positively nor negatively on its general stability at this point. 

=== Applying a File-system to a Partition ===
To create a file-system on a partition or volume, there are tools available for each possible file-system:

{| class="wikitable"
|-
| File-system
| Creation Command
|-
| ext2
| mke2fs
|-
| ext3
| mke2fs -j
|-
| reiserfs
| mkreiserfs
|-
| xfs
| mkfs.xfs
|-
| jfs
| mkfs.jfs
|}

On exiting fdisk, it may report that the partition table will not be re-read until after a reboot, you can get dmraid to re-read the partition table with 
<pre>
sudo dmraid -r
</pre>

==== Create File-systems on the RAID Array ====

Now "format" each partition (create file-systems).  In my case I used fdisk and ran a mk2fs on /dev/mapper/via_hfciifae5 and mkreiserfs on /dev/mapper/via_hfciifae7.  You can also do this with parted.  Or you can exit your partitioning tool and use mkfs (e.g., "mkfs.ext3" and "mkfs.reiserfs") to create the file-systems.  Create swap with "mkswap /dev/mapper/etc." and "swapon /dev/mapper/etc.".  (Use the man pages.)  Be sure to repeat "mkfs" for all the new partitions!

<pre>
mkfs -t ext3 /dev/mapper/via_hfciifae5
mkfs -t reiserfs /dev/mapper/via_hfciifae7
</pre>
==== Activating the Swap Partition ====
mkswap is the command that is used to initialize swap partitions
<pre>
mkswap /dev/mapper/etc
</pre>
To activate the swap partition, use swapon
<pre>
swapon /dev/mapper/etc
</pre>

The command dmraid -r will show how the partitions have been mapped in RAID:  In my case:

<pre>
via_hfciifae  -- the raw raid volume
via_hfciifae1 -- the NTFS partition
via_hfciifae5 -- /boot
via_hfciifae6 -- swap
via_hfciifae7 -- /
</pre>

Alternatively, with a RAID0 striped array you may see

<pre>
sudo dmraid -r
/dev/sda: via, "via_eafhdaegfb", stripe, ok, 488397167 sectors, data@ 0
/dev/sdb: via, "via_eafhdaegfb", stripe, ok, 488397167 sectors, data@ 0
</pre>

Also try sudo dmraid -s for information about you RAID set(s). 

=== Mount the Temporary File Structure ===

Next, I created a temporary file structure to hold my new installation while I construct it, I and mounted two sets of directories to it:
 a) Mounted the new partitions I had created for / and /boot (so could install packages to them).
 b) Mounted the currently running, /dev, /proc, and /sys filesystems, so I could use these to simulate a running system within my temporary file structure.

Use sudo or "sudo passwd" and su.   If you use su, you do not need to prefix each line below with sudo.  We will for consistency.

<pre>
sudo mkdir /target
sudo mount -t reiserfs /dev/mapper/via_hfciifae7 /target
cd /target
sudo mkdir boot dev cdrom proc sys
sudo mount -t ext2 /dev/mapper/via_hfciifae5 /target/boot
sudo mount --bind /dev /target/dev
sudo mount --bind /cdrom /target/cdrom
sudo mount -t proc proc /target/proc
sudo mount -t sysfs sysfs /target/sys
</pre>
=== Install the Base System ===
<pre>
sudo apt-get install debootstrap

sudo debootstrap feisty /target  # or breezy etc

sudo cp /etc/apt/sources.list /target/etc/apt
sudo cp /etc/resolv.conf /target/etc
sudo cp /etc/hosts /target/etc/hosts
sudo cp /etc/network/interfaces /target/etc/network

sudo chroot /target

apt-cdrom -m add

apt-get update

apt-get install language-pack-en

export LANG=sv_SE.UTF-8

exit
sudo mount -t proc proc /target/proc
sudo mount -t sysfs sysfs /target/sys
sudo chroot /target

apt-get install dmraid
</pre>
/!\ If dmraid returns errors, see the Trouble-Shooting Section at the end of this document
<pre>
apt-get install grub # or other boot-loader

apt-get install linux-386 # or k7, k8, k8-smp, etc
</pre>
/!\ The installer may ask you some questions:
1. Q: Create a symbolic link? A: Yes  = press Space
2. Q: You need to configure your bootloader. A: ok  = Tab, Space
3. Q: Do you want to abort now? A: No  = Tab, Space
<pre>
apt-get install ubuntu-standard # or minimal or base (dapper)

killall acpid

apt-get install ubuntu-desktop  # or ubuntu-server, xubuntu-desktop, etc

useradd alice # your name instead of alice
passwd alice
mkdir /home/alice
chown alice /home/alice

visudo
</pre>

Note: If you are installing ubuntu-desktop, you will need to add your user to several groups in order to use sound, among other things. When you create a full administrator using the GUI, it places your user in the following groups: adm dialout cdrom floppy audio dip plugdev scanner admin

So, to add your created user to those groups:
<pre>
usermod -a -G adm,dialout,cdrom,floppy,audio,dip,plugdev,scanner,admin alice  # following the previous conventions, put your user instead of alice
</pre>

Also, the typical Ubuntu setup has the initial user in the "admin" group, and places the admin group in the sudoers file, not your user, like so:
<pre>
visudo

%admin  ALL=(ALL) ALL
</pre>

=== Set Up the Boot-loader for RAID ===

Now that you have the debian core, ubuntu-base, linux kernel, dmraid, grub, and ubuntu-desktop installed, you can proceed with the boot-loader.  If you haven't completed these successfully, don't attempt to proceed, you will just exacerbate any problem you have at this point.

We will demonstrate the installation of Grub (Grand Unified Boot-loader), but there are several alternatives (e.g., LILO).  The key information here is how the normal process for use of the boot-loader had to be modified to accomodate the RAID mappings, so this general process should be useful regardless of your choice of boot-loader.

==== Install the Boot-loader Package ====

Now you need to run the grub shell. In a non-RAID scenario, one might use '''grub-install''', but we cannot because it cannot see the RAID device mappings and therefore cannot set up correct paths to our boot and root partitions.  So we will install and configure grub manually as follows:

First, make a home for Grub and put the files there that it needs to get set up:
<pre>
mkdir /boot/grub
cp /usr/lib/grub/<your-cpu-arch>-pc/stage1 /boot/grub/
cp /usr/lib/grub/<your-cpu-arch>-pc/stage2 /boot/grub/
cp /usr/lib/grub/<your-cpu-arch>-pc/<the staging file for your boot partition's filesystem> /boot/grub
</pre>
The "staging files" look like: "e2fs_stage1_5" (for ext2 or 3); "reiserfs_stage1_5" (for reiserfs); "xfs_stage1_5" (and so on).  It is safe to copy them all to your /boot/grub.
Next, go into the grub shell:
<pre>
grub
</pre>
You should now see the grub prompt.
Then tell GRUB which device is the boot device:
<pre>
device (hd0) /dev/mapper/via_hfciifae
</pre>
In my case, it was the RAID array mapped as '''/dev/mapper/via_hfciifae'''.
Next, tell Grub where all the stuff is that is needed for the boot process:
<pre>
root (hd0,4)
</pre>
/!\ '''This is one of the most common sources of error''', so we will explain this in excruciating detail.  From GRUB's perspective, "root" is whatever partition holds the contents of /boot.  For most people, this is simply your linux root (/) partition.  E.g., if / is your 2nd partition on the RAID you indicated above as hd0, you would say "root (hd0,1)".  Remember that Grub starts counting partitions at 0.  The first partition is 0, the second is 1, and so on.  In my case, however, I have a separate boot partition that GRUB mounts read-only for me at boot time (which helps keep it secure).  It's my 5th partition, so I say "root (hd0,4)"

So, if I have a system where /dev/mapper/via_x array has been partitioned so that /dev/mapper/via_x1 is going to be / and /dev/mapper/via_x2 will be /boot I need to type the following because /boot is mounted on the second partition of array hd0
<pre>
device (hd0) /dev/mapper/via_x
root (hd0,1)
</pre>

If I only have one non-swap partition, /dev/mapper/via_x1 that is going to be / and no separate /boot, the /boot folder will be on this partition, so
<pre>
device (hd0) /dev/mapper/via_x
root (hd0,0)
</pre>

Hint: A way to find out the right disk + partition for your /boot is to type the following on the grub command line:
<pre>
find /boot/grub/stage1
</pre>
This should return something in the format of (hdX,Y)

Optional: IF Grub complains about bad cylinder numbers (i.e, if it did not complain, skip this part about fdisk and geometry):
You may need to tell it about the device's geometry (cylinders, heads, and sectors per track.  You can find this information out by using fdisk (quit Grub) with the command: 
<pre>
fdisk (fdisk -l /dev/mapper/via_hfciifae
)</pre>
...then re-enter the Grub shell and use the command: 
<pre>
geometry (hd0) 9001 255 63
</pre>

Next, now that you've successfully established the "device" and "root", you can go ahead and instantiate GRUB on the boot device.  This sets up the stage 1 boot-loader in the device's master boot record and the stage 2 boot loader and grub menu in your boot partition:
<pre>
setup (hd0)
quit
</pre>

==== Configure the Boot-loader ====

Now run update-grub:
<pre>
update-grub
</pre>
This adds your newly installed linux kernel, and the associated initial ram disk image, to the boot options menu that grub presents during start-up.  You will find this  menu in the boot/grub directory.  We need to edit this '''menu.lst''' file as follows.  (CAUTION: Get this right - this is a common source of error and mistakes result in kernel panic upon reboot, so no typos.):

a) "root=":  Correct the path that points to the linux root (in several places). '''update-grub''' configures hda1 as root because, not being dmraid-aware, it can't find your current root-device. Put the correct device mapping for your linux root. So put your equivalent of:
<pre>
root=/dev/mapper/via_hfciifae7
</pre>
every place you see "root=" (only where you see root and the equal sign). This goes in all the places where '''update-grub''' defaulted to '''root=/dev/hda1''' or just left it blank like '''root=   '''.

Make sure you change this in the Automagic defaults section as well as in each of the multiple alternatives sections that follow.  (Important: the Automagic defaults section is nested and therefore uses ## to indicate comments and # to indicate the actual defaults that is uses. So don't "un-comment" the default lines when you edit them.  In other words, leave the #).  When you update your kernel later on, '''update-grub''' will use these defaults so it won't ignorantly "assume hda1" and send your system into a kernel panic when you boot.  This ought to end up looking something like:
<pre>
</pre>

b) "groot": If necessary, correct the grub root.  In places, you will see other lines that also refer to "root" (or "groot") but use syntax such as '''root (hd0,1)''' instead of a path.  As described earlier, these refer to the "root" for grub's purposes, which is actually your /boot.    Also, remember grub's syntax uses partition numbering beginning with zero.  So, if you have a separate /boot partition, these lines should instead show something like:
<pre>
root (hd0,4)
</pre>
(The same information we used while working with grub interactively earlier.)  Change this both for the Automagic defaults as well as for each alternative, including the memtest option.

c) An additional edit is required IF you are using a separate /boot partition.  The path pointing to the linux root must be RELATIVE to the grub "root" (your /boot).  So if you are using a separate boot partition, the paths in grub's menu.lst file that help grub locate the linux kernel and initrd will not begin with "/boot", and you should delete that portion of the path.  For example, '''update-grub''' initially spat out this:
<pre>
title           Ubuntu, kernel 2.6.15-29-amd64-k8
root            (hd0,0)
kernel          /boot/vmlinuz-2.6.15-29-amd64-k8 root= ro quiet splash
initrd          /boot/initrd.img-2.6.15-29-amd64-k8
savedefault
boot
</pre>
... and because I have a separate boot partition and opted not to use a grub splash image (which you can learn about elsewhere), my editing looked like this...
<pre>
title           Ubuntu, kernel 2.6.15-29-amd64-k8
root            (hd0,4)
kernel          /vmlinuz-2.6.15-29-amd64-k8 root=/dev/mapper/via_hfciifae7 ro quiet
initrd          /initrd.img-2.6.15-29-amd64-k8
</pre>
/!\ '''Note that I removed "savedefault"'''.  If you leave this in, you will get a "file not found" error when you try to boot (you also can't set use default=saved up top as it shows in the menu.lst file's example).  '''Every time you run update-grub you need to manually remove ''savedefault''.''' Again, if you are not using a separate boot partition, you can leave <code>/boot</code> in the paths.  The "boot" command you would issue at the grub prompt is implied, so you can leave it out of the menu file.

d) To add a static boot stanza for Windows, you can use and change the example in the menu.lst file or the following:
<pre>
title Windows XP
  rootnoverify (hd0,0)
  chainloader +1
</pre>

Put it at the bottom, below where it says <code>### END DEBIAN AUTOMAGIC KERNELS LIST</code>.  Or if for some unforgivable reason you want your computer to boot Windows by default, you can put it up front above where it says <pre>### BEGIN DEBIAN AUTOMAGIC KERNELS LIST
</pre>

e) Close the gaping security hole!
First, set a password where the example shows it.  Users who cannot provide this password will be prevented from using any locked menu entries, prevented from editing the bootlines, and prevented from dropping to a command prompt.  To do this, in the console type:
<pre>
grub-md5-crypt
</pre>
When it prompts you "Password:", it's asking what you want to be the GRUB password (not your user password, the root password, or anything else).  You will be prompted to enter it twice, then it will spit out the MD5 hash that you need to paste into menu.lst.
This line should end up looking something like the following (obviously, the MD5 hash of YOUR password goes where "$1$gLhU0/$aW78kHK1''''''Qf''''''V3''''''P2b2zn''''''Uoe/" is shown):
<pre>
password --md5 $1$gLhU0/$aW78kHK1QfV3P2b2znUoe/
</pre>
Then, to keep your "recovery mode" boot alternative(s) locked each time update-grub runs, set
<pre>
lockalternative=true
</pre>
Unless you do this, anybody will be able to seize root simply by rebooting your computer (e.g., cutting power to it) and selecting your "recovery mode" menu entry when it reboots, or editing the normal bootline to include 'single' mode.

You can also add "lock" to any static menu alternatives you have created (insert it on a line just below the title, so it locks the entire set of options described).

f) Test automagic kernels settings (also completes the locking of alternatives).  It is better to find errors now than a month from now when you've forgotten all this stuff and the kernel gets updated.
- first, make a backup of menu.lst
- then run <code>update-grub</code> again
- watch for errors and re-examine menu.lst for discrepancies
- correct as needed.

== Preconfigure the New System ==
{*} This section applies to all Ubuntu versions.

Ensure that you are still operating as root within the new (temporary) system (i.e., your prompt will be '''root@ubuntu#'''.  If not, chroot /target again:
<pre>
sudo chroot /target
</pre>

(The process from here forward is the same as any bootstrap / network installation, and there are other sources to refer to for more detail.)

'''Ubuntu 6.06 - 7.10''': base-config is deprecated in Dapper Drake, so we have to manually configure the new base system.
'''Ubuntu 5.10''': Enter the command '''base-config new''' to configure system defaults.

The following steps have been pulled from <nowiki>[[http://doc.ubuntu.com/ubuntu/install/i386/apds03.html]]</nowiki>. I've only included the steps we haven't covered above.

=== Configure Keyboard ===
<pre>
apt-get install console-data #or "dpkg-reconfigure console-data" if console-data is already installed.
</pre>
Note that the keyboard cannot be set while in the chroot, but will be configured for the next reboot.

=== Configure Networking ===

To configure networking, edit /etc/network/interfaces, /etc/resolv.conf, and /etc/hostname.
<pre>
nano /etc/network/interfaces
</pre>
Here are some simple examples from '''/usr/share/doc/ifupdown/examples''';:
<pre>

auto lo
iface lo inet loopback

</pre>
Enter your nameserver(s) and search directives in /etc/resolv.conf:
<pre>
nano /etc/resolv.conf
</pre>
A simple /etc/resolv.conf:
<pre>
search hqdom.local\000
nameserver 10.1.1.36
nameserver 192.168.9.100
</pre>
Enter your system's host name (2 to 63 characters):
<pre>
echo UbuntuHostName > /etc/hostname
</pre>
Change "!UbuntuHostName" to whatever you'd like it to be.
If you have multiple network cards, you should arrange the names of driver modules in the /etc/modules file into the desired order. Then during boot, each card will be associated with the interface name (eth0, eth1, etc.) that you expect.

=== Configure Locales ===
To configure your locale settings to use a language other than English, install the locales support package and configure it:
<pre>
apt-get install locales
dpkg-reconfigure locales
</pre>
NOTE: Before using locales with character sets other than ASCII or latin1, please consult the appropriate localization HOWTO.

=== Mount your FileSystems ===
It will be helpful to configure your fstab file at this point.  One easy way to do this is:
<pre>
cat /etc/mtab
</pre>
(select and copy everything)
<pre>
nano /etc/fstab
</pre>
(paste everything)

Then delete everything except the proc line, and the lines that refer to your RAID partitions.  It might end up something like this (yours will vary - people asked for examples):

<pre>

proc                            /proc           proc       rw              0 0
/dev/mapper/via_hfciifae5       /boot           ext3       defaults        0 2
/dev/mapper/via_hfciifae7       /               reiserfs   notail,noatime  0 1
/dev/mapper/via_hfciifae6       none            swap       sw              0 0
</pre>
or
<pre>
/dev/mapper/nvidia_bggfdgec2    /boot     ext3    defaults    0    1
/dev/mapper/nvidia_bggfdgec3    none      swap    sw          0    0
proc                            /proc     proc    rw          0    0
</pre>

Finally you are ready to reboot.  This first time, select the "recovery mode" option.
When it asks, you want to "perform maintenance".
Set the root password:
<pre>
passwd
</pre>

(more is needed here, or a reference to whatever replaces the howto that describes a general debootstrap install)

== Ubuntu 7.04 (Feisty Fawn) ==
The Desktop CD installer still had poor support for fakeraids, or even no support at all. Upgrading from an existing Edgy installation is no problem, just remember to edit /boot/grub/menu.lst and remove the "savedefault" entries again when the upgrade has finished.

You can try to use the installer though. Here is a description how to do that

<nowiki>[[http://ubuntuforums.org/showthread.php?t=464758]]</nowiki>

== Ubuntu 6.10 (Edgy Eft) ==
The fakeraid support in the Desktop (live) installer is disabled due to different problems. Use the "Alternate" install cd. See <nowiki>[[https://launchpad.net/bugs/54246|bug #54246]]</nowiki> for some issues and workarounds. The original Edgy version of dmraid is broken for many people. A newer version has been released in Feisty, and this package has been reported to work fine in Edgy (and Dapper) as well.

See also <nowiki>[[https://wiki.ubuntu.com/FakeRaidEdgy|FakeRaidEdgy]]</nowiki> for a happy-ending story that might help you.

== Ubuntu 6.06 (Dapper Drake) by Up-grading ==
The dmraid package in Ubuntu 6.06 has the necessary scripts included (under /usr). After upgrading the dmraid package, you can therefore delete the old scripts that you've made (under /etc). To be sure the package scripts are baked into the initrd, update the initrd again by reconfiguring dmraid:
<pre>
sudo rm /etc/mkinitramfs/hooks/dmraid
sudo rm /etc/mkinitramfs/scripts/local-top/dmraid
sudo dpkg-reconfigure dmraid
</pre>

== Ubuntu 5.10 ==
=== Reconfigure Initramfs for RAID ===

/!\ This chapter is only required for Ubuntu 5.10. Otherwise it should be skipped.

In recent years there has been a trend to try and pull a bunch of code out of the kernel and into !EarlyUserspace.  This includes stuff like nfsroot configuration, md software RAID, lvm, conventional partition/disklabel support, and so on.  Early user space is set up in the form of an initramfs which the boot loader loads with the kernel, and this contains user mode utilities to detect and configure the hardware, mount the correct root device, and boot the rest of the system.

Hardware fakeRAID falls into this category of operation.  A device driver in the kernel called device mapper is configured by user mode utilities to access software RAIDs and partitions.  If you want to be able to use a fakeRAID for your root filesystem, your initramfs must be configured to detect the fakeRAID and configure the kernel mapper to access it.

So we need to add dmraid to the initramfs. Debian and Ubuntu supports this by way of a set of shell scripts and configuration files placed in '''/etc/mkinitramfs/'''.  We must tailor these to include dmraid by plugging in two simple scripts and adding a one-line entry to a configuration file.  The only real challenge here is to make sure you don't inadvertently screw up the syntax with a typo.

Note that in Ubuntu 6.06, this is taken care of by the dmraid package itself.

=== Configure mkinitramfs ===

First, create a new file as '''/etc/mkinitramfs/scripts/local-top/dmraid'''.

(If you are lazy or don't like to keyboard, you can open this how-to in the browser and copy the text.)

/!\ the line: PREREQ="udev" gave me circular-dependency issues so I replaced it with PREREQ="" and my issue was resolved

<pre>

PREREQ="udev"

prereqs()
{
        echo "$PREREQ"
}

case $1 in
prereqs)
        prereqs
        exit 0
        ;;
esac

modprobe -q sata_nv
modprobe -q dm-mod

/sbin/dmraid -ay
</pre>

Second, create another new file as '''/etc/mkinitramfs/hooks/dmraid'''.

(Again for the lazy, you can copy it from your browser.  Also, it's only slightly different, so if you are manually typing it for some reason, you may want to start with a copy of the first script.)

<pre>

PREREQ=""

prereqs()
{
	echo "$PREREQ"
}

case $1 in
prereqs)
	prereqs
	exit 0
	;;
esac

. /usr/share/initramfs-tools/hook-functions

copy_exec /sbin/dmraid /sbin

exit 0
</pre>

Third, mark both of these new initramfs scripts as executable:
<pre>
chmod +x /etc/mkinitramfs/hooks/dmraid
chmod +x /etc/mkinitramfs/scripts/local-top/dmraid
</pre>

Last, add the line <code>dm-mod</code> to the file '''/etc/mkinitramfs/modules'''.  Make sure the file ends with a newline. If you use a RAID-1 (mirror), include '''dm-mirror''' as well.

=== Update the initrd ===

Now the big moment -- use initramfs to update the initrd file.  Below, I show the kernel I installed at that time, but stuff following "img-" and following "-c -k " must reflect the version YOU are using (e.g., "2.6.15-29-amd64-k8-smp" or whatever).

Two commands
<pre>
rm /boot/initrd.img-2.6.12-9-k7
update-initramfs -c -k 2.6.12-9-k7
</pre>
