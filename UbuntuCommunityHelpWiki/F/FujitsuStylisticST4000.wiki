{|
  | '''Warning'''
  * This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
  * '''Images''' and '''attachments''' have been removed to conserve space.
  * '''Links''' may not work and there may be formatting issues.
  * A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__



== Intro ==

This page will hold information about installing Ubuntu on the Fujitsu Stylistic ST4000 Series Tablet PCs, Devices are: St4110, ST4120W, ST4110p, ST4120P. 
As I own a ST4120P Device, everything about the other Devices is "As far As I Know". Correct it if you can.

== Hardware ==

The Fujitsu Stylistic ST4000 Tablet PCs are built on the same Hardware Platform and differ in CPU Speed, Memory, WLan and Touchscreen Type.

=== General ===

System Type: Tablet PC - slate
Width: 30.1 cm
Depth: 22 cm
Height: 2.2 cm
Weight: 1.4 kg

Processor: Intel Pentium III-M 800 MHz ULV
Features: SpeedStep technology

Chipset Type: Intel 830MG, 8192Mb Shared Memory

Ram: SDRam - PC133
Form Factor: SO DIMM 144-PIN

IDE Storage

Hard Drive: 40 GB

Display Type: 10.4" TFT
Max Resolution: 1024 x 768 ( XGA )

Audio Output: Sound card, Some AC97 Stuff
Audio Input: Microphone

Modem: Network / modem combo - mini PCI
Winmodem?

Lan:

Wlan: Prism2.5 compatible IEEE 802.11b Chip 

Note: to get WPA working you most likely need to update the firmware. A link to a collection of firmwares with further information is provided below. Do not worry if after the firmware update the station firmware number is not available. After the next reboot everything should be fine.

=== ST4110 ===

Touchscreen with Wacom Hardware.

=== ST4110p ===

Passive Touchscreen. Supported by the fpit Driver. (sort of). You need a properly patched driver and you need to realize that the serial device for the touchscreen sits on port 0x0220 irq 4 and that X only works once per fresh reboot relaible. At least for me that took forever to figure out. So if in doubt reboot.

=== ST4120W ===

Intel Pentium III-M 933Mhz ULV
Wacom serial touchscreen interface
Wlan Onboard

=== ST4120P ===

Intel Pentium III-M 933 ULV
Passive Touchscreen
Wlan Onboard

=== BIOS ===

There is a BIOS Update available on the Fujitsu Site. Installing is quite easy, I used the ISO Version, burned it with K3b and upgraded the BIOS. I don't think it helped me though, apart from the Fan running more often.

=== Hardware Buttons ===

http://sourceforge.net/projects/fjkey-st4000 gives instructions on enabling the Hardware keys.

== Installing Ubuntu ==

Installing newer Versions of Ubuntu is quite easy.

=== Ubuntu 7.10 /8.04 ===

You can Install Ubuntu in different Ways. 

Either use the CDRom in the docking Station or install from USB. As it's USB 1.1 it will take about 1,5h to complete.

Use the alternate Disk. 

This cannot be stressed enough since 256MB are not enough to run the graphical installer. 

As default X-Server Ubuntu will use the Intel driver for X.org. This Driver fails with the Tablet and produces a white Screen, the i810 Driver works fine.

==== USB Install Instructions ====

Although it does not seem so, the tablet can boot from USB. You need to select "Boot from Optical Drive".
Installing from USB is kind of tricky, as booting and installing did not work out of the box. I will add some instructions later, in general you need to use the "Install from ISO Image" Option in debian-installer.

==== Configuring X ====

===== 4120P =====
After a lot of fiddling to get the touchscreen up and running this is my <nowiki>[[attachment:xorg.conf]]</nowiki>, which is good for the 4120P I have. This is the source of the fpit driver which works for me. Download <nowiki>[[attachment:xf86Fpit.c]]</nowiki>, do a ''apt-get build-dep xserver-xorg-input-fpit && apt-get source xserver-xorg-input-fpit'' copy the downloaded source into the folder where the original source sits. Then do a ''configure && make'' and cross your fingers you should find the compiled '''fpit_drv.so''' in ''xserver-xorg-input-fpit-1.1.0/src/.libs'' copy it to ''/usr/lib/xorg/modules/input/''

I know this is really not nice but since this is such a niche driver I am happy it just works!

Make sure to add the following line to ''/etc/serial.conf''
   
   /dev/ttyS0 uart 16550A port 0x0220 irq 4 baud_base 115200 spd_normal skip_test

===== 4120W =====

The 4120W also has a serial touchscreen interface but manufactured by Wacom instead. The touchscreen works great under Hardy including right click. There is no need to create or edit /etc/serial.conf or recompile anything, but you do need to edit/replace your /etc/X11/xorg.conf to get both video and the touchscreen working. For the touchscreen you need to add XInput descriptors for the stylus, eraser, cursor, touch, and pad devices as detailed in the Linux Wacom docs:

http://linuxwacom.sourceforge.net/index.php/howto/inputdev

==== Configuring WLan ====

As some devices contain a Prism2.5 WLan, you need to take the following steps to get WPA-PSK Working:

'''''Attention: These steps make you flash your Wlan Hardware. I do not take any resposibility if it does not work. Use your brain from this point on!'''''

The wireless chipset is a well known Intersil Prism 2.5. It supports WPA and WPA2 in Windows. However the hostap driver supports WPA/WPA2 on it only with a firmware update.

<nowiki>[[http://linux.junsun.net/intersil-prism/]]</nowiki> is an excellent reference for this.

Use hostap_diag wlan0, the firmware version is:
NICID: id=0x8013 v1.0.0 (PRISM II (2.5) Mini-PCI (SST parallel flash))
PRIID: id=0x0015 v1.1.0
STAID: id=0x001f v1.4.1 (station firmware)
Read the release ID table carefully in the hardware model information. I picked the stable firmware from Jun Sun's firmware collection:
pk010101.hex
rf010704.hex

Flashing is done via the program '''prism2_srec'''

The new firmware works like a charm and its version is:
NICID: id=0x8013 v1.0.0 (PRISM II (2.5) Mini-PCI (SST parallel flash))
PRIID: id=0x0015 v1.1.1
STAID: id=0x001f v1.7.4 (station firmware)

For the wpa_supplicant.conf, I followed this HowTo: <nowiki>[[http://ubuntuforums.org/showthread.php?t=263136]]</nowiki>. When in doubt, you can run the wpa_supplicant command manually and enable verbose output:
sudo wpa_supplicant -Dwext -i wlan0 -c/etc/wpa_supplicant.conf

Steps taken from:

<nowiki>[[http://offtopic.org/twiki/bin/view/Main/GadgetTabletST4110]]</nowiki>

=== Ubuntu 8.10 alpha 6 ===

I tried upgrading to Intrepid Ibex and it did not work properly. 
Main problem is the missing i810 driver in Intrepid. In theory, this driver is deprecated, but the intel driver for X.org does not work with the Tablets. After uninstalling everything related to X, installing X.org from Hardy and installing everything else from Intrepid again it works. Even KDE 4 works, though not as fast as KDE 3.5 but its look is twice as nice.

== Software ==

=== Gnome ===

Locking the Screen on Suspend or in general is quite annoying as there is no keyboard to log in again. You can disable this by setting '''/desktop/gnome/lockdown/disable_lockscreen_and_logout''' with '''gconf-editor''' to true.

For passive models you can enable right-clicking by tapping longer on the screen in '''Settings -> Mouse'''.

=== KDE ===

You can disable desktop locking by removing '''/usr/bin/kdesktop_lock'''.

Enable right clicking by writing a Script that executes '''xmodmap -e "pointer = 3 2 1"''' for enabling and '''xmodmap -e "pointer = 1 2 3"''' for disabling. You can use a Hardware key ( see above ) to execute.

=== Rosetta Handwriting Recognition ===

See http://www.handhelds.org/project/rosetta/ for more information about Rosetta.
It was developed for Handhelds like the iPAQ but I think its quite the best Handwriting recognition Software for Tablet PCs apart from CellWriter. Well indeed, its CellWriter without cells :)

== Hardware Related Issues ==

=== ACPI ===

The Tablets have "strange" ACPI support.
From the specification ACPI 2.0 should be supported, all modules load and the Battery states correct values. Apart from this, controlling the fan or thermal_zone is '''NOT''' possible, if anyone knows a fix to this please let me know as the fan kills me in quite environments. I added a small NTC Resistor to the Fan and its quiter now.

=== Hibernate / Suspend ===

As this is a portable device, hibernate ( Suspend to Disk ) and suspend ( Suspend to Ram ) are quite important for everyday work. The following was tested with the 4120P, without the fpit driver it may work differently.

==== Ubuntu 7.10 ====

Hibernate does not work, the Tablet does not wake up.
Suspend works somehow, after waking the screen flickers two times after touching the it, could be a bug in the fpit driver.

==== Ubuntu 8.04 ====

Hibernate and suspend work, screen flickering did not occur. I installed the fpit from the sources above. 
