{|
  | '''Warning'''
  * This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
  * '''Images''' and '''attachments''' have been removed to conserve space.
  * '''Links''' may not work and there may be formatting issues.
  * A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__

== Introduction ==

Fail2Ban is an intrusion prevention framework written in the Python programming language. It works by reading SSH, ProFTP, Apache logs etc.. and uses iptables profiles to block brute-force attempts.

== Installation ==
To install fail2ban, type the following in the terminal:

<pre>
sudo apt-get install fail2ban </pre>

=== Configuration ===
To configure fail2ban, make a 'local' copy the jail.conf file in /etc/fail2ban

<pre>
cd /etc/fail2ban
sudo cp jail.conf jail.local </pre>

Now edit the file:

<pre>
sudo nano jail.local </pre>

Set the IPs you want fail2ban to ignore, the ban time (in seconds) and maximum number of user attempts to your liking:

<pre>
[DEFAULT]
ignoreip = 127.0.0.1
bantime  = 3600
maxretry = 3 </pre>

=== Email Notification ===

Note: You will need sendmail or any other MTA to do this.

If you wish to be notified of bans by email, modify this line with your email address:

<pre>
destemail = your_email@domain.com </pre>

Then find the line:

<pre>
action = %(action_)s </pre>

and change it to

<pre>
action = %(action_mw)s </pre>

=== Jail Configuration ===

Jails are the rules which fail2ban apply to a given application/log:

<pre>
[ssh]

enabled = true
port    = ssh
filter  = sshd
logpath  = /var/log/auth.log
maxretry = 3 </pre>

To enable the other profiles, such as [ssh-ddos], make sure the first line beneath it reads:
<pre>
enabled = true </pre>

Once done, restart fail2ban to put those settings into effect
<pre>
sudo /etc/init.d/fail2ban restart </pre>

=== Advanced: Filters ===

If you wish to tweak or add log filters, you can find them in
<pre>
/etc/fail2ban/filter.d </pre>

=== Testing ===

To test fail2ban, look at iptable rules:

<pre>
sudo iptables -L </pre>

Attempt to login to a service that fail2ban is monitoring (preferably from another machine) and look at the iptable rules again to see if that IP source gets added.

== External Links ==

* http://www.fail2ban.org/wiki/index.php/Main_Page - Official Fail2ban Website.
* http://denyhosts.sourceforge.net/ - DenyHosts

----
CategorySecurity

Remarks (Robert van Reems):
To test fail2ban on Ubuntu 12.04 server edition a reboot is required. Restarting or reloading the service didn't work.
