{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__


== Overview ==

Orchestra is a set of components that provides a Provisioning server, Logging server, and Management server.

The Orchestra Provisioning Server provides the ability to manage both, DNS and DHCP in the network where we will using it to provision servers. This is very important to have specially when using Orchestra with '''JuJu'''.

In the Orchestra/JuJu scenario, it is important for '''JuJu''' to be able to access the DNS name of a machine that will be deployed. The recommended scenario is to allow Orchestra to manage DNS/DHCP for '''JuJu''' to be able to manage the environment correctly. The scenario requirements for this is detailed bellow:

* '''192.168.1.1''': Default Gateway
* '''192.168.1.2''': Orchestra Server
* '''192.168.1.100''' to '''192.168.1.200''': IP address range to serve by the DHCP Server.

However, having an external DNS and DHCP server is also an option.

== Installing Orchestra ==

To install the Orchestra Server, we simply need to execute the following command:

<pre>
sudo apt-get install ubuntu-orchestra-server
</pre>

Once installation is done, a series of questions will pop up to decide whether to configure DNS/DHCP or not.

=== DNS/DHCP Management ===

First, and right after the Orchestra Provisioning Server is installed, a question will pop-up asking to decide whether to manage DNS/DHCP or not. In this case, we select '''Yes''', as follows:

<nowiki>[[File:01-orchestra-server-b.png]]</nowiki>

Second, we need to specify the range of IP addresses that the Orchestra DHCP Server will manage. In our case scenario, we will use the range '''192.168.1.100,192.168.1.200''' as follows:

<nowiki>[[File:02-orchestra-server.png]]</nowiki>

Third, we need to specify the default gateway, which is not the Orchestra Server ('''192.68.1.2'''). In our case is '''192.168.1.1'''. We do this as follows.

<nowiki>[[File:03-orchestra-server.png]]</nowiki>

Finally, we need to input the Domain Name to be used in the environment, so we can make the machines resolve to a FQDN. We do this as follows:

<nowiki>[[File:04-orchestra-server.png]]</nowiki>

=== No DNS/DHCP Management ===

If there's a already and external DNS and DHCP server, we need to make sure of two things.

# The DHCP server should be configured to point to the Orchestra Server ('''192.168.1.2''') for PXE Booting.
# The DNS server should made available for '''JuJu'''. Every machine that get's deployed should also be DNS addressable for '''JuJu''' to be able to communicate with it. '''JuJu''' knows about the DNS names of each system thanks to Cobbler, which will have to be configured accordingly.

=== JuJu Configuration ===

Additionally, when Installing orchestra, a script called '''orchestra-import-isos''' will be run in the background and it will import all the Ubuntu Mini ISO's into Cobbler, creating the necessary configuration and profiles for the systems that will be managed by the Provisioning Server. These configurations will also prepare the environment and create profiles for '''JuJu'''.

In the case of '''JuJu''', as an example, cobbler profiles will be created as follows:

* oneiric-x86_64-juju
* oneiric-i386-juju

The script will also create the management classes that will be used by '''JuJu''':

* orchestra-juju-available
* orchestra-juju-acquired
