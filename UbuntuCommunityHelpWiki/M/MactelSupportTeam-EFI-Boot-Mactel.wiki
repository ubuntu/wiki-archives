{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__

{| class="wikitable"
|-
| <tablestyle="float:right; font-size: 0.9em; width:40%; background:#F1F1ED; margin: 0 0 1em 1em;" style="padding:0.5em;"><<BR>>
|}

== Introduction ==

This page will attempt to document the status and procedure for booting Ubuntu Linux via EFI on Intel-Based Macintosh Computers (mactels). This is highly experimental and very different from the current recommended method of installation on a Mac. (See the [MactelSupportTeam/AppleIntelInstallation] Page). If you are interested in trying out something new, and is more native to how your Mac operates, please proceed. If you are looking to install a stable, reliable system, this is probably not for you.

== Non-Working Hardware ==

Because there are several unknowns about Apple's implementation of EFI, there are some things that do not yet work correctly.
 1. Your graphics may be limited to using the xorg fbdev driver (framebuffer) . This means no 3D Acceleration. But 3d accel with efi does work on Macs with intel graphics and intel driver, and with radeon chips with ATI fglrx in ubuntu 810 but not later, but not so far with nvida graphics.

== Basic Installation Procedure ==

The basic installation of Ubuntu is not really different from installing on any other Mac, but there is some software that you really need in addition in order to boot via EFI.

=== rEFIt ===
Both a CD install of rEFIt and a local install on the Mac OS partition will work. However, The CD install will shift the device identifier (ie. (hd1,1) instead of (hd0,1) and sdb1 instead of sda1) due to the way that the apple boot loader orders devices.

=== Installing Ubuntu ===

{| class="wikitable"
|-
| <tablestyle="background-color: #f9eaaf;"><nowiki>[[File:IconsPage/warning.png]]</nowiki>NOTE ON EXTERNAL HARD DRIVES:
|}

== Getting GRUB2 EFI ==

Some sections may just contain a list of links. It is sometimes useful to include a short explanation of what the links are for. For example: 'Ubuntu includes the following Internet applications by default.'

=== Binaries, debs ===
As of June 2009, the latest ubuntu and debian grub-efi packages (depends  grub-common) have all the recent patches and tweaks for Apple Intel Macs, and the packages can be simply installed in linux, then using gru-mkimage and slected modules, create grub.efi.
The grub-install utility needs some further changes to be useful on Apple as it assumes the use of a FAT EFI boot partition.

You can apt-get install grub-efi in ubuntu karmic or debian sid but earlier versions are no good, download the debs fromn the packages.ubuntu.com or debian.

=== Compiling ===

Should not be necessary unless you want to hack the code.

==== Prerequisite Software ====
<pre>
sudo apt-get install build-essential subversion gcc-multilib bison ruby autoconf
</pre>
==== Checkout the Subversion Source ====
<pre>
svn co svn://svn.sv.gnu.org/grub/trunk/grub2
</pre>
==== Compiling ====
<code>cd grub2</code> <<BR>>
<code>./autogen.sh</code> <<BR>>
<code>./configure --with-platform=efi</code> <<BR>>
<code>make</code> <<BR>>
<code>./grub-mkimage --help</code> <<BR>>

=== GRUB2 and Grub.cfg ===

Grub2 is the source for grub.efi and the grub-efi package. It is also the source for grub-common,  grub-pc, and grub-ieee1275, and the common features include the grub.cfg menu which replaces the old menu.lst for grub1, and has many new features. These generic GRUB2  aspects are described in the recent GRUB2 ubuntu-wiki page , refer to it for basics.
<code> https://wiki.ubuntu.com/Grub2  </code>

=== Installing grub.efi ===
==== Locations ====
 On the OSX partition or on another hfsplus (Macos Extended) partition.
 Also on a FAT32 partition if using rEFIt.
 There are 3 grub.efi shown here to illustrate the 3 locations, not normally a good idea.
<nowiki>[[File:grubfiles.png]]</nowiki>

== Other OS Tweaks ==

=== Blacklist AGP ===

 This may be needed for MacBook2,1 and some others using the intel video chip, if the 'fix_video' option is not used. Should not be needed for later model macs with radeon and nvidia graphics.

Copy this text to a file named blacklist-agp.

Code:
<pre>
blacklist agpgart
blacklist amd-k7-agp
blacklist amd64-agp
blacklist sworks-agp
blacklist ati-agp
blacklist via-agp
blacklist sis-agp
blacklist efficeon-agp
blacklist intel-agp
blacklist ali-agp
blacklist nvidia-agp
</pre>
then copy it to the /etc/modprobe.d/ directory

=== Set the xorg driver ===
Save a copy of existing xorg.conf for changing back to existing x configuration.

Here is a single Section mini xorg.conf for intrepid xubuntu on a Mac``Book to use the fbdev driver.

If you have an xorg.conf with Section "Device", just edit that Section in the Driver line, leave the Identifier line as is.

/etc/X11/xorg.conf

Code:
<pre>
Section "Device"
	Identifier	"Configured Video Device"
	Driver 		"fbdev"
EndSection
</pre>

== Tested Hardware ==

# Mac Version String (See how to find this <nowiki>[[https://wiki.ubuntu.com/MactelSupportTeam/CommunityHelpPages#Determine%20your%20model%20and%20hardware%20revision|here]]</nowiki>)
# GRUB2 revision
# Any Applied Patches
# Synopsis of how it went / any problems?

=== MacBook4,1 ===

# Model: MacBook4,1
# Grub2 revision: 2194 (64-bit)
# Linux: Jaunty 64-bit (2.6.28 kernel), patched with <nowiki>[[attachment:e820.patch]]</nowiki>
# Boot commands:<pre>
fix_video
linux /vmlinuz root=/dev/sdb2 video=efifb
initrd /initrd.img
</pre>
 1. Notes:
  i. Boots ok, graphics are accelerated
  i. Console goes scrambled after X starts
  i. fixvideo must be part of the Grub2 core image, not a module

== See Also ==

* <nowiki>[[http://ubuntuforums.org/showthread.php?t=995704]]</nowiki> - Ubuntuforums discussion
* <nowiki>[[http://ubuntuforums.org/forumdisplay.php?f=328]]</nowiki> - Apple Users Forum on ubuntuforums.org.
* <nowiki>[[MactelSupportTeam]]</nowiki> - The Mactel-Support Team.
* <Link> - Explanation of link.

== External Links ==

* <nowiki>[[http://grub.enbug.org/]]</nowiki> - GNU GRUB Wiki.
* <nowiki>[[http://grub.enbug.org/TestingOnEFI]]</nowiki> - GNU GRUB Wiki/TestingOnEFI.
* <nowiki>[[http://grub.enbug.org/TestingOnMacbook]]</nowiki> - GNU GRUB Wiki/TestingOnMacbook.
* <nowiki>[[http://www.gnu.org/software/grub/grub-2.en.html]]</nowiki> - GRUB2 Page.
* <nowiki>[[http://en.wikipedia.org/wiki/Extensible_Firmware_Interface]]</nowiki> - Wikipedia article on EFI.
* <nowiki>[[http://www.intel.com/technology/efi/]]</nowiki> - Intel EFI Page.
* <nowiki>[[http://www.uefi.org/home]]</nowiki> - UEFI Homepage.
* <Link> - Explanation of link.

----
CategoryMac
