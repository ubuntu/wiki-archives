{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__



== MacBookAir (6,2) on Ubuntu 13.10 (Saucy Salamander) ==
<nowiki>[[File:MacBooksmall.png]]</nowiki><<BR>><<BR>>

This page aims to describe the steps needed, to fully enable all features of the '''6-th Generation MacBookAir''' (release date: mid 2013) when using '''Ubuntu 13.10, Saucy Salamander'''.<<BR>>
<<BR>>
<nowiki>[[File:IconsPage/terminal.png]]</nowiki> You can find out, what model you have by typing at the terminal:<<BR>>
<pre>
sudo dmidecode -s system-product-name
</pre>
<<BR>>
If you have a different model, please go <nowiki>[[https://wiki.ubuntu.com/MactelSupportTeam/CommunityHelpPages|here]]</nowiki> and find the right wiki.

=== Overview ===

Anything not mentioned here probably already works out of the box. If not, please refer to the <nowiki>[[http://ubuntuforums.org/forumdisplay.php?f=328|Ubuntu Apple Users forum]]</nowiki>. 

{| class="wikitable"
|-
| <style="background-color: #f9eaaf;">Feature
| <style="background-color: #f9eaaf;"> Support status
|-
| LCD Panel
| <nowiki>[[File:IconsPage/ok.png]]</nowiki>
|-
| Suspend & Hibernate
| <nowiki>[[File:IconsPage/ok.png]]</nowiki><nowiki>[[File:IconsPage/info.png]]</nowiki> Suspend ok, but LCD brightness can't be adjusted after resume. See workaround below (backlight issue) <<BR>><nowiki>[[File:IconsPage/question.png]]</nowiki> Hibernate not tried yet
|-
| Shut-down and Reboot
| <nowiki>[[File:IconsPage/ok.png]]</nowiki>
|-
| Keyboard functions (Brightness,volume,...)
| <nowiki>[[File:IconsPage/ok.png]]</nowiki>
|-
| Touchpad (appletouch)
| <nowiki>[[File:IconsPage/ok.png]]</nowiki>
|-
| Wireless (Air``Port)
| <nowiki>[[File:IconsPage/ok.png]]</nowiki>[[#Wireless (AirPort)|<nowiki>[[File:IconsPage-info.png]]</nowiki>]]
|-
| Bluetooth
| <nowiki>[[File:IconsPage/ok.png]]</nowiki>
|-
| iSight
| <nowiki>[[#iSight|<nowiki>[[File:IconsPage-dont.png]]</nowiki></nowiki>]]
|-
| Sound
| <nowiki>[[File:IconsPage/ok.png]]</nowiki>[[#Sound|<nowiki>[[File:IconsPage-info.png]]</nowiki>]]
|-
| Microphone
| <nowiki>[[File:IconsPage/ok.png]]</nowiki> sound recoder is broken but recording with audacity works
|-
| External Monitor
| <nowiki>[[File:IconsPage/dont.png]]</nowiki> <nowiki>[[#External Monitor|<nowiki>[[File:IconsPage-info.png]]</nowiki></nowiki>]]
|-
| Thunderbolt
| <nowiki>[[File:IconsPage/ok.png]]</nowiki>
|-
| SD card slot
| <nowiki>[[File:IconsPage/ok.png]]</nowiki>
|-
| HFS+ (OS X disc partition)
| <nowiki>[[File:IconsPage/ok.png]]</nowiki> mount read-only
|-
| Fan Control
| <nowiki>[[File:IconsPage/ok.png]]</nowiki> according to <code>tlp stat</code>
|-
| Sensors (temps & fans)
| <nowiki>[[File:IconsPage/ok.png]]</nowiki> according to <code>tlp stat</code>
|-
| GPU Power Save
| <nowiki>[[File:IconsPage/ok.png]]</nowiki>
|}

<nowiki>[[File:IconsPage/ok.png]]</nowiki> (works out-of-the-box) <<BR>>
<nowiki>[[File:IconsPage/ok.png]]</nowiki> <nowiki>[[File:IconsPage/info.png]]</nowiki> (works, with remarks) <<BR>>
<nowiki>[[File:IconsPage/warning.png]]</nowiki> (needs manual install) <<BR>>
<nowiki>[[File:IconsPage/dont.png]]</nowiki> (won't work)<<BR>>
<nowiki>[[File:IconsPage/question.png]]</nowiki> (not yet documented)<<BR>>

=== Basic Installation Instructions ===

Common things about installing and maintaining Ubuntu on Intel-based Macs:
<nowiki>[[https://help.ubuntu.com/community/MactelSupportTeam/AppleIntelInstallation|Intel CPU-based Macintosh Generic Installation Instructions]]</nowiki>

==== Prerequisites ====

1. MacBookAir6,2 
  Check on OSX with 
<pre>
sysctl hw.model
  </pre>
  Check on linux with 
  <pre> 
sudo dmidecode -s system-product-name
  </pre>

2. Apple USB-Ethernet Adapter

3. USB-Stick (1GB at least)

4. <nowiki>[[http://releases.ubuntu.com/13.10/ubuntu-13.10-desktop-amd64.iso|ubuntu-13.10-desktop-amd64.iso]]</nowiki>. 
   Note: Do not use the 'amd64+mac' iso image as here the USB-Stick cannot boot. (Do not ask me why.)

==== Partition Harddisk ====

1. Boot Macbook Air into OSX

2. Open Disk Utility 
  <pre> 
open /Applications/Utility/Disk\ Utility.app 
  </pre>

3. Select "Macintosh HD" > (Tab)Partition
  Add (+) 3 more partitions
  2nd Partition: Set 30-40GB for Ubuntu "/" <<BR>>
  4th Partition: Set 4GB for Linux Swap partition <<BR>>
  3rd Partition: Use as much space as left for "/home" <<BR>>

==== Prepare USB-Stick ====

1. In OSX

2. Download iso image to ~/Downloads

3. Open Terminal (a detailed description can be found  <nowiki>[[http://www.ubuntu.com/download/desktop/create-a-usb-stick-on-mac-osx|here]]</nowiki>.
   <pre>
cd ~/Downloads
hdiutil convert -format UDRW -o ubuntu-13.10-desktop-amd64.img ubuntu-13.10-desktop-amd64.iso
open /Applications/Utilities/Disk\ Utility.app
diskutil list
diskutil unmountDisk /dev/disk1
sudo dd if=ubuntu-13.10-desktop-amd64.img.dmg of=/dev/rdisk1 bs=1m
   </pre>

==== Install Ubuntu ====

1. Restart and press "Alt"-Key on startup.

2. Make sure that the USB-Ethernet Adapter is inserted. (With a network connection the bcmwl-kernel-source module gets downloaded during the installation process.
   Select first USB-device labled "EFI-Boot" and press "Enter"
   '''No splash screen''' shall be displayed but the Ubuntu installation menu. See <nowiki>[[https://help.ubuntu.com/community/UEFI|Identifying if the computer boots the Ubuntu DVD in EFI mode]]</nowiki>.
   Select "Install Ubuntu"
   Note: If booting into BIOS-Mode is a bad choice as you can currently only run on one core. <nowiki>[[https://bugzilla.kernel.org/show_bug.cgi?id=60635|Bug]]</nowiki>

3. Choose "Something else" for partitioning.
   Please check the sizes in the list according to the partitioning for the step above. 
   OSX Disk Utility leaves unallocated partitions inbetween which usually are arround 128MB in size.
   Do not try to delete these "blank" partitions.
   2nd partition should be ext4 formatted and mounted "/".
   3rd partition should be ext3 formatted and mounted "/home". (I use ext3 in order to use fuse-ext2 from OSX; ext4 is yet not supported) 
   4th partition should be swap (no format and mountpoint required)
   Proceed...

4. The installation process should run through smoothly. 

5. Restart with pressed "Alt"-Key.
   Unfortunately selecting the "Windows" labled Partition (HD-icon) only displayed a black screen with a blinking cursor.
   Reboot into OSX again and install "refind".
   Download <nowiki>[[http://www.rodsbooks.com/refind/getting.html|Binary Zip-File]]</nowiki>
   Open a Terminal
   <pre>
cd Downloads
unzip  refind-bin-0.7.4.zip 
cd refind-bin-0.7.4
sudo ./install.sh 
   </pre>

6. Restart again. Now a Ubuntu labled "/efi/ubuntu/grubx64.efi" should be shown.
   Select this an start it, now the grub-menu should be displayed.
   Select "Ubuntu".
   Now Ubuntu should boot.

=== Wireless (AirPort) ===

<nowiki>[[File:IconsPage/restricted.png]]</nowiki>

Requires an Apple USB-Ethernet Adapter.

1. Log into ubuntu 13.10 and open a terminal (Ctrl+Alt+t).
   Attach Apple USB-Ethernet Adapter.
   Enter the following commands:
   <pre>
sudo apt-get update
sudo apt-get upgrade
   </pre>
   This updates all packages

2. Start (Panel) > (Menu)System Settings > (Icon)Software & Updates (or from terminal <code>/usr/bin/python3 /usr/bin/software-properties-gtk</code>)
   Select (Tab)Additional Drivers and install Broadcom 802.11 Linux STA wireless driver from bcmwl-kernel-source

3. Now reboot again
   Select "Ubuntu"

==== Manual installation without USB-Ethernet Adapter ====

1. Download <nowiki>[[http://launchpadlibrarian.net/153114811/bcmwl-kernel-source_6.30.223.141%2Bbdcom-0ubuntu1_amd64.deb|bcmwl-kernel-source deb package]]</nowiki> on an other computer.
   Transfer the file with USB-stick to your Macbook and install the required packages with:

   <pre>
sudo apt-get install dkms
sudo dpkg -i bcmwl-kernel-source_6.30.223.141+bdcom-0ubuntu1_amd64.deb
   </pre>
   
   Note: You can even enable Wifi using the Live-CD/ USB.

2. Start (Panel) > (Menu)System Settings > (Icon)Software & Updates (or from terminal <code>/usr/bin/python3 /usr/bin/software-properties-gtk</code>)
   Select (Tab)Additional Drivers and install Broadcom 802.11 Linux STA wireless driver from bcmwl-kernel-source

=== Sound ===

Works.

Loudspeaker works, even if headset is attached. <code>alsamixer</code> running from termial is required to lower volume on loudspeaker while maintaining on headset.

=== iSight ===

<nowiki>[[File:IconsPage/webcam.png]]</nowiki>

iSight HD webcam does not work as Apple changed to PCI for higher resolution raw images.
The camera is not recognized as USB device. The current iSight-Firmware cutter does not help here.

=== Touchpad (appletouch) ===

Works.

=== External Monitor ===

Requires at least kernel 3.11.6 - Take care with vanilla kernel as this might not contain the sound fix.

=== Function Keys ===

Works.

I personally prefer to use fn+Fkeys for the brightness and sound settings but leave the Fkeys for the applications without pressing fn.
To change this behaviour 
<pre>
echo options hid_apple fnmode=2 | sudo tee -a /etc/modprobe.d/hid_apple.conf
sudo update-initramfs -u -k all
</pre>
Then reboot.
For further info on this topic check <nowiki>[[https://help.ubuntu.com/community/AppleKeyboard|AppleKeyboard]]</nowiki>.

=== Backtick and tilde keys ===

The tile and backtick key will print the greater than and less than symbol. To fix this:

1. Find the key code for the key that mapps to the "less" and "greater" signs
<pre>
$ xmodmap -pk | grep greater
     60    	0x002e (period)	0x003e (greater)	
     94    	0x003c (less)	0x003e (greater)	0x007c (bar)	0x00a6 (brokenbar)	0x007c (bar)	0x00a6 (brokenbar)
   </pre>

2. edit (or create) ~/.xmodmaprc and include the following line in it
   <pre>
keycode 94 = grave asciitilde
   </pre>

3. run xmodmap
   <pre>
$ xmodmap ~/.xmodmaprc
   </pre>

Thanks to <nowiki>[[http://ubuntuforums.org/member.php?u=1455297|emesjay]]</nowiki> from the thread <nowiki>[[http://ubuntuforums.org/showthread.php?t=1486995|Macbook with Ubuntu - backtick and tilde not working]]</nowiki>.

=== Finetuning Powersave functions ===

With the procedures enabled below ~10h on battery can be achieved.

1. Install powertop
   <pre>
sudo apt-get install powertop
sudo powertop
   </pre>
   Toggle through with "TAB" to Tunables
   Lots of "Bad" values should be displayed.
   
2. Install TLP
   For detailed Instructions refer to <nowiki>[[http://thinkwiki.de/TLP_-_Linux_Stromsparen|tpl wiki]]</nowiki>.
   <pre>
sudo add-apt-repository ppa:linrunner/tlp
sudo apt-get update
sudo apt-get install tlp tlp-rdw
   </pre>
   
3. Copy tlp config <nowiki>[[attachment:tlp]]</nowiki> to <code>/etc/default/tlp</code> or adjust (only changes are shown)
   <pre>
DISK_IDLE_SECS_ON_AC=0
DISK_IDLE_SECS_ON_BAT=1
MAX_LOST_WORK_SECS_ON_BAT=15
DISK_APM_LEVEL_ON_BAT="1 1"
RUNTIME_PM_ALL=1
RESTORE_DEVICE_STATE_ON_STARTUP=1
   </pre>
   Restart tpl with <code>sudo /etc/init.d/tlp restart</code>
   Check if settings took effect with powertop.

4. Enable more powersaving options
   Put this script <nowiki>[[attachment:99macbookair6]]</nowiki> under <code>/etc/pm/power.d/99macbookair6</code>
    
   In <code>/etc/rc.local</code> add the following line:
   <pre>
/etc/pm/power.d/99macbookair6 true
   </pre>

5. Run <code>sudo tlp stat</code>
   Still
   <pre>
/sys/module/i915/parameters/i915_enable_rc6  = -1 (use per-chip default)
/sys/module/i915/parameters/i915_enable_fbc  = -1 (use per-chip default)
/sys/module/i915/parameters/lvds_downclock   =  0 (disabled)
/sys/module/i915/parameters/semaphores       = -1 (use per-chip default)
   </pre>
   Add the following line in <code>/etc/default/grub</code>
   <pre>
GRUB_CMDLINE_LINUX_DEFAULT="pcie_aspm=force i915.i915_enable_rc6=1 i915.i915_enable_fbc=1 i915.lvds_downclock=1 acpi_backlight=vendor"
   </pre>
   Then run <code>sudo update-grub</code> and reboot.
   After that:
   <pre>
/sys/module/i915/parameters/i915_enable_rc6  =  1 (enabled)
/sys/module/i915/parameters/i915_enable_fbc  =  1 (enabled)
/sys/module/i915/parameters/lvds_downclock   =  1 (enabled)
/sys/module/i915/parameters/semaphores       = -1 (use per-chip default)
   </pre>

=== Suspend/resume backlight issue ===
There is a strange bug with backlight. All settings (using F1 F2 keys) work great but after suspend your can only get 0% or 100% backlight.

There is no real solution for the moment but there is now a workaround.

Look at comment 78 in https://bugs.freedesktop.org/show_bug.cgi?id=67454#c78

Patrik Jakobsson wrote a kernel module that directly programs the backlight driver and it works!

If you don't want to compile by yourself, Miek Gieben did it for you. It is in comment 82
https://bugs.freedesktop.org/show_bug.cgi?id=67454#c82

1. Download the deb file and install it
<pre>
wget http://miek.nl/downloads/2013/mba6xbl-dkms_0.0.1_all.deb
sudo dpkg -i mba6xbl-dkms_0.0.1_all.deb
</pre>

2. If it does not exist, create a /etc/X11/xorg.conf containing:
<pre>
Section "Device"
        Identifier      "Intel Graphics"
        Driver          "intel"
        Option          "Backlight"     "mba6x_backlight"
EndSection
</pre>

If /etc/X11/xorg.conf already exists, just add or edit the above section.

3. To get the driver automatically loaded on startup, add
mba6x_bl to /etc/modules:
<pre>
sudo echo "mba6x_bl" >> /etc/modules
</pre>

In my case this fixed the problem (macbook air 13" core i7) and this finally makes my MBA usable under linux. I'm just missing the camera but it does not even work well under macOS!

----
<nowiki>[[https://help.ubuntu.com/community/CategoryMac|CategoryMac]]</nowiki> 
----
<<BR>><<BR>>
{| class="wikitable"
|-
| <style="background-color: #f9eaaf;" tablewidth="100%"><nowiki>[[File:IconsPage/users.png]]</nowiki><<BR>> Please update this page, if you have figured out anything, that is not mentioned here!
|}
<<BR>><<BR>>
{| class="wikitable"
|-
| <style="background-color: #f9eaaf;" tablewidth="100%"><nowiki>[[File:IconsPage/users.png]]</nowiki><<BR>> The <nowiki>[[http://ubuntuforums.org/group.php?groupid=352|MactelSupportTeam]]</nowiki> is about to restructure and reorganize the documentation for Intel-based Macs. If you are interested in helping, please visit our <nowiki>[[https://wiki.ubuntu.com/MactelSupportTeam|team page]]</nowiki> for information. For all Mactel wikis, there is a starting place <nowiki>[[https://wiki.ubuntu.com/MactelSupportTeam/CommunityHelpPages|here]]</nowiki>. There is also a <nowiki>[[http://ubuntuforums.org/showthread.php?t=969360|thread]]</nowiki> about planning the Mactel docummentation going on.
|}
<<BR>><<BR>>
