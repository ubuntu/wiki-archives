{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__

<<BR>>
== Installing Ubuntu 15.10 - Wily Werewolf on a Macbook Pro 12-1 (2015) ==
<<BR>>
This page is about installing Ubuntu 15.10 - Wily Werewolf on a MacBookPro 12,1 (2015), a 13-inch Mac laptop released in 2015 (early), which has a retina display, solid-state drive, and is based on Broadwell Intel CPU and Intel integrated graphics.

Significant parts of this guide are derived from the previous <nowiki>[[https://help.ubuntu.com/community/MacBookPro11-1/utopic | installation guide]]</nowiki>.

This guide only contains parts that are relevant for Ubuntu 15.10.

<<BR>>
----
<<BR>>

== Preparation ==

=== Creating a bootable USB-Stick ===

Prepare an USB-Stick with a livecd desktop version of <nowiki>[[http://cdimage.ubuntu.com/ubuntu/daily-live/current/ | Ubuntu 15.10 (pre-release)]]</nowiki>, detailed instructions are available here <nowiki>[[http://www.ubuntu.com/download/desktop/create-a-usb-stick-on-mac-osx | Create a usb stick on mac osx]]</nowiki>

This guide assumes that you want to keep an OS X partition. Therefore we start with resizing the existing OS X partition using diskutil. You may have to boot into recovery mode (Press Cmd+R during start of the boot process) in order to make it work. Resize your OS X partition so that at least 20 GB of free space or more remain, depending on your needs.

=== Booting Ubuntu from the USB-Stick ===

Insert the USB-Stick, reboot your Mac and immediately press the alt key to bring up the bootdisk selection. Choose the USB-Stick.
Once the live version is up and running you may want to adjust the display settings and configure an appropriate scaling setting to make everything more readable on the retina display.

<pre>
System Settings --> Display --> Scale for menu and title bars: 1.50
</pre>

You may also want to enable natural scrolling as the default behavior feels wrong when you're used to OS X.
<pre>
System Settings --> Mouse & Touchpad --> scrolling
</pre>

<<BR>>
----
<<BR>>

== 1. Installation ==

Now start the graphical installation.

Choose a partition layout that suits your needs. If you don't know what you're doing, go for 1 ext4 partition with mount point / and 1 partition as linux swap, roughly 1.5x the size of your RAM. Be careful to not erase the whole drive if you want to keep your existing OS X installation.

Once the installation is finished '''DO NOT REBOOT''', yet. (If you did, boot from the USB-Stick again and proceed as below)

=== 1.1. Setting up efibootmgr ===

We will be using efibootmgr here as it is extremly lightweight and doesn't break your OS X installation. System updates on the OS X side are working with this setup as of Jan 2015.

Open the terminal again to configure efibootmgr:

<pre>
sudo apt-get install efibootmgr
sudo efibootmgr
</pre>

Displays your current setup which should point to your mac partition (''BootOrder 0080'') which we want to change so that grub is launched by default

<pre>
sudo efibootmgr -o 0000,0080
</pre>

Make sure that BootOrder is now ''BootOrder 0000,0080'' otherwise you'll not be able to boot OS X from grub (Note: You can still boot to OS X by holding down the ''alt'' key during the very beginning of the startup and then select the EFI partition)

Now reboot your machine into the newly installed 15.10

<<BR>>
----
<<BR>>

== 2. Configuration ==

=== 2.1 Display optimization ===

As already done with the livecd, adjust the scaling setting to your needs. Be careful with changing font-sizes etc. it can easily mess up your system. If scaling only is good enough for you this is likely the most efficient way.

<pre>
System Settings --> Display --> Scale for menu and title bars: 1.50
</pre>

=== 2.2 Grub tuning ===

By default grub is in hidden mode which we are going to change

<pre>
sudo nano /etc/default/grub
</pre>

Comment out every line that starts with ''GRUB HIDDEN''

<pre>
}}}

Change anything else you'd like to have different and save. Then update grub.

{{{
sudo update-grub
</pre>

==== 2.2.1 Fixing small grub fonts ====

On the command line execute the following:

<pre>
sudo grub-mkfont -s 36 -o /boot/grub/DejaVuSansMono.pf2 /usr/share/fonts/truetype/dejavu/DejaVuSansMono.ttf
</pre>

Open and edit again /etc/default/grub and add the following line at the bottom:

<pre>
GRUB_FONT=/boot/grub/DejaVuSansMono.pf2
</pre>

Update grub again and after the next boot you have a nice readable grub startup screen.

=== 2.3 System upgrade ===

Time for a system upgrade
<pre>
sudo apt-get dist-upgrade
</pre>

=== 2.4 Setting up Power Management ===

For better battery life and power management we're going to install powertop and TLP. 

Install powertop
<pre>
sudo apt-get install powertop
sudo powertop --calibrate
</pre>

Make sure powertop with --auto-tune is executed during startup
<pre>
sudo nano /etc/rc.local
powertop --auto-tune
</pre>

Install tlp
<pre>
sudo apt-get install tlp
sudo tlp start
</pre>

=== 2.5 Keyboard Layout (for proper ~`) ===

Disable hardcoded ISO-layout:
<pre>
sudo su -
echo "options hid-apple iso_layout=0" > /etc/modprobe.d/hid-apple.conf
</pre>

<<BR>>

== 3 Periferals ==
=== 3.1 USB Super Drive ===

In oder to get it working, we need to awake the drive from its deep slumber by sending a “magic” byte sequence after the drive was connected. Thanks to Christian Moser https://christianmoser.me/use-apples-usb-superdrive-with-linux/.

Install the <nowiki>[[Linux SCSI Generic (sg) driver|http:--sg.danny.cz-sg-]]</nowiki> packages.

<pre>
sudo apt-get install sg3-utils
</pre>

Create a custom udev rule to automatically send the magic bytes when the superdrive is connected.

<pre>
cat > /etc/udev/rules.d/99-local.rules <<EOF
ACTION=="add", ATTRS{idProduct}=="1500", ATTRS{idVendor}=="05ac", DRIVERS=="usb", RUN+="/usr/bin/sg_raw /dev/$kernel EA 00 00 00 00 00 01"
EOF
</pre>

<<BR>>
----
<<BR>>

That should leave you with pretty basic, working installation of Ubuntu from which on you can continue according to your preferences.

<<BR>>
----

<<BR>>

== Remaining issues and optimization potential ==

* Battery Life and power management tuning
* Automatic background light / brightness management
* Bluetooth not working at all (see http://www.spinics.net/lists/linux-bluetooth/msg64098.html)
* SPDIF port red light (old methods to turn it off seem not work) - It looks weird when the red light remains on
* Camera not yet working (see https://github.com/patjak/bcwc_pcie for the WiP driver)

<<BR>>
----
<<BR>>

== Useful links and resources ==

=== Sources and resources ===

* <nowiki>[[https://help.ubuntu.com/community/MacBookPro11-1/utopic | 14.10 Guides]]</nowiki> - Previous Ubuntu installation guides
* <nowiki>[[https://wiki.archlinux.org/index.php/MacBook | Arch Linux Macbook installation guide]]</nowiki>
* <nowiki>[[http://www.chris-reilly.org/blog/technotes/macbook-trackpad-in-ubuntu/ | Macbook trackpad in Ubuntu]]</nowiki> - Improving touchpad behaviour with mtrack
* <nowiki>[[https://github.com/BlueDragonX/xf86-input-mtrack | xf86-input-mtrack]]</nowiki> - Alternative, better touchpad driver solutions
