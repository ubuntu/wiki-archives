{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__



Discussion of this wiki can be found <nowiki>[[ http:--ubuntuforums.org-showthread.php?t=2012400 | here ]]</nowiki>

This document describes how to migrate a Wubi install to partition. The partition(s) must be created already - for more information see <nowiki>[[ https:--help.ubuntu.com-community-HowtoPartition | here]]</nowiki>.
 
The examples shown below assume the target partition is /dev/sda5 and the swap partition (if required) is /dev/sda6.

==== Automatic migration ====
The migration supports Wubi installs from 8.04 to 14.04, with Grub2 or grub-legacy. First download the attached file <nowiki>[[attachment:wubi-move-2.5.tar.gz|wubi-move-2.5.tar.gz]]</nowiki> to your Downloads directory, right-click and choose "Extract here".
The rest of the migration is run from the terminal.

<<BR>>
To migrate to /dev/sda5 with swap on /dev/sda6:
<pre>
sudo bash wubi-move.sh /dev/sda5 /dev/sda6
</pre>
<<BR>>
To migrate to /dev/sda5 without swap:
<pre>
sudo bash wubi-move.sh /dev/sda5
</pre>
<<BR>>
If you '''don't''' want to install the grub bootloader, use the --no-bootloader option. You can boot from the Wubi install's grub menu temporarily and manually install the grub bootloader later:
<pre>
sudo bash wubi-move.sh --no-bootloader /dev/sda5 /dev/sda6
</pre>
<<BR>>
To migrate from the root.disk when running from a live CD/USB:
<pre>
sudo bash wubi-move.sh --root-disk=/media/win/ubuntu/disks/root.disk /dev/sda5 /dev/sda6
</pre>
<<BR>>
The path to the root.disk is case-sensitive and if it contains spaces they must be escaped e.g.
<pre>
sudo bash wubi-move.sh --root-disk=/media/New\ Volume/ubuntu/disks/root.disk /dev/sda5 /dev/sda6
</pre>
<<BR>>
You can migrate to separate partitions for /boot, /usr and /home:
<pre>
sudo bash wubi-move.sh /dev/sda5 /dev/sda6 --boot=/dev/sda1 --usr=/dev/sda7 --home=/dev/sda8
</pre>
<<BR>>
For full usage instructions and notes:
<pre>
bash wubi-move.sh --help
bash wubi-move.sh --notes
</pre>
<<BR>>
==== Example ====
The following screenshots (from release 2.3) show a Wubi migration to <code>/dev/sda6</code> with the swap partition on <code>/dev/sda7</code>.
<nowiki>[[File:migratewubi1.png]]</nowiki>
<nowiki>[[File:migratewubi2.png]]</nowiki>
<<BR>>
<<BR>>
==== Notes ====
The script code is hosted on: <nowiki>[[https://github.com/bcbc/Wubi-move]]</nowiki>. You can find the full history and previous releases (tagged). You can also open an Issue if you would like to suggest an improvement or file a bug.
<<BR>>
===== Known issues with script =====
1. Running "update-grub" in the chroot doesn't pick up other linux installations on the same drive. In rare cases it fails to pick up Windows installs. I recommend running ''sudo update-grub'' after booting the new install for the first time.
2. <nowiki>[[https://help.ubuntu.com/community/EOLUpgrades|End of life releases]]</nowiki> that have grub-legacy must be upgraded to a supported release before migrating.
3. Only the current kernel's initrd.img is updated on the migrated install; if you require others you can update them with: <<BR>><code>sudo update-initramfs -u -k <kernel version> </code>
4. When you run the migration on a 12.04 install, the target partition(s) will be popped up and displayed in the file browser e.g. Nautilus, when the script mounts them. To avoid this you can use the <code>--hide-partitions</code> option, however there have been cases of graphics freezes with this due to a suspected issue with <code>udevadm</code> and graphics drivers. If you have a closed source graphics card it is not recommended to use this option.
===== Other known issues: =====
1. Many older BIOSes cannot address more than 137GB from the start of the disk. If you try migrating to a partition that falls outside of this, then Grub2 will fail to load it's boot files. Even if only a part of the partition falls outside this range there is a possibility of grub failure in the future. Therefore, either confirm your BIOS is unaffected prior to partitioning, or ensure your target partition falls within this limit, or migrate to a separate boot partition within this limit.
2. The process that Wubi uses to boot (wubildr.mbr) cannot read ext3/4 partitions prior to release 11.10. It reads partitions in BIOS order looking for the wubildr file, so if finds an ext3/4 partiton before it finds the wubildr file - it will hang up. So, make sure you install the grub2 bootloader if you migrate to a partition lower than the one containing wubildr i.e. if Windows is on /dev/sda2 and you migrate to /dev/sda1

===== A note on hibernation: =====
 The migration script will enable hibernation automatically, provided you migrate with a swap partition '''and''' the swap partition is large enough (must be &gt; the size of your RAM). 
 With release 12.04 the Hibernate option is also hidden from the system menu by default - to enable it see <nowiki>[[https://help.ubuntu.com/12.04/ubuntu-help/power-hibernate.html|here]]</nowiki>
<<BR>>
==== Verifying the script ====
The archive file contains signed '''sha256''' and '''md5''' checksums of the 3 scripts used for the migration (''wubi-move.sh'', ''check-source.sh'', and ''check-target.sh''). You can manually verify these as described here...

Download my GnuPG public key, with the same keyid as on my launchpad <nowiki>[[https://launchpad.net/~bcbc|page]]</nowiki>:
<pre>
gpg --keyserver hkp://keyserver.ubuntu.com --recv-keys 0x3310A652
</pre>
Verify the checksum files are signed by me:
<pre>
gpg --verify SHA256SUMS.gpg SHA256SUMS
gpg --verify MD5SUMS.gpg MD5SUMS
</pre>
Verify the script files:
<pre>
sha256sum --check SHA256SUMS
md5sum --check MD5SUMS
</pre>
If any of the above fail, do not use the script. Note that it's normal for my key to appear ''untrusted'', as long as the keyid is correct and the checksum file signatures are valid. I've also included a script <code>verify.sh</code> that will perform the above steps, but doing it manually is safest.
<<BR>>

==== What's new in version 2.5 ====
Version 2.5 removes the default ''udev rules'' that stopped Nautilus popping up a file browser with the target partition while the script was running. The udev rules are now available as an option <code>--hide-partitions</code>. If you are running Ubuntu 12.04 and find that Nautilus is interfering with the script, you can either run it from a virtual console (Ctrl+Alt+F1) or use the new option to suppress them.
<<BR>>

==== What's new in version 2.4 ====
Version 2.4 supports the access control list on <code>/media/<username></code> mount points, and has two bug fixes: remove swap UUID check for the <code>--resume</code> and <code>--synch</code> options; correct regexp for removing .disk lines from <code>/etc/fstab</code>). See https://github.com/bcbc/Wubi-move for more information.
<<BR>>

==== What's new in version 2.3 ====
Version 2.3 contains a bug fix for non-English language users and a fix for grub-legacy installs (original install on 9.04 or earlier).
<<BR>>

==== Manual migration ====
For those interested, I've included the steps required to manually migrate here:  <nowiki>[[https://help.ubuntu.com/community/MigrateWubiManually]]</nowiki>. 
