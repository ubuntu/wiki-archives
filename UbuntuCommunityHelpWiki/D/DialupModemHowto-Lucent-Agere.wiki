{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__

The aim of this tutorial is to activate the ''Lucent 56K Internal Modem - agere'' after the installation of any version of Ubuntu and to access the Internet. The most of the tutorials in the Internet are not complete and do not contain all of the information to the whole process  of all task to set the modem in a Linux Operating System. That is why I then begun a search and study to develop my tutorial which could be used as part of the Ubuntu documentation. I have not created anything, only have used theoretical parts from the files of the scanModem script by Marv Stodolsky and also from the text of Hugo Canilli in the link given below. However these two sources have lack of information to set up the following files: wvdial.conf and rc.local which reside in the ''/etc'' sub-directory.

Compiling and installing the driver agrsm-20080203.tar.gz to the ''Lucent V.92 56K Internal Modem - agere'' systems to access the Internet

1. Download the scanModem script from <nowiki>[[http://linmodems.technion.ac.il/packages/Itmodem/sv92]]</nowiki> and execute that file as a root user.
2. After that, copy the <code>agrsm-20080203.tar.gz</code> file from /tmp directory to your home folder by running the following command from the Terminal: <code>cp /tmp/agrsm-20080203.tar.gz /home/username</code> (replace username with your real username)
3. Check if the directory <code>/usr/src</code> has the following files: <code>linux-headers-2.6.24-27</code> and <code>linux-headers-2.6.24-27-generic</code>, else will duty generate new linux-headers using the <code>linux-source-2.6.24.tar.bz2</code> file.

'''Note:''' An internet access is needed to get this file. If you are unable to access the Internet from Ubuntu, then download agrsm-20080203.tar.gz from Windows and transfer that file to your Ubuntu using for example a USB-stick as the scanModem script can not be executed from Windows.

The instructions used here are the same than Hugo Canilli's and Marv Stodolsky's ones and are available at: <nowiki>[[http://linmodems.technion.ac.il/packages/Itmodem/sv92/agrsm_howto.txt]]</nowiki>, but are incomplete.

To begin, you'll need to work as the root user, which you can do by typing the following:

<pre>
sudo su
</pre>

Enter your password when prompted. You could use <code>sudo</code> to run the following commands as root, but it seems that this might cause some compilation errors. Try it with <code>sudo</code> first if you like, though; it's much more secure than running a root shell (which the command above will do).

To actually use the downloaded file, run these commands from the Terminal:

<pre>
tar xvfz agrsm-20080203.tar.gz
cd agrsm
make clean
make
make install
</pre>

'''Note:''' Until here, this procedure of compilation is common to any driver. Now activate agrmodem and agrserial kernel modules from the Terminal:

<pre>
modprobe agrmodem
modprobe agrserial
</pre>

'''Warning:''' The following two commands need always to be executed before the command wvdialconf else the comnd: # wvdialconf /etc/wvdial.conf that follow will not find the modem on /dev/ttySAGR

<pre>
ln -s /dev/ttyAGS3/dev/ttySAGR
ln -s /dev/ttyAGS3 /dev/modem
</pre>

'''Warning:''' Always make backups. To achieve this, run the next command to backup.

<pre>
cp /etc/wvdial.conf /etc/wvdial.conf.backup
wvdialconf /etc/wvdial.conf
Editing `/etc/wvdial.conf'.
Scanning your serial ports for a modem.
ttyS0<*1>: ATQ0 V1 E1 -- failed with 2400 baud, next try: 9600 baud ------- In this region ------
ttyS0<*1>: ATQ0 V1 E1 -- failed with 9600 baud, next try: 115200 baud
ttyS0<*1>: ATQ0 V1 E1 -- and failed too at 115200, giving up. * The slots: ttyS0 and ttyS1 display
ttyS1<*1>: ATQ0 V1 E1 -- failed with 2400 baud, next try: 9600 baud   that the modem is not Founded
ttyS1<*1>: ATQ0 V1 E1 -- failed with 9600 baud, next try: 115200 baud    or sticked
ttyS1<*1>: ATQ0 V1 E1 -- and failed too at 115200, giving up.       -------   until here  -------
Modem Port Scan<*1>: S2   S3
ttySAGR<*1>: ATQ0 V1 E1 -- OK
ttySAGR<*1>: ATQ0 V1 E1 Z -- OK
ttySAGR<*1>: ATQ0 V1 E1 S0=0 -- OK
ttySAGR<*1>: ATQ0 V1 E1 S0=0 &C1 -- OK
ttySAGR<*1>: ATQ0 V1 E1 S0=0 &C1 &D2 -- OK
ttySAGR<*1>: ATQ0 V1 E1 S0=0 &C1 &D2 +FCLASS=0 -- OK
ttySAGR<*1>: Modem Identifier: ATI -- Agere SoftModem Version 2.1.40
ttySAGR<*1>: Speed 4800: AT -- OK
ttySAGR<*1>: Speed 9600: AT -- OK
ttySAGR<*1>: Speed 19200: AT -- OK
ttySAGR<*1>: Speed 38400: AT -- OK
ttySAGR<*1>: Speed 57600: AT -- OK
ttySAGR<*1>: Speed 115200: AT -- OK
ttySAGR<*1>: Max speed is 115200; that should be safe.
ttySAGR<*1>: ATQ0 V1 E1 S0=0 &C1 &D2 +FCLASS=0 -- OK
Found a modem on /dev/ttySAGR.
Modem configuration written to /etc/wvdial.conf.
ttySAGR<Info>: Speed 115200; init "ATQ0 V1 E1 S0=0 &C1 &D2 +FCLASS=0"
</pre>

Now all the people will know how to  adjust the wvdial.conf file to connect the Internet. In terminal type the following command as root user: <code>gedit /etc/wvdial.conf</code>.

<pre>
[Dialer Defaults]
Modem = /dev/ttySAGR
Baud = 57600
Phone = +-+--+-+
Username = user@uol.com.br – Here use any other address of log in
Password = ********
Init1 = ATZ
Init2 = ATQ0 V1 E1 S0=0 &C1 &D2 +FCLASS=0
Auto DNS = 1
Stupid Mode = 1
New PPPD = yes
ISDN = 0
Modem Type = Analog Modem
; Phone = <Target Phone Number>
; Password = <Your Password>
; Username = <Your Login Name>
</pre>

Add the lines in color orange that are missing: Baud = 57600, Phone = used number to connect, Username = any log in, Password =  , Auto DNS = 1 and Stupid Mode = 1 All this lines are necessary to an good connection. Warning: Do not use the parameter Baud = 115200 because it will not have synchronization in connection and wvdial dialer will dial without stopping after each failed connection. The modem 56K only approach until 57600 in maximum. Save the file before closing it.

<code>cp /etc/wvdial.conf /etc/wvdial.conf.generated</code>

'''Warning:''' Until here still lack complete with the adjust in most important rc.local file of the subdirectoy: /etc else all the that us done will lost when the computer execute an new boot. Below understand all the process of Bootup that all the computers will execute when any Linux operating System is installed. When pressed ON in CPU, the process will begin with following steps:

BIOS -> MBR -> GRUB -> Linux operating System -> Linux Kernel -> The process init -> rc.local file (The last file executed into init in Ubuntu and Fedora) or boot.local file in the SUSE Linux or openSUSE Linux. The rc.local file will load the modules: agrmodem.ko + agrserial.ko in the kernel the each new Bootup and the Links Simbolics: ln -s /dev/ttyAGS3 /dev/ttySAGR and ln -s /dev/ttyAGS3 /dev/modem will keep fixed in subdirectory: /dev.

Now use the CD of the Ubuntu 8.04.3 LTS and install the following command: setserial, after execute the steps:

<pre>
cp /etc/rc.local /etc/rc.local.backup
gedit /etc/rc.local
</pre>

<pre>
## Warning: Add the following commands below
modprobe agrmodem
modprobe agrserial
ln -s /dev/ttyAGS3 /dev/ttySAGR
ln -s /dev/ttyAGS3 /dev/modem
setserial -g /dev/ttyS*
exit 0
</pre>

After Save this rc.local file in icon diskette, exit of this file to continue.
root@user-desktop:/home/user/agrsm# cp /etc/rc.local  /etc/rc.local.generated

Begin the connection with the command: wvdial &

Now all the persons will test the dialing. Press the seat belt to this journey and see the force of the powerful command wvdial created by Dave Coombs and Avery Pennarun typed below. The character & will avoid that connection break and will keep connected all time.

<pre>
wvdial &
 --> WvDial: Internet dialer version 1.60
--> Initializing modem.
--> Sending: ATZ
ATZ
OK
--> Sending: ATQ0 V1 E1 S0=0 &C1 &D2 +FCLASS=0
ATQ0 V1 E1 S0=0 &C1 &D2 +FCLASS=0
OK
--> Modem initialized.
--> Sending: ATDT30096707
--> Waiting for carrier.
ATDT30096707  - The connection will wait + or - 33 seconds to adjust all the synchronization. No do nothing, Wait, please until the connection complete all your work. The lines below will automatically launched through of the connection.
CONNECT 45333 V42bis
--> Carrier detected.  Starting PPP immediately.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
--> pppd: 8[06][08]([06][08]
</pre>

'''Warning:''' It is the last line showed and will inform that already is connected. Now type in icon of the browser Firefox and after in menu guide: File, next type in Mode offline to remark to Mode online. If leave in Mode offline, then the browser Firefox will not access any link. Ready go to Address guide and type: http://ubuntu.com or http://distrowatch.com to test.

To exit of this connection use the command:  Ctrl+C

Type in keyboard: Ctrl+C to exit and wait until watch the terminal displayed below. When you type  Ctrl+C in keyboard will not displayed nothing in the terminal, only wait.

Is most important that type the following command below to exit

<pre>
fg wvdial
wvdial
</pre>

Again type the same command: Ctrl+C when see the word wvdial and wait until watch the terminal

<pre>
Caught signal 2:  Attempting to exit gracefully...
--> Terminating on signal 15
--> pppd: 8[06][08]([06][08]
--> Connect time 12.3 minutes.
--> pppd: 8[06][08]([06][08]
--> pppd: 8[06][08]([06][08]
--> Disconnecting at Tue Mar  9 23:06:14 2010
</pre>

root@user-desktop:/home/user/agrsm# - Here all the persons will not  connected with Internet. Warning: Now edit the file: <code>gedit /etc/ppp/options</code>

Check the commands:

<pre>
asyncmap 0
noauto
crtscts
lock
hide-password
modem
proxyarp
lcp-echo-interval 30
lcp-echo-failure 4
noipx
</pre>

All this commands can not have the character “ # “ typed before of each command else will not executed and will to all the users comments. Was test the gnome-ppp dialer, but without success to connect the UOL provedor.

Tip: To the new Ubuntu 10.04 LTS Lucid Lynx Operating System, all the persons after have installed this system will duty execute the instructions of this tutorial with the new download of the scanModem script file to detect the exact driver for the Lucent V.92 56K Internal Modem - agere systems. In following links:  http://linmodems.technion.ac.il/packages/Itmodem/sv92 all will find the two last drivers: agrsm-20080203.tar.gz and agrsm-20080418.tar.gz to download and in http://linmodems.technion.ac.il/packages/Itmodem/11c11040 will get the driver: agrsm-20090502.tar.gz. If the scanModem script file detected the driver: agrsm-20090502.tar.gz, then compile and install  this driver with the instructions of this tutorial. If appear any error after have typed the command: make, please stop here and execute the following steps:

<pre>
cd /home/user
rm -rf /home/user/agrsm
</pre>

After this, execute the download of the driver previous agrsm-20080418.tar.gz and use all the information to compile and install this driver with this tutorial. If no appear any error after have typed the command: make, good luck continue with the next command: make install that no will appear error and stop when activate the modem. Use the same method if the scanModem script file find the driver: agrsm-20080418.tar.gz to new Ubuntu 10.04 LTS Lucid Lynx Operating System.

When you update the headers, library and modules of the kernel into Ubuntu Operating System by Internet, before of Bootup this system, execute the steps:

<pre>
cp /etc/rc.local.backup  /etc/rc.local
cp /etc/wvdial.conf.generated  /etc/wvdial.conf
reboot
</pre>

After have rebooted the Ubuntu Operating System, all the users will duty recompile the agrsm-20080203.tar.gz driver again, but before execute the following command:

<pre>
rm -rf ~/agrsm
</pre>

After follow all the instructions of this tutorial again to recompile.

The solution to this problem serious of compile and install the the driver: agrsm-20080203.tar.gz to Lucent V.92 56K Internal Modem - agere systems is give in this tutorial to help all the personal of the Canonical activate this modem. All the secret of this mystery was revealed.

''Original tutorial written by Cristovom A. Girodo.''
