{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__


=== Direct terminal access via Serial Console ===

It is possible to access a Guest directly using the Serial Console interface, in which case setting up bridged networking, SHH, and similar is not necessary.

This is done using the <nowiki>[[http://linux.die.net/man/1/virsh|virsh]]</nowiki> utility which a shell interface for <nowiki>[[http://libvirt.org/|libvirt]]</nowiki>.

==== Configure a Serial Console in the Guest ====

First, we need to configure a serial console (see SerialConsoleHowto) in the '''guest''', in order that it will accept a connection:
<pre>
sudo editor /etc/init/ttyS0.conf
</pre>
Add the configuration:
<pre>

start on stopped rc RUNLEVEL=[2345]
stop on runlevel [!2345]

respawn
exec /sbin/getty -L 115200 ttyS0 xterm
</pre>
Run the following command to initiate the Serial Console (or restart the VM):
<pre>
sudo start ttyS0
</pre>
Here we are using "xterm" as the terminal type, which works well if we are connecting using a gnome-terminal (or xterm) instance.
It is likely preferable to set this to match the terminal type which will be used to connect. This can be found using this command in the '''host/client''' terminal you will be using to connect:
<pre>
echo $TERM
</pre>
For example, if you are running screen it is "screen", for byobu "screen-bce", etc.

You can also set the variable temporarily when you are '''already connected''' to the console:
<pre>
export TERM=screen
</pre>

==== Connect kernel & GRUB to Serial Console ====

If you want everything, including boot selection & default console messages, to the serial console, modify/add the following lines to '''/etc/default/grub''':

<pre>
GRUB_CMDLINE_LINUX="console=tty0 console=ttyS0,115200n8"
 
GRUB_TERMINAL=serial
GRUB_SERIAL_COMMAND="serial --speed=115200 --unit=0 --word=8 --parity=no --stop=1"
</pre>

Then, update the configuration with '''update-grub'''
After reboot you will have full access to the VM through the serial console.
Removing the '''console=tty''' from the '''CMDLINE_LINUX''' will completely disable the graphical console as well.

==== Connect using virsh ====

First we connect to the (local) qemu session:
<pre>
virsh -c qemu:///session
</pre>
Now in the virsh shell, start the virtual machine:
<pre>
start my_vm
</pre>
When it has started connect to the console:
<pre>
console my_vm
</pre>
You're in!

==== Misc notes ====

Use Ctrl + ] to exit the console.

If the console acts strangely or displays incorrectly, check that the TERM variable is set correctly (see above).

If the terminal seems to cut off the top of the output, change it to have 80x24 of '''viewing area''', e.g. in byobu this means you will need to account for the statusbar and have the window itself at 80x26
