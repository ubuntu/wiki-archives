{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__


На тази страница е описано инсталирането на драйвери за NVIDIA графични карти. Информация за други драйвери, можете да намерите на BulgarianDocumentation/BinaryDriverHowto

{| class="wikitable"
|-
| '''Съдържание'''<<BR>>
|}

=== Предпоставки ===
* Командата lspci | grep -i nvidia разпечатва на екрана текст, в който се среща nvidia
* Нуждаете се от хардуерна 3D поддръжка

=== Инсталиране ===

==== Разрешете ограничените модули (restricted packages) ====

NVIDIA драйверите се намират в така наречената "ограничена" секция от хранилището на модулите за Ubuntu. Ето защо ще трябва да разрешите тази секция, за да имате възможност да инсталирате.

 1. Изберете менюто '''Система''' ('''System''') в горната част на екрана.
 2. Изберете '''Администриране''' ('''Administration''') и после '''Synaptic Package Manager'''. Въведете паролата си, когато е необходимо.
 3. В управителя на пакетите изберете менюто '''Настройки''' ('''Settings''') и после '''Хранилища''' ('''Repositories''').
 4. В диалога '''Софтуерни Предпочитания''' ('''Software Preferences'''), щракнете върху бутона '''Добави''' ('''Add''').
 5. Убедете се, че има отметка пред опцията '''Ограничени авторски права''' ('''Restricted copyright''') в диалоговият прозорец '''Редактиране на Хранилищата''' ('''Edit Repository''') и натиснете '''OK'''.
 6. Изберете '''OK''', за да затворите диалога '''Софтуерни Предпочитания''' ('''Software Preferences''') и когато Synaptic ви запита дали да презареди базата си с данни, му разрешете.

Сега вече имате достъп до много допълнителни модули, които се намират в ограничената секция, включително и до модулите за драйвера на NVIDIA.

==== Инсталиране и активиране на драйверите ====

''Бележка'': Пакетите може да се инсталират като се щракне с десният бутон върху името на даден пакет и се избере '''Маркирай за инсталиране''' ('''Mark for Installation''').

 1. Щракнете бутона '''Търсене''' и въведете "linux-restricted-modules". Разбира се, трябва да сте разрешили достъпа до тях (погледнете по-горе).
 2. Изберете подходящият модул съобразно вашият kernel. Например, ако имате инсталиран '''linux-image-amd64-k8''', трябва да инсталирате '''linux-restricted-modules-amd64-k8'''. С избраният от вас модул автоматично ще се инсталира и nvidia-kernel-common. (Бележка: първо трябва да изберете ограничените модули, защото nvidia-glx автоматично инсталира модула за i386, т.е. X няма да работи с такъв общ kernel модул.)
 3. Щракнете отново бутона '''Търсене''' и въведете "nvidia".
 4. Трябва да инсталирате '''nvidia-glx-legacy''' или '''nvidia-glx'''. Ако графичната ви карта е в края на <nowiki>[[http://download.nvidia.com/XFree86/Linux-x86/1.0-8762/README/appendix-a.html|този списък от карти]]</nowiki> (отбелязана с "legacy"), ще трябва да изберете '''nvidia-glx-legacy'''. В противен случай изберете '''nvidia-glx'''.  
 5. Ако имате намерение да компилирате 3D програми, ще трябва да инсталирате и '''nvidia-glx-dev'''.
 6. Ако имате Hoary Hedgehog или Breezy Badger, ще трябва да инсталирате '''nvidia-settings''' и '''nvidia-xconfig'''. ''НЕ'' инсталирайте нито един от тези пакети ако сте с Ubuntu 6.06 LTS, т.к. те ще премахнат '''nvidia-glx'''. Тези програми са част от '''nvidia-glx'''.
 7. Щракнете бутона '''Изпълни''' ('''Apply'''), за да инсталирате новите пакети.
 8. Затворете Synaptic след като приключи с инсталацията.
 9. Изберете менюто '''Програми''' ('''Applications''') в горният край на екрана, после '''Аксесоари''' ('''Accessories''') и накрая '''Терминал''' ('''Terminal''').
 10. Въведете следната команда в терминала:
  <pre>
sudo nvidia-glx-config enable}}}
 11. Затворете всички програми и натиснете едновременно '''Ctrl-Alt-Backspace''', за да рестартирате X сървъра. Ако след рестартирането за кратко се появи екран с логото на NVIDIA, то драйвера ви е правилно инсталиран.

==== Nvidia Legacy (остарял, наследствен) драйвер в Edgy ====
Комбинацията на Edgy с GeForce 1 графична карта изисква да се ползват остарелите драйвери nvidia-glx-legacy. Авторът е тествал с версия 1.0.7184+2.6.17.6-1 и твърди, че са необходими следните допълнителни промени. Трябва да се редактира <code>/etc/X11/xorg.conf</code> и промени секцията
  {{{
 Section "Device"
        Identifier      "NVIDIA Corporation NV10DDR [GeForce 256 DDR]"
        Driver          "nv"
        BusID           "PCI:1:0:0"
EndSection }}}
и се въведе
  {{{
 Section "Device"
        Identifier      "NVIDIA Corporation NV10DDR [GeForce 256 DDR]"
        Driver          "nvidia"
        BusID           "PCI:1:0:0"
EndSection }}}
Ако в xorg.conf няма секция <code>Driver "nvidia"</code> то опитвайки <code>modprobe nvidia</code> ще регистрира грешка (ето защо <code>sudo nvidia-glx-config enable</code> не работи при мен - ''авторът''). За да се разреши на OpenGL програмите да работят след горната редакция следната секция трябва да се добави в края на <code>/etc/X11/xorg.conf</code>:
 {{{
 Section "Extensions"
        Option  "Composite" "Disable"
EndSection
</pre>
Това не е описано никъде в документацията за остарелите драйвери (т.е. не се споменава в <code>/usr/share/doc/nvidia-glx-legacy/*</code>) но за щастие следното предупреждение беше записано в <code>/var/log/Xorg.0.log</code>:
   <pre>
(EE) GLX is not supported with the Composite extension
</pre>

Composite режим е включен по подразбиране и това пречи на OpenGL да работи. По-горното просто изключва Composite. Тези допълнителни стъпки вероятно са необходими единствено за остарелите (*legacy*) драйвери.

==== Забраняване логото на nVidia ====
Ако искате да забраните на драйвера на nVidia да показва екран с логото малко преди да се появи екрана за влизането ви в системата, ще трябва да редактирате конфигурационният файл на Xorg.
 1. Изберете менюто '''Програми''' ('''Applications''') в горният край на екрана, после '''Аксесоари''' ('''Accessories''') и накрая '''Терминал''' ('''Terminal''').
 2. Въведете следната команда:
  <pre>
gksudo gedit /etc/X11/xorg.conf}}}
 3. Намерете реда където пише Driver "nvidia" в секцията Device
 4. Точно след този ред добавете (на нов ред)
  {{{
Option		"NoLogo"}}}
 5. Съхранете файла и го затворете
 6. Затворете всички програми и натиснете едновременно ''Ctrl-Alt-Backspace'', за да рестартирате X сървъра. Ако екрана с логото не се появи и всичко работи както преди, сте постигнали целта си.

=== Проблеми ===

* Изглежда, че понякога, за да има ефект от промените, е необходимо да се рестартира системата. Ако 3D ускорението не работи, опитайте първо това.

* Ако 3D ускорението все още не работи, уверете се, че сте инсталирали подходящата версия на linux-restricted-modules. ''Задължително'' е те да съвпадат с версията на ядрото, което ползвате.

* Ако сте инсталирали подходящата версия на linux-restricted-modules и 3D ускорението все още не работи, отворете файла <code>/etc/X11/xorg.conf</code> с командата <code>gksudo gedit /etc/X11/xorg.conf</code> и се уверете, че в секцията <code>Section "Device"</code> след <code>Driver</code> е записано <code>"nvidia"</code>.

* Може да ви се наложи да активирате "kernel framebuffer device interface" в X сървъра. Копирайте и въведете командата, която се намира по-долу в терминала. Ще бъдете водени през серия от настройки. Повечето от настройките може да се оставят с тяхната стойност по подразбиране като натискате клавиша ENTER, но когато стигнете до "Select the desired X server driver" ("Изберете желаният драйвер за X сървъра") - въпрос 2 - изберете "nvidia" а НЕ "nv". Отговорете с "да" ("yes") на въпрос 7 ("Activate kernel framebuffer device interface?" - "Да се активира ли интерфейса на кадровият буфер в ядрото?"). Довършете с останалите въпроси (можете да оставите настройките по подразбиране) и рестартирайте X сървъра (или просто рестартирайте компютъра си). Ако, когато се рестартира компютъра ви, не се появи екрана за влизането ви в системата, а се появи съобщение за грешка, в което се казва "X сървърът не може да стартира и т.н." ("X server failed to start (etc. etc.)"), ще продължите в текстов режим (бял текст на черен фон) и ще ви се предостави възможност да влезете в системата в този режим. Като влезете, ще сте все още в текстов режим. Въведете отново командата по-долу (запишете си я!) и отново ще имате възможност да промените настройките. Този път, като стигнете до "Activate kernel framebuffer device interface?", отговорете с "не" ("no") и отново рестартирайте компютъра си. Вече ще имате възможност да влезете в системата по обичайният начин.
 {{{
sudo dpkg-reconfigure xserver-xorg
</pre>

* Ако се получи съобщение за грешка когато се зарежда модула на NVIDIA, опитайте да преконфигурирате зависимостите като стартирате depmod.
 <pre>
sudo depmod
</pre>

* Ако не работи suspend (временно преустановяване работата на компютъра, при което той изглежда като изключен), погледнете NvidiaLaptopBinaryDriverSuspend

* Ако се чувствате готови да си поиграете с '''Опции'''те ('''Option'''s) на X сървъра за вашата '''Карта''' ('''Device''') в <code>/etc/X11/xorg.conf</code> и Firefox откаже да се стартира (връща <code>segmentation fault</code> когато се стартира от терминала), тогава тази инструкция може да е причината:
 <pre>
Option "NoRenderExtension" "On"
</pre> Или я забранете (ползвайте # в началото на реда) или я изключете като напишете '''Off'''.

* Относно други проблеми, моля посетете форума http://www.ubuntuforums.org

Част от UserDocumentation
