{|
  | '''Warning'''
  * This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
  * '''Images''' and '''attachments''' have been removed to conserve space.
  * '''Links''' may not work and there may be formatting issues.
  * A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__


<nowiki>[[File:IconsPage/important.png]]</nowiki> For a more flexible solution, see <nowiki>[[DynamicMultiMonitor]]</nowiki>.

<nowiki>[[File:IconsPage/info.png]]</nowiki> Here's a quick little script I wrote to set the proper display when I'm at work.

== The Situation ==

I work at three primary places: home, office one, and office two.

At home, I just use my laptop. At office one I have a 22" monitor and at office two I have a 24" monitor. Obviously, the resolutions are different and when I connect to them I want my displays to be set perfectly.

My laptop is always to the right of my external monitor. Here is a picture of office one's setup:

<nowiki>[[File:itm-desktop-layout.jpg|My Desktop|width="800"]]</nowiki>

As you can see the laptop is to the left and lower than my external monitor.

== XRandR To The Rescue! ==

XRandR is a powerful little utility, and with the proper amount of psychology, and extreme violence, I was able to have it do my bidding. What follows is the small shell script I wrote to control, dynamically, the external monitor settings.

<pre>

LAPTOP="LVDS"
HAVE_HDMI="`xrandr | grep 'HDMI-0 connected' | wc -l`"
HAVE_DFP="`xrandr | grep 'DFP1 connected' | wc -l`"

if [ $HAVE_HDMI = "1" ] ; then
    EXTERNAL_OUTPUT="HDMI-0"
elif [ $HAVE_DFP = "1" ] ; then
    EXTERNAL_OUTPUT="DFP1"
else
    EXTERNAL_OUTPUT=""
fi

AT_OFFICE1="`ip -o addr show dev eth0 | grep 'inet 192.168.15.' | wc -l`"
AT_OFFICE2="`ip -o addr show dev eth0 | grep 'inet 10.0.1.' | wc -l`"

xrandr --output $LAPTOP --preferred

if [ ! -x $EXTERNAL_OUTPUT ] ; then
    if [ $AT_OFFICE2 = "1" ] ; then
        xrandr --output $EXTERNAL_OUTPUT --mode "1680x1050" --pos 1600x0 --primary --output $LAPTOP --mode "1600x900" --pos 0x500
    fi

    if [ $AT_OFFICE1 = "1" ] ; then
        xrandr --output $EXTERNAL_OUTPUT --mode "1920x1080" --pos 1600x0 --primary --output $LAPTOP --mode "1600x900" --pos 0x500
    fi
fi
</pre>

First a disclaimer: I am no shell script expert. 

My laptop's display is called '''LVDS'''. My external monitor is '''DFP1'''. However, when using the open source ATI drivers, it is called '''HDMI-0'''. Since I've been known to switch between the proprietary and open-source drivers, this script handles both. Obviously, if your external display name is different, just change it.

The script queries XRandR for the state of both HDMI-0 and DFP1. If either are in a '''connected''' state, the associated variable is set to a value of "1". I never learned sed and awk so I use the poor man's version: <code>grep and wc</code>.

Since both my monitors are named the same at both offices, I rely on my ethernet connection's IP address to determine where I am. Here I query <code>ip addr</code> for the currently assigned IP address. Each office uses a different subnet so I'm safe.

Checking these values, I'm able to determine where I am and what display is connected. Now the fun begins. Well, it's not really fun...

If my external output is connected <code>$EXTERNAL_OUTPUT</code> I run an XRandR command to set it up the way I like it. 

My laptop is 1600x900 at all times. Therefore my external output offset is 1600. This is set in the <code>--pos 1600x0</code> statement. I also tell XRandR that this is my primary monitor with the <code>--primary</code> command.

Next, my laptop is always below my external monitor's viewport. I like my virtual space to mimic reality. Therefore I set my laptop display to be 500 pixels '''below''' the top of my external monitor's viewport. This is done with the <code>--pos 0x500</code> in the second half of the XRandR call.

And that is it. I named this script '''<code>setDisplay.sh</code>''' and placed it in my <code>~/.kde/Autostart</code> directory.

If you have several users who need to share this script, place it in your <code>/usr/local/bin</code> directory.

The final step is to make it executable:

<pre>
jablan@lucifurious:~/.kde/Autostart$ chmod +x ./setDisplay.sh
</pre>

or, if it's in <code>/usr/local/bin</code>:

<pre>
jablan@lucifurious:~/.kde/Autostart$ chmod +x /usr/local/bin/setDisplay.sh
</pre>

----
CategoryHardware
