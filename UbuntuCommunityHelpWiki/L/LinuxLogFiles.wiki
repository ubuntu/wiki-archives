{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work and there may be formatting issues.
* A '''compressed''' version with images and the original syntax is in the repo '''Releases'''.
|}

__TOC__



=== Introduction ===
One of the things which makes GNU/Linux a great operating system is that virtually anything and everything happening on and to
the system may be logged in some manner.  This information is invaluable for using the system in an informed manner, and should
be one of the first resources you use to trouble-shoot system and application issues.  The logs can tell you almost anything you
need to know, as long as you have an idea where to look first.

Your Ubuntu system provides vital information using various system log files.  These log files are typically plain ASCII text in
a standard log file format, and most of them sit in the traditional system log subdirectory <code>/var/log</code>. Many are generated
by the system log daemon, <code>syslogd</code> on behalf of the system and certain applications, while some applications generate their
own logs by writing directly to files in <code>/var/log</code>.

This guide talks about how to read and use several of these system log files, how to use and configure the system logging
daemon, <code>syslogd</code>, and how log rotation works.  See the '''Resources''' section for additional information.

=== Target Audience ===
This guide will be simple enough to use if you have any experience using the console and editing text files using a text editor.
See the end of this document for some essential commands that may help you find your way around these files if you're relatively
new to the command line.

=== System Logs ===
System logs deal primarily with the functioning of the Ubuntu system, not necessarily with additional applications added by
users.  Examples include authorization mechanisms, system daemons, system messages, and the all-encompassing system log itself,
''syslog''.

==== Authorization Log ====
The Authorization Log tracks usage of authorization systems, the mechanisms for authorizing users which prompt for user
passwords, such as the Pluggable Authentication Module (PAM) system, the <code>sudo</code> command, remote logins to <code>sshd</code> and so
on.  The Authorization Log file may be accessed at <code>/var/log/auth.log</code>.  This log is useful for learning about user logins
and usage of the sudo command.

Use <code>grep</code> to cut down on the volume.  For example, to see only information in the Authorization Log pertaining to
<code>sshd</code> logins, use this:

<pre>
grep sshd /var/log/auth.log | less
</pre>

==== Daemon Log ====
A daemon is a program that runs in the background, generally without human intervention, performing some operation important to
the proper running of your system.  The daemon log at <code>/var/log/daemon.log</code> and contains information about running system
and application daemons such as the Gnome Display Manager daemon <code>gdm</code>, the Bluetooth HCI daemon <code>hcid</code>, or the MySQL
database daemon <code>mysqld</code>.  This can help you trouble-shoot problems with a particular daemon.

Again, use grep to find specific information, plugging in the name of the daemon you're interested in.

==== Debug Log ====
The debug log at <code>/var/log/debug</code> and provides detailed debug messages from the Ubuntu system and applications which log to
<code>syslogd</code> at the DEBUG level.

==== Kernel Log ====
The kernel log at <code>/var/log/kern.log</code> provides a detailed log of messages from the Ubuntu Linux kernel.  These messages may
prove useful for trouble-shooting a new or custom-built kernel, for example.

==== Kernel Ring Buffer ====
The kernel ring buffer is not really a log file per se, but rather an area in the running kernel you can query for kernel bootup
messages via the <code>dmesg</code> utility.  To see the messages, use this:

<pre>
dmesg | less
</pre>

Or to search for lines that mention the Plug & Play system, for example, use <code>grep</code> like this:

<pre>
dmesg | grep pnp | less
</pre>

By default, the system initialization script <code>/etc/init.d/bootmisc.sh</code> sends all bootup messages to the file
<code>/var/log/dmesg</code> as well.  You can view and search this file the usual way.

==== System Log ====
The system log typically contains the greatest deal of information by default about your Ubuntu system.  It is located at
<code>/var/log/syslog</code>, and may contain information other logs do not.  Consult the System Log when you can't locate the desired
log information in another log. It also contains everything that used to be in <code>/var/log/messages</code>.

=== Application Logs ===
Many applications also create logs in <code>/var/log</code>.  If you list the contents of your <code>/var/log</code> subdirectory, you will
see familiar names, such as <code>/var/log/apache2</code> representing the logs for the Apache 2 web server, or <code>/var/log/samba</code>,
which contains the logs for the Samba server.  This section of the guide introduces some specific examples of application logs,
and information contained within them.

==== Apache HTTP Server Logs ====
The default installation for Apache2 on Ubuntu creates a log
subdirectory: <code>/var/log/apache2</code>.  Within this subdirectory
are two log files with two distinct purposes:

* <code>/var/log/apache2/access.log</code> - records of every page served and every file loaded by the web server.
* <code>/var/log/apache2/error.log</code> - records of all error conditions reported by the HTTP server

By default, every time Apache accesses a file or page, the access logs record the IP address, time and date, browser
identification string, HTTP result code and the text of the actual query, which will generally be a GET for a page view.  Look
at the Apache documentation for a complete rundown; quite a lot can be gleaned from this file, and indeed many statistical
packages exist that perform analyses of these logs.

Also, every time any error occurs, Apache adds a line to the error log.  If you run PHP with error and warning messages
disabled, this can be your only way to identify bugs.

==== CUPS Print System Logs ====
The Common Unix Printing System (CUPS) uses the default log file <code>/var/log/cups/error_log</code> to store informational and error
messages.  If you need to solve a printing issue in Ubuntu, this log may be a good place to start. 

==== Rootkit Hunter Log ====
The Rootkit Hunter utility (<code>rkhunter</code>) checks your Ubuntu system for backdoors, sniffers and rootkits, which are all signs
of compromise of your system.  The log rkhunter uses is located at <code>/var/log/rkhunter.log</code>.

==== Samba SMB Server Logs ====
The Server Message Block Protocol (SMB) server, Samba is popularly used for sharing files between your Ubuntu computer and other
computers which support the SMB protocol.  Samba keeps three distinct types of logs in the subdirectory <code>/var/log/samba</code>:

* <code>log.nmbd</code> - messages related to Samba's NETBIOS over IP functionality (the network stuff)
* <code>log.smbd</code> - messages related to Samba's SMB/CIFS functionality (the file and print sharing stuff)
* <code>log.[IP_ADDRESS]</code> - messages related to requests for services from the IP address contained in the log file name, for example, <code>log.192.168.1.1</code>.

==== X11 Server Log ====
The default X11 Windowing Server in use with Ubuntu is the Xorg X11 server, and assuming your computer has only one display
defined, it stores log messages in the file <code>/var/log/Xorg.0.log</code>.  This log is helpful for diagnosing issues with your X11
environment.  

=== Non-Human-Readable Logs ===
Some log files found in the <code>/var/log</code> subdirectory are designed to be readable by applications, not necessarily by
humans.  Some examples of such log files which appear in <code>/var/log</code> follow.

==== Login Failures Log ====
The login failures log located at <code>/var/log/faillog</code> is actually designed to be parsed and displayed by the <code>faillog</code>
command.  For example, to print recent login failures, use this:

<pre>
faillog
</pre>

==== Last Logins Log ====
The last logins log at <code>/var/log/lastlog</code> should not typically be parsed and examined by humans, but rather should be used
in conjunction with the <code>lastlog</code> command.  For example to see a listing of logins with the <code>lastlog</code> command, displayed
one page per screen with the <code>less</code> command, use the following command:

<pre>
lastlog | less
</pre>

==== Login Records Log ====
The file <code>/var/log/wtmp</code> contains login records, but unlike <code>/var/log/lastlog</code> above, <code>/var/log/wtmp</code> is not used to
show a list of recent logins, but is instead used by other utilities such as the <code>who</code> command to present a listed of
currently logged in users.  This command will show the users currently logged in to your machine:

<pre>
who
</pre>

=== System Logging Daemon (syslogd) ===
The system logging daemon <code>syslogd</code>, also known as <code>sysklogd</code>, awaits logging messages from numerous sources and routes
the messages to the appropriate file or network destination.  Messages logged to <code>syslogd</code> usually contain common
elements like system hostnames and time-stamps in addition to the specific log information.

==== Configuration of syslogd ====
The <code>syslogd</code> daemon's configuration file is <code>/etc/syslog.conf</code>.  Each entry in this file consists of two fields, the
selector and the action.  The selector field specifies a facility to be logged, such as for example the '''auth''' facility
which deals with authorization, and a priority level to log such information at, such as '''info''', or '''warning'''.  The
action field consists of a target for the log information, such as a standard log file (i.e. <code>/var/log/syslog</code>), or the
hostname of a remote computer to send the log information to.

==== Echoing Messages to syslogd With Logger ====
A neat utility exists in the <code>logger</code> tool, which allows one to place messages into the System Log
(i.e. <code>/var/log/syslog</code>) arbitrarily.  For example, assume your user name is <code>buddha</code>, and you would like to enter a
message into the syslog about a particularly delicious pizza you're eating, you could use a command such as the following at a
terminal prompt:

<code>logger This Pizza from Vinnys Gourmet Rocks</code>

and you would end up with a line in the <code>/var/log/syslog</code> file like this:

<pre>
Jan 12 23:34:45 localhost buddha: This Pizza from Vinnys Gourmet Rocks
</pre>

You can even specify a tag the messages come from, and redirect the output standard error too.

<pre>
logmsg="/usr/bin/logger -s -t MyScript "

$logmsg "Directory Checker FooScript Jive 1.0"

if [ -d /home/fred ]; then
   $logmsg "I. Fred's Home Directory Found"
else
   $logmsg "E. Fred's Home Directory was NOT Found. Boo Hoo."
   exit 1
fi
</pre>

Executing this script as <code>chkdir.sh</code> on the machine <code>butters</code> where Fred does not have a home directory,
<code>/home/fred</code>, gives the following results:

<pre>
bumpy@butters:~$./chkdir.sh
MyScript: Directory Checker FooScript Jive 1.0
MyScript: E. Fred's Home Directory was NOT Found. Boo Hoo.
bumpy@butters:~$tail -n 2 /var/log/syslog
Jan 12 23:23:11 localhost MyScript: Directory Checker FooScript Jive 1.0
Jan 12 23:23:11 localhost MyScript: E. Fred's Home Directory was NOT Found. Boo Hoo.
</pre>

So, as you can see, we received the messages both via standard error, at the terminal prompt, and they also appear in our
syslog.

==== Log Rotation ====
When viewing directory listings in <code>/var/log</code> or any of its subdirectories, you may encounter log files with names such as
<code>daemon.log.0</code>, <code>daemon.log.1.gz</code>, and so on.  What are these log files?  They are 'rotated' log files.  That is, they
have automatically been renamed after a predefined time-frame, and a new original log started.  After even more time the log
files are compressed with the <code>gzip</code> utility as in the case of the example <code>daemon.log.1.gz</code>.  The purpose of log
rotation is to archive and compress old logs so that they consume less disk space, but are still available for inspection as
needed.  What handles this functionality? Why, the <code>logrotate</code> command of course!  Typically, logrotate is called from the
system-wide cron script <code>/etc/cron.daily/logrotate</code>, and further defined by the configuration file
<code>/etc/logrotate.conf</code>.  Individual configuration files can be added into <code>/etc/logrotate.d</code> (where the apache2 and mysql
configurations are stored for example).

This guide will not cover the myriad of ways <code>logrotate</code> may be configured to handle the automatic rotation of any log file
on your Ubuntu system.  For more detail, check the '''Resources''' section of this guide.

<nowiki>[[File:IconsPage/note.png]]</nowiki> '''NOTE:''' You may also rotate system log files via the <code>cron.daily</code> script
<code>/etc/cron.daily/sysklogd</code> instead of using logrotate.  Actually, the utility <code>savelog</code> may produce unexpected results
on log rotation which configuring <code>logrotate</code> seems to have no effect on.  In those cases, you should check the cron.daily
<code>sysklogd</code> script in <code>/etc/cron.daily/sysklogd</code> and read the <code>savelog</code> manual page to see if <code>savelog</code> is not in
fact doing the rotation in a way that is not what you are specifying with <code>logrotate</code>.

=== Essential Commands ===
If you're new to the console and the Linux command line, these commands will get you up and running to the point where you can
work with log files at a basic level.

==== Getting Started ====
To change to the log directory, where most of these files sit, use the <code>cd</code> command.  This saves having to type out a full
path name for every subsequent command:

<pre>
cd /var/log
</pre>

==== Editing Files ====
You can view and edit files in GEdit or Kate, the simple text editors that come with Ubuntu and Kubuntu respectively, but these
can be overkill when all you want to do is look at a file or make simple changes.  The easiest editor to use from the console is
nano, which is less powerful but also less complicated than vim or emacs.  The command to edit a particular logfile
<code>/var/log/example.log</code> using nano is:

<code>nano example.log</code>

Press Ctrl+X to exit.  It will ask if you want to save your changes when you exit, but unless you run it with the <code>sudo</code>
command the files won't be writable.  In general, you won't want to save your changes to log files, of course.

==== Viewing Files ====
To simply look at a file, an editor is overkill.  Use the <code>less</code> command, which pages through a file one screen at a time:

<pre>
less example.log
</pre>

You don't need <code>sudo</code> to look at a file.  Press h for help, or q to quit.  The cursor keys and page up/down keys will work
as expected, and the slash key ("/") will do a case-sensitive search; the n key repeats the last search.

==== Viewing the Beginning of Files ====

To see the first ten lines of a file, use the <code>head</code> command:

<code>head example.log</code>

To see some other number of lines from the beginning of the file, add the -n switch, thus:

<code>head -n 20 example.log</code>

==== Viewing the End of Files ====
To see the final ten lines of a file, the analogous command is <code>tail</code>:

<pre>
tail example.log
</pre>

Again, the -n switch gives you control over how many lines it displays:

<code>tail -n 20 example.log</code>

==== Watching a Changing File ====

Also, the -f ("follow") switch puts tail into a loop, constantly waiting for new additions to the file it's displaying.  This is
useful for monitoring files that are being updated in real time:

<pre>
tail -f example.log
</pre>

Press Ctrl+C to quit the loop.

==== Searching Files ====
Because log files can be large and unwieldy, it helps to be able to focus.  The <code>grep</code> command helps you strip out only the
content you care about.  To find all the lines in a file containing the word "system", for example, use this:

<pre>
grep "system" example.log
</pre>

To find all the lines containing "system" at the beginning of the line, use this:

<pre>
grep "^system" example.log
</pre>

Note the caret symbol, a regular expression that matches only the start of a line.  This is less useful for standard log files,
which always start with a date and time, but it can be handy otherwise.  Not all files have a standard format.

Any time the result of a <code>grep</code> is still too long, you can pipe it through <code>less</code>:

<pre>
grep "system" example.log | less
</pre>

=== Resources ===
Additional information on system and application logs and <code>syslogd</code> is available via the following resources:

==== Local System Resources ====
{| class="wikitable"
|-
| <style="background:#F1F1ED;"><code>man dmesg</code>
| System manual page for the <code>dmesg</code> kernel ring buffer utility
|-
| <style="background:#F1F1ED;"><code>man faillog</code>
| System manual page for the <code>faillog</code> command (and also the faillog configuration file via <code>man 5 faillog</code>)
|-
| <style="background:#F1F1ED;"><code>man grep</code>
| System manual page for the <code>grep</code> pattern searching utility
|-
| <style="background:#F1F1ED;"><code>man head</code>
| System manual page for the <code>head</code> utility
|-
| <style="background:#F1F1ED;"><code>man klogd</code>
| System manual page for the kernel log daemon (<code>klogd</code>)
|-
| <style="background:#F1F1ED;"><code>man last</code>
| System manual for the <code>last</code> command which shows last logged in users
|-
| <style="background:#F1F1ED;"><code>man less</code>
| System manual page for the <code>less</code> paging utility
|-
| <style="background:#F1F1ED;"><code>man logger</code>
| System manual page for the <code>logger</code> command-line interface to syslog utility
|-
| <style="background:#F1F1ED;"><code>man logrotate</code>
| System manual page for the the <code>logrotate</code> utility
|-
| <style="background:#F1F1ED;"><code>man savelog</code>
| System manual page for the <code>savelog</code> log file saving utility
|-
| <style="background:#F1F1ED;"><code>man syslogd</code>
| System manual page for the system log daemon (<code>syslogd</code>)
|-
| <style="background:#F1F1ED;"><code>man syslog.conf</code>
| System manual page for the <code>syslogd</code> configuration file
|-
| <style="background:#F1F1ED;"><code>man tail</code>
| System manual page for the <code>tail</code> utility
|}

==== WWW Resources ====
<nowiki>[[http://www.samag.com/documents/s=1146/sam0109m/0109m.htm|Checking Your System Logs with awk]]</nowiki>

<nowiki>[[http://www.linuxvoodoo.com/resources/howtos/syslog/|Syslog - Watching Your Logs]]</nowiki>

<nowiki>[[http://www.ibm.com/developerworks/linux/library/l-roadmap5/-Linux Logging]]</nowiki>

<nowiki>[[http://www.linuxsecurity.com/content/view/116430/151/|Sawing Linux Logs With Simple Tools]]</nowiki>

----
CategorySystem
