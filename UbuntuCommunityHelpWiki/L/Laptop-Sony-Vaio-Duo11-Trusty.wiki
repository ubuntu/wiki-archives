{|
| '''Warning'''
* This is a '''readonly''' and '''text-based''' archive of a deprecated wiki.
* '''Images''' and '''attachments''' have been removed to conserve space.
* '''Links''' may not work.
* A '''full compressed version''' of the wiki is available on archive.org
|}

__TOC__

Title Sony Vaio Duo 11 on Ubuntu 14.04

The Sony VAIO Duo 11 (model number SVD11xxxxxx) is an Intel Ivybridge Ultrabook using low-power Core i3, i5, or i7 CPU, with four or eight gigabytes of RAM, and a 128, 256, or 512 gigabyte SSD.

With 14.04 most hardware just works. Noteable exceptions are the GPS and orientation sensors.

== Preparation ==

=== Partition ===

If you want to dual boot between Ubuntu and Windows, the simplest way is to use the space taken up by the recovery partition.
Use Sony's tool to create a recovery backup to a USB drive. Then use the same tool to delete the recovery partition, and install Ubuntu into it.

=== Windows ===

If dual booting, then you'll probably want to be able to access your NTFS partition, so will need to turn off Windows' Hibernation and Fast Startup features.

To disable Hibernation, open a command prompt with Administrator rights by pressing WIN+X and selecting it from the menu.
In the command prompt type the command <code>powercfg -h off</code>

To disable Fast Startup go to the Power Options control panel (by right-clicking the battery in the system tray) click the hyperlink titled "Choose what the power button does", then the one with the UAC shield to let you change settings currently unavailable.
Here, in the Shutdown settings section, uncheck "Turn on fast startup (recommended)".

=== BIOS ===

Access the BIOS by pressing the recessed Assist button when the machine is shut down, or by holding down shift in Windows and clicking Restart, then selecting the UEFI Firmware Settings option.
At the firmware boot screen, press F2 to enter the BIOS.

Here you should disable SecureBoot.

Optionally, you can also disable XHCI (USB 3) mode, as doing this and using the USB port located next to the HDMI port can help with any compatibility issues.
You can turn XHCI mode back on after the installation.

== Installation ==

1. After creating your 64-bit Ubuntu 14.04 USB drive, shut down Windows
2. Start up the computer with Assist button
3. Press F11 to boot from USB, and install Ubuntu from within the live environment
4. When partitioning, select the last option to let you define your partitions manually:

=== Partitioning ===

The Vaio Duo 11's partition layout is a little different, you should have this (256GB model shown):

<pre>
$ parted -l
Model: ATA TOSHIBA THNSNS25 (scsi)
Disk /dev/sda: 256GB
Sector size (logical/physical): 512B/512B
Partition Table: gpt

Number  Start   End     Size    File system     Name                          Flags
 1      1049kB  274MB   273MB   fat32           EFI system partition          hidden
 2      274MB   1819MB  1546MB  ntfs            Basic data partition          hidden, diag
 3      1819MB  2092MB  273MB   fat32           EFI system partition          boot
 4      2092MB  2226MB  134MB                   Microsoft reserved partition  msftres
 5      2226MB  224GB   222GB   ntfs            Basic data partition          msftdata
</pre>

Note the two EFI system partitions.
sda3 is the real boot partition, and this is where you want to tell the installer to mount as /boot

Then create an ext4 partition and a swap partition:
<pre>
 6      224GB   248GB   23,5GB  ext4
 7      248GB   256GB   8464MB  linux-swap(v1)
</pre>

=== Installing ===

Nothing of note. The installation knows it's a UEFI system and will install and configure grub-efi.
Grub will detect the Windows bootloader on sda3 and create a boot entry.

=== Post-installation ===

For best results, don't reboot immediately after installation. 
After rebooting you'll notice that the machine completely ignores Grub and goes straight into Windows.
This is because it's hard-coded to boot from the file /dev/sda3/EFI/Microsoft/Boot/bootmgfw.efi
To use Grub, you will need to:

1. Create a copy of the original Windows bootloader (eg. bootmgfw.win.efi) and update your Grub menuentry for Windows to use this new filename.
2. Copy grubx64.efi from /EFI/ubuntu/ to /EFI/Microsoft/Boot/bootmgfw.efi

== Using Ubuntu ==

=== Hardware ===

Hardware support is much improved in Ubuntu 14.04, however certain features are not available.

==== GPS ====

There is no support for the GPS chip.

==== Orientation sensors ====

These are detected by udev. Kernel modules hid_sensor_hub, hid_sensor_iio_common, hid_sensor_trigger, hid_sensor_gyro_3d, hid_sensor_magn_3d, and hid_sensor_accel_3d are loaded, and there are three IIO devices in /dev/iio:device0,1,2; but any attempt I've made to use them has failed so far.

==== Battery limiter ====

The sony-laptop kernel module provides access to the Battery Care Limiter feature via the file <code>/sys/devices/platform/sony-laptop/battery_care_limiter</code>

To disable this feature (ie. allow 100% charge) as root do:
<pre>
echo 0 > /sys/devices/platform/sony-laptop/battery_care_limiter
</pre>
To enable, set it to 50 or 80 as desired:
<pre>
echo 80 > /sys/devices/platform/sony-laptop/battery_care_limiter
</pre>

==== Touch Screen and Pen ====

The N-Trig Duosense touch and pen input both have evdev support, with full multitouch for finger input, and pressure sensitivity for the pen.
Xinput adds the screen as type TOUCHSCREEN and the pen as type TABLET.

==== Optical Track Pad ====

The Crucialtek Optical Track Pad has very limited support. Non-Synaptics touchpads are not supported by Ubuntu it seems, so the Mouse and touchpad settings applet is not very useful.

The touchpad can be turned on and off via <code>/sys/devices/platform/sony-laptop/touchpad</code>. 
A value of 1 enables it, and 0 disables.

==== Turn off OTP while typing, and screen while drawing ====

<nowiki>[[attachment:duo11input.sh|This bash script]]</nowiki> will turn off the touch screen when the pen is in use, and will turn off the optical track pad when the keyboard is in use.
I've adapted it from <nowiki>[[http://ubuntuforums.org/showthread.php?t=2141992&p=12892039#post12892039|Tuxiano's post on the forums]]</nowiki>.

=== Software ===

==== Pen input ====

As an alternative to OneNote, I've found that <nowiki>[[apt:--xournal|Xournal]]</nowiki> comes closest: supporting pressure-sensitivity and both buttons.

==== GIMP ====

GIMP supports the pen and pressure sensitivity. For best results, configure GIMP's input device settings so that the pen and mouse are used for input, but the touchscreen is not.

==== Mozilla Thunderbird ====

Not specific to this hardware, but a handy tip if you already use Thunderbird in Windows:
Create a symbolic link in your <code>~/.thunderbird/</code> directory to the location of your Windows Thunderbird installation, eg:
<pre>
cd ~/.thunderbird/
ln -s /mnt/sda5/Users/USERNAME/AppData/Roaming/Thunderbird/Profiles/PROFILE.default/ .
</pre>
Replace USERNAME with your Windows username, and PROFILE with the random alphanumeric string created by Thunderbird.
With this, email is shared between installations, saving space.

== See Also ==

* <https://help.ubuntu.com/community/UEFI> - UEFI.

== External Links ==

Links that have been helpful in the creation of this page:

* <http://askubuntu.com/questions/221835/installing-ubuntu-on-a-pre-installed-windows-8-64-bit-system-uefi-supported/228069#228069 > - Very good write-up of installing Ubuntu on a Windows 8 system.
* <https://bugs.launchpad.net/bugs/1121379 > - touchscreen bug, now fixed.
* <http://joshtaylor.id.au/vaio-duo-11-ubuntu-linux-12-10 > - one of the first resources detailing running Ubuntu on this laptop.
----
CategoryHardware
